/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as i,jsxs as _,Fragment as C}from"@dropins/tools/preact-jsx-runtime.js";import*as Q from"@dropins/tools/preact-compat.js";import{useState as N,useEffect as oe,useCallback as ce}from"@dropins/tools/preact-compat.js";import{Divider as j,Skeleton as ue,SkeletonRow as le,Price as q,Image as se,Button as de,CartList as me,Accordion as ge,AccordionSection as ye,CartItem as he}from"@dropins/tools/components.js";import{classes as v,VComponent as A,Slot as s}from"@dropins/tools/lib.js";/* empty css                         */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";/* empty css                        *//* empty css                          */import{Q as b,s as fe}from"../chunks/state.js";import{events as pe}from"@dropins/tools/event-bus.js";import{S as ve}from"../chunks/ChevronDown.js";import{useText as _e}from"@dropins/tools/i18n.js";const be=e=>Q.createElement("svg",{id:"Icon_Chevron_right_Base","data-name":"Icon \\u2013 Chevron right \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...e},Q.createElement("g",{id:"Large"},Q.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),Q.createElement("g",{id:"Chevron_right_icon","data-name":"Chevron right icon"},Q.createElement("path",{vectorEffect:"non-scaling-stroke",id:"chevron",d:"M199.75,367.5l4.255,-4.255-4.255,-4.255",transform:"translate(-189.25 -351.0)",fill:"none",stroke:"currentColor"})))),F=({className:e,children:n,heading:t,footer:a,products:o,outOfStockMessage:r,loading:l=!0,variant:d="primary",...m})=>i("div",{...m,className:v(["quote-management-quote-summary-list",e,`quote-management-quote-summary-list__background--${d}`]),children:l?i(xe,{}):_(C,{children:[(t||r)&&_("div",{"data-testid":"quote-summary-list-heading-wrapper",className:v(["quote-management-quote-summary-list__heading",["quote-management-quote-summary-list__heading--full-width",!o]]),children:[t&&_(C,{children:[i(A,{node:t,className:"quote-management-quote-summary-list__heading-text"}),i(j,{variant:"primary",className:v(["quote-management-quote-summary-list__heading-divider"])})]}),r&&i(A,{node:r,className:"quote-management-quote-summary-list__out-of-stock-message"})]}),i("div",{className:v(["quote-management-quote-summary-list__content"]),children:o}),a&&_(C,{children:[i(j,{variant:"primary",className:v(["quote-management-quote-summary-list__footer-divider"])}),i(A,{node:a,className:"quote-management-quote-summary-list__footer-text"})]})]})}),xe=()=>i(ue,{"data-testid":"quote-summary-list-skeleton",className:"quote-management-quote-summary-list__skeleton",rowGap:"medium",children:i(le,{variant:"row",size:"xlarge",fullWidth:!0,lines:3,multilineGap:"small"})}),Ie=()=>{const[e,n]=N(void 0),[t,a]=N(!0);return oe(()=>{const o=pe.on("quote-management/quote-data",r=>{const{quote:l}=r;l&&(n(l),a(!1))},{eager:!0});return()=>o==null?void 0:o.off()},[]),{quoteData:e,loading:t}},B=(e,n)=>{var t;return((t=n.quoteDisplaySettings)==null?void 0:t.price)===b.TAX_INCLUDED?e.discounted?{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.priceIncludingTax.value,currency:e.prices.priceIncludingTax.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"regular-item-price"}},z=e=>{var n,t;return{amount:(n=e.savingsAmount)==null?void 0:n.value,currency:(t=e.savingsAmount)==null?void 0:t.currency,style:{font:"inherit"},"data-testid":"item-savings-amount"}},G=(e,n)=>{var o,r,l,d,m,x,I,E,c,f,p,P;const t={"aria-label":n.dictionary.regularPrice},a=e.discounted?{}:null;return((o=n.quoteDisplaySettings)==null?void 0:o.price)===b.TAX_INCLUDED||((r=n.quoteDisplaySettings)==null?void 0:r.price)===b.TAX_INCLUDED_AND_EXCLUDED?(t.amount=(l=e.prices.rowTotalIncludingTax)==null?void 0:l.value,t.currency=(d=e.prices.rowTotalIncludingTax)==null?void 0:d.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="including-tax-item-total",a&&(t.amount=(m=e.prices.originalRowTotal)==null?void 0:m.value,t.currency=(x=e.prices.originalRowTotal)==null?void 0:x.currency,a.amount=(I=e.prices.rowTotalIncludingTax)==null?void 0:I.value,a.currency=(E=e.prices.rowTotalIncludingTax)==null?void 0:E.currency,a.sale=!0,a["aria-label"]=n.dictionary.discountedPrice,a["data-testid"]="discount-total")):(t.amount=(c=e.prices.originalRowTotal)==null?void 0:c.value,t.currency=(f=e.prices.originalRowTotal)==null?void 0:f.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="regular-item-total",a&&(a.amount=(p=e.discountedTotal)==null?void 0:p.value,a.currency=(P=e.discountedTotal)==null?void 0:P.currency,a.sale=!0,a["aria-label"]=n.dictionary.discountedPrice,a["data-testid"]="discount-total")),{totalProps:t,discountProps:a}},Te=e=>{const n=e==null?void 0:e.map(a=>({label:a.label,value:a.values.map(o=>o.label).join(", ")})),t={};return n==null||n.forEach(a=>{t[a.label]=a.value}),Object.keys(t).length>0?t:null},Se=e=>{const n=e==null?void 0:e.map(a=>({label:a.optionLabel,value:a.valueLabel})),t={};return n==null||n.forEach(a=>{t[a.label]=a.value}),Object.keys(t).length>0?t:null},Qe=e=>{const n=e==null?void 0:e.map(a=>({label:a.label,type:a.type,values:a.values.map(o=>({label:o.label,value:o.value}))})),t={};return n==null||n.forEach(a=>{var o;switch(a.type){case"field":case"area":case"date_time":t[a.label]=a.values[0].value;break;case"radio":case"drop_down":t[a.label]=a.values[0].label;break;case"multiple":case"checkbox":t[a.label]=a.values.reduce((r,l)=>r?`${r}, ${l.label}`:l.label,"");break;case"file":{const r=new DOMParser,l=a.values[0].value,m=((o=r.parseFromString(l,"text/html").querySelector("a"))==null?void 0:o.textContent)||"";t[a.label]=m;break}}}),t},qe=4,V=(e,n,t)=>{var r;if(t.attributesToHide.includes("image"))return;const a={loading:n<qe?"eager":"lazy",src:e.image.src,alt:e.image.alt,width:"300",height:"300",params:{width:300}},o=i(se,{"data-testid":"quote-summary-list-item-image",...a});return i(s,{name:"Thumbnail",slot:(r=t.slots)==null?void 0:r.Thumbnail,context:{item:e,defaultImageProps:a},children:t.routeProduct?i("a",{href:t.routeProduct(e),children:o}):o})},W=(e,n)=>{if(!n.attributesToHide.includes("name"))return i("span",{"data-testid":"quote-summary-list-item-title",children:n.routeProduct?i("a",{href:n.routeProduct(e),children:e.product.name}):e.product.name})},Y=e=>i("span",{"data-testid":"quote-summary-list-item-sku",children:e.product.sku}),H=(e,n)=>{var t;return i(s,{name:"ProductAttributes",slot:(t=n.slots)==null?void 0:t.ProductAttributes,context:{item:e}})},J=(e,n)=>{if(n.attributesToHide.includes("configurations"))return;const t={...Te(e.bundleOptions),...Se(e.configurableOptions),...Qe(e.customizableOptions),...e.links&&e.links.count?e.links.count>1?{[n.dictionary.files.replace("{count}",e.links.count.toString())]:e.links.result}:{[n.dictionary.file.replace("{count}",e.links.count.toString())]:e.links.result}:null};if(Object.keys(t).length!==0)return t},K=(e,n)=>{var t;return((t=n.quoteDisplaySettings)==null?void 0:t.price)===b.TAX_INCLUDED_AND_EXCLUDED?i(q,{amount:e.prices.rowTotal.value,currency:e.prices.rowTotal.currency,"data-testid":"excluding-tax-total","aria-label":n.dictionary.regularPrice}):void 0},Xe=({hideHeading:e,hideFooter:n,routeProduct:t,showMaxItems:a=!0,attributesToHide:o=[],slots:r,accordion:l=!1,variant:d="primary",showDiscount:m,showSavings:x,...I})=>{const{quoteData:c,loading:f}=Ie(),[p,P]=N(a),{quoteDisplaySettings:g,quoteSummaryMaxItems:Z}=fe.config,w=Z||5,y=_e({discountedPrice:"NegotiableQuote.QuoteSummaryList.discountedPrice",discountPercentage:"NegotiableQuote.QuoteSummaryList.discountPercentage",editQuote:"NegotiableQuote.QuoteSummaryList.editQuote",file:"NegotiableQuote.QuoteSummaryList.file",files:"NegotiableQuote.QuoteSummaryList.files",heading:"NegotiableQuote.QuoteSummaryList.heading",listOfQuoteItems:"NegotiableQuote.QuoteSummaryList.listOfQuoteItems",regularPrice:"NegotiableQuote.QuoteSummaryList.regularPrice",savingsAmount:"NegotiableQuote.QuoteSummaryList.savingsAmount",viewMore:"NegotiableQuote.QuoteSummaryList.viewMore"}),ee=ce(()=>{P(h=>!h)},[]),T={attributesToHide:o,routeProduct:t,slots:r,dictionary:y,quoteDisplaySettings:g},L={dictionary:y,quoteDisplaySettings:g},O=h=>i(s,{name:"Footer",slot:r==null?void 0:r.Footer,context:{item:h}}),te=h=>c!=null&&c.totalQuantity?c.items.filter(h).map((u,X)=>{const{totalProps:ne,discountProps:$}=G(u,L),ie=i(he,{loading:f,"data-testid":`quote-summary-list-item-entry-${u.uid}`,image:V(u,X,T),title:i(s,{name:"ItemTitle",slot:r==null?void 0:r.ItemTitle,context:{item:u},children:W(u,T)}),sku:o.includes("sku")?void 0:i(s,{name:"ItemSku",slot:r==null?void 0:r.ItemSku,context:{item:u},children:Y(u)}),price:o.includes("price")?void 0:i(s,{name:"ItemPrice",slot:r==null?void 0:r.ItemPrice,context:{item:u},slotTag:"span",children:i(q,{...B(u,L)})}),quantity:o.includes("quantity")?void 0:u.quantity,total:_(C,{children:[o.includes("total")?void 0:i(s,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:u},children:i(q,{...ne})}),o.includes("totalDiscount")?void 0:$&&i(s,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:u},children:i(q,{...$})})]}),attributes:H(u,T),configurations:J(u,T),totalExcludingTax:o.includes("totalExcludingTax")?void 0:K(u,T),taxIncluded:(g==null?void 0:g.price)===b.TAX_INCLUDED,taxExcluded:!o.includes("totalExcludingTax")&&(g==null?void 0:g.price)===b.TAX_INCLUDED_AND_EXCLUDED,discount:m&&u.discounted&&u.discountPercentage!==void 0?i("div",{"data-testid":"item-discount-percentage",children:y.discountPercentage.replace("{discount}",u.discountPercentage.toString())}):void 0,savings:x&&u.discounted&&u.savingsAmount!==void 0?_("div",{children:[i("span",{children:i(q,{...z(u)})}),"Â ",y.savingsAmount]}):void 0,footer:O(u)},u.uid);return i(s,{name:"CartItem",slot:r==null?void 0:r.QuoteItem,context:{item:u,index:X,loading:f,attributesToHide:o,quoteDisplaySettings:g,showDiscount:m,showSavings:x,dictionary:y,getImage:V,getTitle:W,getSku:Y,getPriceProps:B,getTotalPriceProps:G,getProductAttributes:H,getConfigurations:J,getTotalExcludingTax:K,getFooter:O,getSavingsAmount:z},children:ie},u.uid)}):null,M=i(s,{name:"Heading",slot:r==null?void 0:r.Heading,context:{count:(c==null?void 0:c.totalQuantity)??0,quoteId:c==null?void 0:c.uid},children:i("div",{"data-testid":"default-quote-summary-list-heading",children:y.heading.replace("({count})",c!=null&&c.totalQuantity?`(${c==null?void 0:c.totalQuantity.toString()})`:"")})}),D=M.props.children.props.children,k=te(h=>!h.outOfStock&&!h.insufficientQuantity),S=(c==null?void 0:c.items.length)||0,ae=p?Math.min(S,w):S,re=S>ae,R=c!=null&&c.totalQuantity&&k?i(s,{name:"Footer",slot:r==null?void 0:r.QuoteSummaryFooter,context:{displayMaxItems:p},"data-testid":"quote-summary-list-footer-slot",className:"quote-management-quote-summary-list-footer",children:re?i(de,{className:"quote-management-quote-summary-list-footer__action",onClick:ee,"data-testid":"view-more-items-button",variant:"tertiary",children:y.viewMore}):null}):null,U=c!=null&&c.totalQuantity?i(me,{"data-testid":"quote-summary-list",children:k==null?void 0:k.slice(0,p?Math.min(S,w):S)}):null;return l?i(ge,{"data-testid":"quote-summary-list-accordion",className:v(["quote-management-quote-summary-list-accordion",`quote-management-quote-summary-list__background--${d}`]),iconOpen:be,iconClose:ve,children:i(ye,{title:D,ariaLabelTitle:D,"data-testid":"quote-summary-list-accordion__section",open:!0,renderContentWhenClosed:!0,children:i(F,{...I,"aria-expanded":!0,"aria-label":y.listOfQuoteItems,className:"quote-management-quote-summary-list-accordion__list",footer:n?void 0:R,products:U,outOfStockMessage:void 0,loading:f,variant:d})})}):i(F,{...I,heading:e?void 0:M,footer:n?void 0:R,products:U,outOfStockMessage:void 0,loading:f,variant:d})};export{Xe as QuoteSummaryList,Xe as default};
//# sourceMappingURL=QuoteSummaryList.js.map
