/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as Q,jsx as t}from"@dropins/tools/preact-jsx-runtime.js";import{useState as v,useEffect as G}from"@dropins/tools/preact-compat.js";import{classes as B,Slot as c}from"@dropins/tools/lib.js";import{Table as C,IllustratedMessage as $,Picker as H,Pagination as J,Button as K,Price as W}from"@dropins/tools/components.js";import{events as X}from"@dropins/tools/event-bus.js";/* empty css                                     */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{useText as w}from"@dropins/tools/i18n.js";import{f as I}from"../chunks/dateUtils.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{g as q}from"../chunks/transform-quote.js";import"../chunks/state.js";import{g as Y}from"../chunks/getQuoteTemplates.js";import"@dropins/tools/fetch-graphql.js";const Z=({rowData:p=[],loading:h=!1,className:y,emptyStateMessage:T,showItemRange:x=!0,itemRangeMessage:m,showPageSizePicker:u=!0,pageSizePickerMessage:i,showPagination:z=!0,paginationMessage:S,...l})=>{const d=w({name:"QuoteManagement.QuoteTemplatesListTable.name",state:"QuoteManagement.QuoteTemplatesListTable.state",status:"QuoteManagement.QuoteTemplatesListTable.status",validUntil:"QuoteManagement.QuoteTemplatesListTable.validUntil",minQuoteTotal:"QuoteManagement.QuoteTemplatesListTable.minQuoteTotal",ordersPlaced:"QuoteManagement.QuoteTemplatesListTable.ordersPlaced",lastOrdered:"QuoteManagement.QuoteTemplatesListTable.lastOrdered",actions:"QuoteManagement.QuoteTemplatesListTable.actions"}),O=[{key:"name",label:d.name},{key:"state",label:d.state},{key:"status",label:d.status},{key:"validUntil",label:d.validUntil},{key:"minQuoteTotal",label:d.minQuoteTotal},{key:"ordersPlaced",label:d.ordersPlaced},{key:"lastOrdered",label:d.lastOrdered},{key:"actions",label:d.actions}],s=!h&&p.length===0&&T,f=x&&m,g=u&&i,P=z&&S,b=f||g||P;return Q("div",{...l,className:B(["quote-management-quote-templates-list-table",y]),children:[t(C,{columns:O,rowData:p,loading:h,mobileLayout:"none",className:"quote-management-quote-templates-list-table__table"}),s&&t("div",{className:"quote-templates-list-table__empty-state",children:T}),b&&Q("div",{className:"quote-templates-list-table__footer",children:[t("div",{className:"quote-templates-list-table__item-range",children:f&&m}),t("div",{className:"quote-templates-list-table__pagination",children:P&&S}),t("div",{className:"quote-templates-list-table__page-size-picker",children:g&&i})]})]})},Te=({pageSize:p,showItemRange:h=!0,showPageSizePicker:y=!0,showPagination:T=!0,onViewQuoteTemplate:x,onPageSizeChange:m,onPageChange:u,slots:i,...z})=>{const S=w({view:"QuoteManagement.QuoteTemplatesListTable.view"}),[l,d]=v(null),[O,s]=v(!0),f=q()[0],[g,P]=v(p||f),[b,L]=v(1);G(()=>{const r=async()=>{try{s(!0);const o=await Y({pageSize:g,currentPage:b});d(o)}catch(o){console.error("Failed to fetch quote templates:",o)}finally{s(!1)}},e=X.on("authenticated",o=>{o?r():(d(null),s(!1))},{eager:!0});return()=>{e==null||e.off()}},[g,b]);const N=r=>{P(r),L(1),m==null||m(r)},_=r=>{L(r),u==null||u(r)},U=r=>{const e=r.target,o=e==null?void 0:e.value;o&&N(Number(o))},R=(r,e,o)=>r.filter(a=>a==null?void 0:a.uid).map(a=>{var M;return{id:a.id,name:t(c,{name:"Name",slot:e==null?void 0:e.Name,context:{template:a},children:t("span",{children:a.name})}),state:t(c,{name:"State",slot:e==null?void 0:e.State,context:{template:a},children:t("span",{style:{textTransform:"capitalize"},children:((M=a.state)==null?void 0:M.replace(/_/g," "))||"-"})}),status:t(c,{name:"Status",slot:e==null?void 0:e.Status,context:{template:a},children:t("span",{children:a.status})}),validUntil:t(c,{name:"ValidUntil",slot:e==null?void 0:e.ValidUntil,context:{template:a},children:t("span",{children:I(a.expirationDate,"short")})}),minQuoteTotal:t(c,{name:"MinQuoteTotal",slot:e==null?void 0:e.MinQuoteTotal,context:{template:a},children:t(W,{amount:a.prices.minNegotiatedGrandTotal.value,currency:a.prices.minNegotiatedGrandTotal.currency})}),ordersPlaced:t(c,{name:"OrdersPlaced",slot:e==null?void 0:e.OrdersPlaced,context:{template:a},children:t("span",{children:a.ordersPlaced})}),lastOrdered:t(c,{name:"LastOrdered",slot:e==null?void 0:e.LastOrdered,context:{template:a},children:t("span",{children:I(a.lastOrderedAt,"short")})}),actions:t(c,{name:"Actions",slot:e==null?void 0:e.Actions,context:{template:a,onViewQuoteTemplate:o},children:t(K,{variant:"tertiary",size:"medium",onClick:()=>o==null?void 0:o(a.uid,a.name,a.status),children:S.view})})}}),E=l!=null&&l.items?R(l.items,i,x):[],n=l!=null&&l.paginationInfo?{...l.paginationInfo,pageSizeOptions:q()}:void 0,k=!!n,A=t(c,{name:"EmptyTemplates",slot:i==null?void 0:i.EmptyTemplates,context:{templatesData:l},children:t($,{heading:"No Quote Templates Found"})}),F=n?t(c,{name:"ItemRange",slot:i==null?void 0:i.ItemRange,context:n,children:Q("span",{children:["Items ",n.startItem," to ",n.endItem," of"," ",n.totalCount," total"]})}):void 0,j=n&&n.pageSizeOptions?Q(c,{name:"PageSizePicker",slot:i==null?void 0:i.PageSizePicker,context:{pageSize:n.pageSize,pageSizeOptions:n.pageSizeOptions,onPageSizeChange:N},children:[t("span",{children:"Show "}),t(H,{variant:"primary",size:"medium",value:String(n.pageSize),options:n.pageSizeOptions.map(r=>({value:String(r),text:String(r)})),handleSelect:U}),t("span",{children:" per page"})]}):void 0,D=n?t(c,{name:"Pagination",slot:i==null?void 0:i.Pagination,context:{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_},children:t(J,{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_})}):void 0;return t(Z,{rowData:E,loading:O,className:z.className,emptyStateMessage:A,showItemRange:h&&k,itemRangeMessage:F,showPageSizePicker:y&&k,pageSizePickerMessage:j,showPagination:T&&k,paginationMessage:D})};export{Te as QuoteTemplatesListTable,Te as default};
//# sourceMappingURL=QuoteTemplatesListTable.js.map
