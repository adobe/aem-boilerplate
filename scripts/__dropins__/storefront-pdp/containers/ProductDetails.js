/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as k,Fragment as Ft}from"@dropins/tools/preact-jsx-runtime.js";import{useState as J,Children as Lt,useEffect as et,useCallback as nt,useMemo as Jt}from"@dropins/tools/preact-compat.js";import{VComponent as u,classes as v,Slot as A,toLanguageTag as Et}from"@dropins/tools/lib.js";import{Incrementer as Zt,Image as Mt,Button as qt,Icon as st,Breadcrumbs as At}from"@dropins/tools/components.js";/* empty css             */import{Z as Kt,C as rt,O as $t}from"../chunks/Zoom.js";import"@dropins/tools/preact-hooks.js";/* empty css                       */import{useText as L}from"@dropins/tools/i18n.js";import{P as Gt}from"../chunks/PriceRange.js";import{S as Wt}from"../chunks/Swatches.js";import"@dropins/tools/preact.js";import{G as Xt}from"../chunks/GiftCardOptions2.js";import{c as Tt,k as Yt,j as Pt,p as ft,l as Rt,t as gt}from"../chunks/fetchProductData.js";import{events as pt}from"@dropins/tools/event-bus.js";import{i as Ct,t as te}from"../chunks/date.js";import"../fragments.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/isProductConfigurationValid.js";const ee=({title:h,breadcrumbs:N,galleryContent:O,infoContent:I,productContent:D,sku:w,outOfStock:U,shortDescription:E,description:p,attributes:ct,images:c,options:a,giftCardOptions:s,price:f,specialPrice:H,className:dt,children:yt,quantity:M,actions:g,carouselConfig:n,zoomType:lt="overlay",closeButton:it=!0,...at})=>{var Z,G,_,K,R,C,tt,$,T;const x=L("PDP.Product.RegularPrice.label").label,ht=L("PDP.Product.SpecialPrice.label").label,ot=L("PDP.Product.OutOfStock.label").label,B=L("PDP.Product.Image.label").label,[t,q]=J(null),b=c!=null&&c.length?c.map((F,y)=>{var W;const j=((W=h==null?void 0:h.props)==null?void 0:W.children)&&(B==null?void 0:B.replace("{product}",h.props.children.toString()).replace("{key}",String(y+1)).replace("{total}",String(c.length)));return lt==="zoom"?e(Kt,{closeButton:it,children:e(u,{node:F,loading:y===0?"eager":"lazy",alt:j},y)}):e(u,{node:F,loading:y===0?"eager":"lazy",alt:j,onClick:()=>q(y)},y)}):e("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),Q=(Z=n==null?void 0:n.thumbnails)!=null&&Z.length?n.thumbnails.map((F,y)=>{var j;return e(u,{node:F,loading:(n==null?void 0:n.thumbnailsLoadingMode)||"lazy",alt:((j=h==null?void 0:h.props)==null?void 0:j.children)&&(B==null?void 0:B.replace("{product}",h.props.children.toString()).replace("{key}",String(y+1)).replace("{total}",String(c.length)))},y)}):e("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return k("div",{...at,className:v(["pdp-product",dt]),children:[N&&e(u,{node:N,className:"pdp-product__breadcrumbs"}),k("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[e("div",{className:"pdp-product__column-body",children:(G=n==null?void 0:n.controls)!=null&&G.desktop?e(rt,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?n.controls.desktop:"dots",arrowsOnMainImage:n==null?void 0:n.arrowsOnMainImage,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((_=n==null?void 0:n.thumbnails)==null?void 0:_.length)>1&&((K=n==null?void 0:n.peak)==null?void 0:K.desktop)||!1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"100%",defaultIndex:t||0,thumbnails:Q,children:b}):e(ne,{className:"pdp-product__images",gap:"small",children:b})}),O&&e(u,{node:O,className:"pdp-product__gallery-content"})]}),k("div",{className:"pdp-product__column-container pdp-product__content-column",children:[k("div",{className:"pdp-product__column-body",children:[k("div",{className:"pdp-product__header",children:[h&&e(u,{node:h,className:"pdp-product__title"}),w&&e(u,{node:w,className:"pdp-product__sku"})]}),k("div",{className:"pdp-product__prices",children:[H&&e(u,{node:H,className:v(["pdp-product__price-special","pdp-product__price"]),"aria-label":ht,role:"text"}),f&&e(u,{node:f,className:v(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":x,role:"text"})]}),(R=n==null?void 0:n.controls)!=null&&R.mobile&&((C=n==null?void 0:n.controls)==null?void 0:C.mobile)==="thumbnailsRow"?e(rt,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((tt=n==null?void 0:n.thumbnails)==null?void 0:tt.length)>1&&(($=n==null?void 0:n.peak)==null?void 0:$.mobile)||!1,gap:(n==null?void 0:n.gap)||null,thumbnails:Q,children:b}):e(rt,{className:"pdp-product__images pdp-product__images--carousel",peak:((T=n==null?void 0:n.peak)==null?void 0:T.mobile)&&(c==null?void 0:c.length)>1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,children:b}),k("div",{className:v(["pdp-product__actions",["pdp-product__actions--out-of-stock",U]]),children:[U&&e("div",{className:"pdp-product__out-of-stock__text",children:ot}),a&&e(u,{node:a,className:v(["pdp-product__options"])}),s&&e(u,{node:s,className:v(["pdp-product__gift-card-options"])}),M&&e("div",{className:"pdp-product__quantity",children:e(u,{node:M})}),g&&e(u,{node:g,className:v(["pdp-product__buttons"])})]}),E&&e(u,{node:E,className:v(["pdp-product__short_description"])}),p&&e(u,{node:p,className:v(["pdp-product__description"])}),ct?e("div",{className:"pdp-product__attributes",children:ct}):null]}),I&&e(u,{node:I,className:"pdp-product__info-content"})]}),D&&e(u,{node:D,className:"pdp-product__content"}),t===null?null:e($t,{className:"pdp-product__overlay",onClose:()=>q(null),centered:!0,children:e(rt,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:t||0,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:b})})]})},ne=({children:h,gap:N=null,className:O,style:I,...D})=>{const w=Lt.count(h);return e("div",{...D,className:v(["pdp-gallery-grid",O]),style:{"--gap":N?`var(--spacing-${N})`:"0px",...I},children:Lt.map(h,(U,E)=>e("div",{className:"pdp-gallery-grid__item",children:e(u,{node:U,loading:E===0?"eager":"lazy"},U.props.src)},w+E))})},re=({sku:h,hideSku:N,hideQuantity:O,hideShortDescription:I,hideDescription:D,hideAttributes:w,hideURLParams:U,hideSelectedOptionValue:E,slots:p,children:ct,initialData:c,carousel:a,optionsConfig:s,useACDL:f,onAddToCart:H,zoomType:dt,closeButton:yt=!0,disableDropdownPreselection:M,...g})=>{var W,Ot,St,vt,Nt,It,Dt,wt,Vt,kt,Ut;const n=L("PDP.Product.AddToCart.label").label,lt=L("PDP.Product.Incrementer.label").label,it=L("PDP.Product.Details.label").label,at=L("PDP.Swatches.ChooseOption.label").label,[x,ht]=J(Tt.getConfig().defaultLocale||"en-US"),[ot,B]=J(),[t=null,q]=J(c),[b,Q]=J(()=>{const r=Yt(1),d={sku:h,quantity:r};return t!=null&&t.optionUIDs&&(d.optionsUIDs=t.optionUIDs),d}),[Z,G]=J(()=>{var r,d;return!(t!=null&&t.options&&((r=t==null?void 0:t.options)==null?void 0:r.length)>0&&((d=t==null?void 0:t.optionUIDs)==null?void 0:d.length)!==(t==null?void 0:t.options.length))}),_={data:t,values:b,valid:Z};function K(r){return r==null?void 0:r.some(d=>(d==null?void 0:d.typename)==="ProductViewOptionValueProduct")}et(()=>{const r=pt.on("pdp/data",l=>{l&&(q(l),Q(i=>({...i,sku:l.sku,optionsUIDs:l.optionUIDs})))}),d=pt.on("pdp/setValues",l=>{Q(i=>({...i,...l}))});return()=>{d==null||d.off(),r==null||r.off()}},[]),et(()=>{const r=pt.on("locale",d=>{d!==x&&(ht(d),Pt(h,{preselectFirstOption:!M,anchors:s==null?void 0:s.anchorOptions}).then(q))});return()=>{r==null||r.off()}},[M,x,s==null?void 0:s.anchorOptions,h]),et(()=>{f&&c&&Object.keys(c).length>0&&ft(c)},[c]);const R=nt(r=>{Q(d=>({...d,...r}))},[]);et(()=>{pt.emit("pdp/values",b)},[JSON.stringify(b)]);const C=nt(async r=>{var i,o;let d=Object.entries(r).filter(([m,P])=>P.label!==at).map(([m,P])=>r[m].value).filter(m=>m!==void 0);!U&&(t!=null&&t.options)&&!K(t.options)&&Rt({optionsUIDs:d.join(",")}),R({optionsUIDs:d}),G((d==null?void 0:d.length)===((i=t==null?void 0:t.options)==null?void 0:i.length));const l=await Pt(h,{anchors:s==null?void 0:s.anchorOptions,isBundle:t==null?void 0:t.isBundle,optionsUIDs:d,preselectFirstOption:!M});q(l),(o=s==null?void 0:s.anchorOptions)!=null&&o.length&&tt(l,d)},[h]),tt=nt((r,d)=>{var o;const l=(r==null?void 0:r.optionUIDs)??[];d.every(m=>l.includes(m))||(B(r==null?void 0:r.options),R({optionsUIDs:l}),G((l==null?void 0:l.length)===((o=r==null?void 0:r.options)==null?void 0:o.length)))},[h]),$=nt(r=>{Object.keys(r).length!==0&&G(!1)},[]),T=Jt(()=>{var r;return(r=t==null?void 0:t.attributes)==null?void 0:r.map(({label:d,value:l,id:i},o)=>{if(i==="ac_giftcard")return"";const m=Ct(l)?te(l,x):l.toString();return k("li",{children:[d,": ",e("span",{dangerouslySetInnerHTML:{__html:m}})]},o)})},[t==null?void 0:t.attributes,x]),F=!O&&(t!=null&&t.inStock)?e(A,{name:"Quantity",slot:p==null?void 0:p.Quantity,context:{..._},children:e(Zt,{name:"quantity",defaultValue:b.quantity.toString(),value:b.quantity.toString(),min:1,"aria-label":lt,className:"pdp-product__quantity",onValue:r=>{const d=Number(r);R({quantity:d}),!U&&(t!=null&&t.options)&&(K(t.options)||Rt({quantity:d}))}},"quantity")}):void 0,y=()=>{if(t!=null&&t.options)return e(A,{name:"Options",slot:p==null?void 0:p.Options,context:{..._},children:e(Wt,{selectedUIDs:b.optionsUIDs,options:t.options,defaultOptions:b.optionsUIDs,selectionsToUpdate:ot,hideSelectedValue:E,disablePreselections:M,onValues:C,onErrors:$})})},j=()=>{if(t!=null&&t.attributes){const r=t.attributes.filter(d=>d.id==="ac_giftcard");if(r.length>0){const l=r.map((i,o)=>{var m;try{const P=JSON.parse(i.value),mt=b.enteredOptions||[],jt=((m=P.options)==null?void 0:m.map(S=>{const z=mt.find(X=>X.uid===S.uid);return{id:S.uid,value:(z==null?void 0:z.value)||""}}))||[];return e(Xt,{options:P.options||[],optionValues:jt,onOptionChange:(S,z)=>{var xt;const X=b.enteredOptions||[],zt=X.findIndex(V=>V.uid===S);let ut;if(zt!==-1?ut=X.map(V=>V.uid===S?{...V,value:z}:V):ut=[...X,{uid:S,value:z}],R({enteredOptions:ut}),t){const V={...t},Ht=((xt=V.attributes)==null?void 0:xt.map(Y=>{var Bt;if(Y.id==="ac_giftcard")try{const _t=JSON.parse(Y.value),Qt=((Bt=_t.options)==null?void 0:Bt.map(bt=>bt.uid===S?{...bt,value:z}:bt))||[];return{...Y,value:JSON.stringify({..._t,options:Qt})}}catch{return Y}return Y}))||[];V.attributes=Ht,q(V)}},onValidationChange:S=>{S||$({giftCard:"Invalid gift card data"}),G(S)},className:"pdp-product__gift-card-options"},`giftcard-${o}`)}catch(P){return console.warn("Invalid gift card data format:",P),null}}).filter(i=>i!==null);return l.length>0?e("div",{className:"pdp-product__gift-card-options-container",children:l}):void 0}}};return e("div",{...g,children:e(ee,{title:e(A,{name:"Title",slot:p==null?void 0:p.Title,context:{..._},children:t==null?void 0:t.name}),sku:N?void 0:e(A,{name:"SKU",slot:p==null?void 0:p.SKU,context:{..._},children:t==null?void 0:t.sku}),options:y(),giftCardOptions:j(),breadcrumbs:(p==null?void 0:p.Breadcrumbs)&&e(A,{name:"Breadcrumbs",slot:p==null?void 0:p.Breadcrumbs,context:{..._,setSeparator(r){this._registerMethod((...d)=>{const l=r(...d),i=l&&e(st,{source:l});this._setProps(o=>({...o,separator:i,children:[e(At,{separator:i,categories:o.categories})]}))})},appendLink(r){this._registerMethod((...d)=>{const{text:l,...i}=r(...d),o=e("a",{...i,children:l});this._setProps(m=>{const P=[...m.categories||[],o];return{...m,categories:P,children:[e(At,{separator:m.separator,categories:P})]}})})},appendHTMLElement(r){this._registerMethod((...d)=>{const l=r(...d),i=this._htmlElementToVNode(l);this._setProps(o=>{const m=[...o.categories||[],i];return{...o,categories:m,children:[e(At,{separator:o.separator,categories:m})]}})})}}}),quantity:F,actions:e(A,{name:"Actions",slot:p==null?void 0:p.Actions,context:{..._,appendButton(r){this._registerMethod((...d)=>{const l=r(...d);if(!l)return;const{text:i,icon:o,...m}=l,P=e(qt,{type:"button",...m,icon:o&&e(st,{source:o}),children:i});this._setProps(mt=>({children:[...mt.children||[],P]}))})}},children:!(p!=null&&p.Actions)&&e(qt,{size:"medium",type:"submit",icon:e(st,{source:"Cart"}),disabled:!(t!=null&&t.inStock)||!Z,"aria-label":n,onClick:()=>H==null?void 0:H(b),children:n})}),shortDescription:I?void 0:e(A,{name:"ShortDescription",slot:p==null?void 0:p.ShortDescription,context:{..._},children:e("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.shortDescription)??""}})}),description:D?void 0:e(A,{name:"Description",slot:p==null?void 0:p.Description,context:{..._},children:e("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.description)??""}})}),images:((W=t==null?void 0:t.images)==null?void 0:W.map(({label:r,url:d})=>{var l,i;return e(Mt,{title:r,alt:r,src:d,width:((l=a==null?void 0:a.imageParams)==null?void 0:l.width)??960,height:((i=a==null?void 0:a.imageParams)==null?void 0:i.height)??1191,params:(a==null?void 0:a.imageParams)??{width:960}},d)}))??[],specialPrice:(Ot=t==null?void 0:t.prices)!=null&&Ot.visible?e(A,{name:"SpecialPrice",slot:p==null?void 0:p.SpecialPrice,context:{..._},children:e(Gt,{...(St=t.prices)==null?void 0:St.final,locale:Et(x)})}):void 0,price:(vt=t==null?void 0:t.prices)!=null&&vt.visible&&((Nt=t==null?void 0:t.prices)!=null&&Nt.regular)&&((Dt=(It=t==null?void 0:t.prices)==null?void 0:It.final)==null?void 0:Dt.amount)!==((Vt=(wt=t==null?void 0:t.prices)==null?void 0:wt.regular)==null?void 0:Vt.amount)?e(A,{name:"RegularPrice",slot:p==null?void 0:p.RegularPrice,context:{..._},children:e(Gt,{...(kt=t.prices)==null?void 0:kt.regular,locale:Et(x)})}):void 0,zoomType:dt,closeButton:yt,carouselConfig:{...a,thumbnails:a&&Object.keys(a).length?((Ut=t==null?void 0:t.images)==null?void 0:Ut.map(({label:r,url:d})=>{var l,i;return e(Mt,{title:r,alt:r,src:d,width:((l=a==null?void 0:a.thumbnailParams)==null?void 0:l.width)??200,height:((i=a==null?void 0:a.thumbnailParams)==null?void 0:i.height)??248,params:(a==null?void 0:a.thumbnailParams)??{width:200}},d)}))??[]:[]},outOfStock:!(t!=null&&t.inStock),attributes:w?void 0:e(A,{name:"Attributes",slot:p==null?void 0:p.Attributes,context:{..._},children:T!=null&&T.length?k(Ft,{children:[it,e("ul",{children:T})]}):null}),galleryContent:(p==null?void 0:p.GalleryContent)&&e(A,{name:"GalleryContent",slot:p.GalleryContent,context:{..._}}),infoContent:(p==null?void 0:p.InfoContent)&&e(A,{name:"InfoContent",slot:p.InfoContent,context:{..._}}),productContent:(p==null?void 0:p.Content)&&e(A,{name:"Content",slot:p.Content,context:{..._}})})})};re.getInitialData=async function({sku:h,disableDropdownPreselection:N=!1,optionsConfig:O}){var D,w;const I=(w=(D=Tt.getConfig().models)==null?void 0:D.ProductDetails)==null?void 0:w.initialData;return I?gt(I):Pt(h,{preselectFirstOption:!N,anchors:O==null?void 0:O.anchorOptions})};export{re as ProductDetails,re as default};
//# sourceMappingURL=ProductDetails.js.map
