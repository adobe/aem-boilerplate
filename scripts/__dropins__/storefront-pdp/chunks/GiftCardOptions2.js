/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as P,jsx as h}from"@dropins/tools/preact-jsx-runtime.js";import{useState as y,useCallback as I,useMemo as M,useEffect as A}from"@dropins/tools/preact-hooks.js";import{Field as B,TextArea as V,Picker as j,Input as $}from"@dropins/tools/components.js";import{classes as z}from"@dropins/tools/lib.js";/* empty css               */import{useText as u}from"@dropins/tools/i18n.js";const H=c=>{switch(c){case"number":return"number";case"email":return"email";default:return"text"}},J=c=>c.name==="giftcard/giftcard_message"?"textarea":c.name==="giftcard/giftcard_amount"?"picker":"input",K=(c,a,i)=>[{text:a,value:"0",disabled:!1},...c.map(l=>({text:l.toString(),value:l.toString(),disabled:!1})),{text:i,value:"other",disabled:!1}],x=(c,a,i)=>{const{validationRule:t}=c;if(c.name==="giftcard/giftcard_amount"){if(t.required&&(a==="0"||!a||a.trim()==="")||a==="0")return i.RequiredFieldError;if(a==="other")return""}else if(t.required&&(!a||a.trim()===""))return i.RequiredFieldError;if(!a||a.trim()==="")return"";switch(t.type){case"email":{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))return i.EmailError;break}case"number":{const l=Number(a);if(isNaN(l))return i.NumberError;if(t.min!==void 0&&l<t.min)return i.MinError.replace("{min}",t.min.toString());if(t.max!==void 0&&l>t.max)return i.MaxError.replace("{max}",t.max.toString());if(t.values&&!t.values.some(g=>typeof g=="number"?g===l:g===a))return i.InvalidValueError.replace("{values}",t.values.join(", "));break}case"string":{const l=a.length;if(t.minLength!==void 0&&l<t.minLength)return i.MinLengthError.replace("{min_length}",t.minLength.toString());if(t.maxLength!==void 0&&l>t.maxLength)return i.MaxLengthError.replace("{max_length}",t.maxLength.toString());break}}return""},rr=({options:c,currency:a,optionValues:i,onOptionChange:t,onValidationChange:l})=>{const v=u("PDP.Product.GiftCardOptions.ChooseAmount.label").label,g=u("PDP.Product.GiftCardOptions.OtherAmount.label").label,C=u("PDP.Product.GiftCardOptions.RequiredFieldError.label").label,w=u("PDP.Product.GiftCardOptions.NumberError.label").label,N=u("PDP.Product.GiftCardOptions.MinError.label").label,O=u("PDP.Product.GiftCardOptions.MaxError.label").label,G=u("PDP.Product.GiftCardOptions.MinLengthError.label").label,L=u("PDP.Product.GiftCardOptions.MaxLengthError.label").label,S=u("PDP.Product.GiftCardOptions.EmailError.label").label,D=u("PDP.Product.GiftCardOptions.InvalidValueError.label").label,[q,R]=y({}),[_,F]=y(!1),n=I(r=>c.find(e=>e.name===r),[c]),p=M(()=>({RequiredFieldError:C,NumberError:w,MinError:N,MaxError:O,MinLengthError:G,MaxLengthError:L,EmailError:S,InvalidValueError:D}),[C,w,N,O,G,L,S,D]);A(()=>{const r=c.every(e=>{if(e.name==="giftcard/custom_giftcard_amount"&&!_)return!0;const d=i.find(f=>f.id===e.uid),s=(d==null?void 0:d.value)||"";return x(e,s,p)===""});l(r)},[c,i,l,p,_]),A(()=>{const r=n("giftcard/giftcard_amount"),e=n("giftcard/custom_giftcard_amount"),d=i.find(o=>o.id===(r==null?void 0:r.uid)),s=(d==null?void 0:d.value)||"",f=_,b=s==="other";F(b),f&&!b&&e&&t(e.uid,"")},[i,n,_,t]);const E=(r,e)=>{const d=x(r,e,p);R(s=>({...s,[r.uid]:d})),t(r.uid,e)},k=(r,e)=>{const d=x(r,e,p);R(s=>({...s,[r.uid]:d}))},T=(r,e)=>{const d=e.target.value;E(r,d)},m=r=>{const e=i.find(o=>o.id===r.uid),d=e==null?void 0:e.value,s=q[r.uid],f=J(r);let b=r.label;return r.name==="giftcard/custom_giftcard_amount"&&a&&(b=`${r.label} ${a}`),h(B,{label:b,className:z(["pdp-gift-card-options__option-field",f==="textarea"&&"pdp-gift-card-options__option-field--full-width"]),error:s,children:f==="textarea"?h(V,{value:d,label:r.label,onChange:o=>E(r,o.target.value),onBlur:o=>k(r,o.target.value),"aria-invalid":!!s}):f==="picker"?h(j,{"aria-label":r.label,label:r.label,handleSelect:o=>T(r,o),options:K(r.validationRule.values||[],v,g),value:d,"aria-invalid":!!s}):h($,{type:H(r.validationRule.type),value:d,onChange:o=>E(r,o.target.value),onBlur:o=>k(r,o.target.value),"aria-invalid":!!s})},r.uid)};return P("div",{className:"pdp-gift-card-options__grid",children:[P("div",{className:"pdp-gift-card-options__row",children:[n("giftcard/giftcard_amount")&&m(n("giftcard/giftcard_amount")),n("giftcard/custom_giftcard_amount")&&_&&m(n("giftcard/custom_giftcard_amount"))]}),P("div",{className:"pdp-gift-card-options__row",children:[n("giftcard/giftcard_sender_name")&&m(n("giftcard/giftcard_sender_name")),n("giftcard/giftcard_sender_email")&&m(n("giftcard/giftcard_sender_email"))]}),P("div",{className:"pdp-gift-card-options__row",children:[n("giftcard/giftcard_recipient_name")&&m(n("giftcard/giftcard_recipient_name")),n("giftcard/giftcard_recipient_email")&&m(n("giftcard/giftcard_recipient_email"))]}),h("div",{className:"pdp-gift-card-options__row",children:n("giftcard/giftcard_message")&&m(n("giftcard/giftcard_message"))})]})};export{rr as G};
//# sourceMappingURL=GiftCardOptions2.js.map
