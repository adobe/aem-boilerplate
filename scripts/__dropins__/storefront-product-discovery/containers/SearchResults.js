/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as Z,jsx as n}from"@dropins/tools/preact-jsx-runtime.js";import*as d from"@dropins/tools/preact-compat.js";import{useState as v,useEffect as q}from"@dropins/tools/preact-compat.js";import{VComponent as G,classes as J,Slot as h}from"@dropins/tools/lib.js";import{events as y}from"@dropins/tools/event-bus.js";import{InLineAlert as K,Icon as Q,ProductItemCard as k,PriceRange as R,Image as W}from"@dropins/tools/components.js";/* empty css                 */import{s as X,c as Y,a as $,S as ee,P as re}from"../chunks/acdlEvents.js";import{useText as ne}from"@dropins/tools/i18n.js";const S=a=>new DOMParser().parseFromString(a,"text/html").documentElement.textContent,C=({productList:a,header:s,footer:r,imageWidth:g,imageHeight:f})=>Z("div",{className:"product-discovery-product-list",style:{"--imageWidth":g,"--imageHeight":f},children:[s&&n("div",{className:"product-discovery-product-list__header",children:s}),n("div",{className:"product-discovery-product-list__grid",children:a&&n(G,{node:a})}),r&&n("div",{className:"product-discovery-product-list__footer",children:r})]}),te=a=>d.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},d.createElement("g",{clipPath:"url(#clip0_841_1324)"},d.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),d.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),d.createElement("defs",null,d.createElement("clipPath",{id:"clip0_841_1324"},d.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),ae=({alertMessage:a=""})=>n("div",{className:J(["product-discovery-search-alert-message__wrapper"]),children:n("div",{className:"product-discovery-search-alert-message__content",children:n(K,{heading:a,type:"warning",icon:n(Q,{source:te,size:"24"}),onDismiss:void 0})})}),ge=({routeProduct:a,scope:s,slots:r,imageWidth:g=400,imageHeight:f=450,skeletonCount:E=8,onSearchResult:_})=>{const w=s==="popover"?ee:re,L=ne({noResults:"Search.PLP.noResults",searchError:"Search.PLP.searchError"}),[u,A]=v(null),[x,V]=v([]),[H,U]=v(!1),[P,I]=v(null);q(()=>{const e=y.on("search/loading",U,{eager:!0,scope:s}),t=y.on("search/error",()=>{I(L.searchError)},{eager:!0,scope:s}),c=y.on("search/result",i=>{var o,m,l;I(((o=i.result)==null?void 0:o.items.length)<1?L.noResults:null),A(i.request),V((m=i.result)==null?void 0:m.items),_==null||_((l=i.result)==null?void 0:l.items),i.request.phrase?X(w):Y(w)},{eager:!0,scope:s});return()=>{e==null||e.off(),t==null||t.off(),c==null||c.off()}},[]);const D=(e,t)=>{var m;const c=(m=e.target)==null?void 0:m.closest("a");if(!c||!a)return;const i=new URL(c.href),o=new URL(a(t),window.location.origin);i.pathname===o.pathname&&i.hostname===o.hostname&&$(t.sku,w)},M=(e,t)=>{var m,l,p,N;const c={loading:t<8?"eager":"lazy",src:((l=(m=e.images)==null?void 0:m[0])==null?void 0:l.url)||"",alt:((N=(p=e.images)==null?void 0:p[0])==null?void 0:N.label)||"",width:g,height:f,params:{width:g}},i=e.name!==null?S(e.name):e.sku,o=n(W,{class:"product-discovery-product-item__image",...c,"aria-label":i||""});return n(h,{name:"ProductImage",slot:r==null?void 0:r.ProductImage,context:{product:e,defaultImageProps:c,variables:u},children:a?n("a",{href:a(e),children:o}):o})},b=e=>{const t=e.name!==null?S(e.name):"";return n(h,{name:"ProductName",slot:r==null?void 0:r.ProductName,context:{product:e,variables:u},children:a?n("a",{href:a(e),children:t}):t})},j=e=>{var i,o,m,l,p;let t=e.typename==="ComplexProductView"?(i=e.priceRange)==null?void 0:i.minimum.regular.amount.currency:(o=e.price)==null?void 0:o.regular.amount.currency;Intl.supportedValuesOf("currency").indexOf(t||"")===-1&&(t="USD");const c=e.typename==="ComplexProductView"?n(R,{display:"from to",minimumAmount:(m=e.priceRange)==null?void 0:m.minimum.regular.amount.value,maximumAmount:(l=e.priceRange)==null?void 0:l.maximum.regular.amount.value,currency:t}):n(R,{amount:(p=e.price)==null?void 0:p.regular.amount.value,currency:t});return n(h,{name:"ProductPrice",slot:r==null?void 0:r.ProductPrice,context:{product:e,variables:u},children:a?n("a",{href:a(e),children:c}):c})},z=e=>n(h,{name:"ProductActions",slot:r==null?void 0:r.ProductActions,context:{product:e,variables:u}}),F=()=>n(h,{name:"NoResults",slot:r==null?void 0:r.NoResults,context:{error:P,variables:u},children:P&&n(ae,{alertMessage:P})}),B=()=>n(C,{imageWidth:g,imageHeight:f,productList:Array.from({length:E}).map((e,t)=>n(k,{initialized:!1},t))}),O=()=>n(h,{name:"Header",slot:r==null?void 0:r.Header,context:{products:x,variables:u}}),T=()=>n(h,{name:"Footer",slot:r==null?void 0:r.Footer,context:{products:x,variables:u}});return n("div",{children:H?B():P?F():n(C,{header:O(),footer:T(),imageWidth:g,imageHeight:f,productList:x.map((e,t)=>n(k,{image:M(e,t),titleNode:b(e),price:j(e),actionButton:r!=null&&r.ProductActions?z(e):void 0,onClick:c=>D(c,e),initialized:!0},e.id||e.sku||t))})})};export{ge as SearchResults,ge as default};
//# sourceMappingURL=SearchResults.js.map
