/*! Copyright 2026 Adobe
All Rights Reserved. */
import"@dropins/tools/lib.js";import{signal as m,computed as I}from"@dropins/tools/signals.js";import{events as D}from"@dropins/tools/event-bus.js";import{FetchGraphQL as U}from"@dropins/tools/fetch-graphql.js";const A={authenticated:!1,cartId:null,config:null,initialized:!1,quoteId:null},E=new Proxy(A,{set(e,t,s){return e[t]=s,!0},get(e,t){return e[t]}});function V(){return E.quoteId!==null}var u=(e=>(e.EXCLUDING_TAX="EXCLUDING_TAX",e.INCLUDING_EXCLUDING_TAX="INCLUDING_AND_EXCLUDING_TAX",e.INCLUDING_TAX="INCLUDING_TAX",e))(u||{});const B=m(!1);var G=(e=>(e.Updates="updates",e.Default="default",e.ShippingEstimate="shippingEstimate",e))(G||{});const d=new Map,g=new Map,c=m(new Set),N=new Map;N.set("updates",e=>{D.emit("checkout/updated",e)});async function q(e){g.set(e,!0);const t=d.get(e);let s;for(;t.length>0;){const i=t.shift();try{const r=await i.requestFn();i.resolve(r),s=r}catch(r){i.reject(r)}}g.set(e,!1);const n=new Set(c.value);n.delete(e),c.value=n;const o=N.get(e);o&&s&&o(s)}function w(e,t="default"){d.has(t)||d.set(t,[]);const s=d.get(t),n=new Promise((i,r)=>{s.push({requestFn:e,resolve:i,reject:r})}),o=new Set(c.value);return o.add(t),c.value=o,g.get(t)||q(t),n}const $=I(()=>c.value.has("updates")),z=I(()=>c.value.has("shippingEstimate")),v=["sender_email","recipient_email"];function X(e){return e.filter(t=>!t.path||!v.some(s=>{var n;return((n=t.path)==null?void 0:n.at(-1))===s}))}class T extends Error{constructor(t){super(t.map(s=>s.message).join(" ")),this.name="FetchError"}}class S extends Error{constructor(t){super(t),this.name="InvalidInput"}}class a extends S{constructor(t){super(`${t} is required.`)}}class Y extends a{constructor(){super("Cart ID")}}class J extends S{constructor(){super("Either Cart ID or Quote ID is required.")}}class K extends Error{constructor(){super("User is not authenticated")}}class W extends a{constructor(){super("Negotiable Quote ID")}}class Z extends a{constructor(){super("Email")}}class ee extends a{constructor(){super("Payment method code")}}class te extends a{constructor(){super("Shipping address")}}class se extends a{constructor(){super("Shipping method")}}class ne extends a{constructor(){super("Billing address")}}class re extends a{constructor(){super("Country Code")}}function L(e,t){return t.split(".").reduce((s,n)=>s&&s[n]!==void 0?s[n]:void 0,e)}async function M(e){const{defaultValueOnFail:t,options:s,path:n,query:o,queueName:i,transformer:r,type:p}=e;try{const l=async()=>{const{data:y,errors:C}=await b(o,{method:p==="query"?"GET":"POST",cache:p==="query"?"no-cache":void 0,...s});if(C){const _=X(C);if(_.length>0)throw new T(_)}let h=L(y,n);if(h===void 0)throw new Error(`No data found at path: ${n}`);return r?r(h):h};return p==="mutation"?await w(l,i):await l()}catch(l){if(t!==void 0)return t;throw l}}const x=`
  query getStoreConfig {
    storeConfig {
      default_country
      is_checkout_agreements_enabled
      is_guest_checkout_enabled
      is_one_page_checkout_enabled
      shopping_cart_display_shipping
    }
  }
`,F="US",f={defaultCountry:F,agreementsEnabled:!0,shoppingCartDisplaySetting:{shipping:u.EXCLUDING_TAX}},ae=async()=>await M({defaultValueOnFail:f,options:{method:"GET",cache:"no-cache"},path:"storeConfig",query:x,transformer:P,type:"query"}),oe=()=>E.config;function Q(e){switch(e){case 1:return u.EXCLUDING_TAX;case 2:return u.INCLUDING_TAX;case 3:return u.INCLUDING_EXCLUDING_TAX;default:return u.EXCLUDING_TAX}}function P(e){if(!e)return f;const{default_country:t,is_checkout_agreements_enabled:s,shopping_cart_display_shipping:n}=e;return{defaultCountry:t||f.defaultCountry,agreementsEnabled:s,shoppingCartDisplaySetting:{shipping:Q(n)}}}const{setEndpoint:ie,setFetchGraphQlHeader:ue,removeFetchGraphQlHeader:ce,setFetchGraphQlHeaders:le,fetchGraphQl:b,getConfig:de}=new U().getMethods();export{F as D,S as I,J as M,G as Q,f as S,u as T,K as U,ie as a,ue as b,le as c,M as d,ae as e,b as f,de as g,$ as h,B as i,oe as j,se as k,ee as l,ne as m,z as n,V as o,Y as p,re as q,ce as r,E as s,te as t,Z as u,W as v};
//# sourceMappingURL=fetch-graphql.js.map
