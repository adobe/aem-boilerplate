/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as v,jsx as a}from"@dropins/tools/preact-jsx-runtime.js";import{useState as Q,useEffect as A}from"@dropins/tools/preact-compat.js";import{classes as F,Slot as c}from"@dropins/tools/lib.js";import{Table as j,IllustratedMessage as D,Picker as G,Pagination as V,Price as $}from"@dropins/tools/components.js";import{events as B}from"@dropins/tools/event-bus.js";/* empty css                        *//* empty css                         */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{useText as C}from"@dropins/tools/i18n.js";import{f as L}from"../chunks/dateUtils.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{g as _}from"../chunks/fetch-graphql.js";import"../chunks/state.js";import{g as H}from"../chunks/getQuoteTemplates.js";import"@dropins/tools/fetch-graphql.js";const J=({rowData:g=[],loading:h=!1,className:y,emptyStateMessage:T,showItemRange:m=!0,itemRangeMessage:d,showPageSizePicker:i=!0,pageSizePickerMessage:S,showPagination:l=!0,paginationMessage:u,...x})=>{const o=C({name:"QuoteManagement.QuoteTemplatesListTable.name",state:"QuoteManagement.QuoteTemplatesListTable.state",status:"QuoteManagement.QuoteTemplatesListTable.status",validUntil:"QuoteManagement.QuoteTemplatesListTable.validUntil",minQuoteTotal:"QuoteManagement.QuoteTemplatesListTable.minQuoteTotal",ordersPlaced:"QuoteManagement.QuoteTemplatesListTable.ordersPlaced",lastOrdered:"QuoteManagement.QuoteTemplatesListTable.lastOrdered",actions:"QuoteManagement.QuoteTemplatesListTable.actions"}),z=[{key:"name",label:o.name},{key:"state",label:o.state},{key:"status",label:o.status},{key:"validUntil",label:o.validUntil},{key:"minQuoteTotal",label:o.minQuoteTotal},{key:"ordersPlaced",label:o.ordersPlaced},{key:"lastOrdered",label:o.lastOrdered},{key:"actions",label:o.actions}],f=!h&&g.length===0&&T,P=m&&d,s=i&&S,p=l&&u,b=P||s||p;return v("div",{...x,className:F(["quote-management-quote-templates-list-table",y]),children:[a(j,{columns:z,rowData:g,loading:h,mobileLayout:"none",className:"quote-management-quote-templates-list-table__table"}),f&&a("div",{className:"quote-templates-list-table__empty-state",children:T}),b&&v("div",{className:"quote-templates-list-table__footer",children:[a("div",{className:"quote-templates-list-table__item-range",children:P&&d}),a("div",{className:"quote-templates-list-table__pagination",children:p&&u}),a("div",{className:"quote-templates-list-table__page-size-picker",children:s&&S})]})]})},pe=({pageSize:g,showItemRange:h=!0,showPageSizePicker:y=!0,showPagination:T=!0,onPageSizeChange:m,onPageChange:d,slots:i,...S})=>{const[l,u]=Q(null),[x,o]=Q(!0),z=_()[0],[f,P]=Q(g||z),[s,p]=Q(1);A(()=>{const r=async()=>{try{o(!0);const t=await H({pageSize:f,currentPage:s});u(t)}catch(t){console.error("Failed to fetch quote templates:",t)}finally{o(!1)}},e=B.on("authenticated",t=>{t?r():(u(null),o(!1))},{eager:!0});return()=>{e==null||e.off()}},[f,s]);const b=r=>{P(r),p(1),m==null||m(r)},N=r=>{p(r),d==null||d(r)},I=r=>{const e=r.target,t=e==null?void 0:e.value;t&&b(Number(t))},M=(r,e)=>r.filter(t=>t==null?void 0:t.uid).map(t=>{var k;return{id:t.id,name:a(c,{name:"Name",slot:e==null?void 0:e.Name,context:{template:t},children:a("span",{children:t.name})}),state:a(c,{name:"State",slot:e==null?void 0:e.State,context:{template:t},children:a("span",{style:{textTransform:"capitalize"},children:((k=t.state)==null?void 0:k.replace(/_/g," "))||"-"})}),status:a(c,{name:"Status",slot:e==null?void 0:e.Status,context:{template:t},children:a("span",{children:t.status})}),validUntil:a(c,{name:"ValidUntil",slot:e==null?void 0:e.ValidUntil,context:{template:t},children:a("span",{children:L(t.expirationDate)})}),minQuoteTotal:a(c,{name:"MinQuoteTotal",slot:e==null?void 0:e.MinQuoteTotal,context:{template:t},children:a($,{amount:t.prices.minNegotiatedGrandTotal.value,currency:t.prices.minNegotiatedGrandTotal.currency})}),ordersPlaced:a(c,{name:"OrdersPlaced",slot:e==null?void 0:e.OrdersPlaced,context:{template:t},children:a("span",{children:t.ordersPlaced})}),lastOrdered:a(c,{name:"LastOrdered",slot:e==null?void 0:e.LastOrdered,context:{template:t},children:a("span",{children:L(t.lastOrderedAt)})}),actions:a(c,{name:"Actions",slot:e==null?void 0:e.Actions,context:{template:t},children:a("span",{})})}}),q=l!=null&&l.items?M(l.items,i):[],n=l!=null&&l.paginationInfo?{...l.paginationInfo,pageSizeOptions:_()}:void 0,O=!!n,w=a(c,{name:"EmptyTemplates",slot:i==null?void 0:i.EmptyTemplates,context:{templatesData:l},children:a(D,{heading:"No Quote Templates Found"})}),U=n?a(c,{name:"ItemRange",slot:i==null?void 0:i.ItemRange,context:n,children:v("span",{children:["Items ",n.startItem," to ",n.endItem," of"," ",n.totalCount," total"]})}):void 0,R=n&&n.pageSizeOptions?v(c,{name:"PageSizePicker",slot:i==null?void 0:i.PageSizePicker,context:{pageSize:n.pageSize,pageSizeOptions:n.pageSizeOptions,onPageSizeChange:b},children:[a("span",{children:"Show "}),a(G,{variant:"primary",size:"medium",value:String(n.pageSize),options:n.pageSizeOptions.map(r=>({value:String(r),text:String(r)})),handleSelect:I}),a("span",{children:" per page"})]}):void 0,E=n?a(c,{name:"Pagination",slot:i==null?void 0:i.Pagination,context:{currentPage:n.currentPage,totalPages:n.totalPages,onChange:N},children:a(V,{currentPage:n.currentPage,totalPages:n.totalPages,onChange:N})}):void 0;return a(J,{rowData:q,loading:x,className:S.className,emptyStateMessage:w,showItemRange:h&&O,itemRangeMessage:U,showPageSizePicker:y&&O,pageSizePickerMessage:R,showPagination:T&&O,paginationMessage:E})};export{pe as QuoteTemplatesListTable,pe as default};
//# sourceMappingURL=QuoteTemplatesListTable.js.map
