/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsxs as j,jsx as t}from"@dropins/tools/preact-jsx-runtime.js";import{useState as T,useEffect as C}from"@dropins/tools/preact-compat.js";import{classes as g,VComponent as x,toLanguageTag as v}from"@dropins/tools/lib.js";import{Price as A}from"@dropins/tools/components.js";/* empty css                  */import{P as q}from"../chunks/PriceRange.js";import"@dropins/tools/preact.js";import{useText as b}from"@dropins/tools/i18n.js";import"@dropins/tools/preact-hooks.js";/* empty css                       */import{events as R}from"@dropins/tools/event-bus.js";import{g as B}from"../chunks/getFetchedProductData.js";import{c as F}from"../chunks/fetchProductData.js";import"../fragments.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/isProductConfigurationValid.js";const I=({className:s,price:i,specialPrice:c,tiers:a,children:p,...e})=>{const n=b("PDP.Product.RegularPrice.label").label,r=b("PDP.Product.SpecialPrice.label").label,o=b("PDP.Product.TierPrice.label").label;return j("div",{...e,className:g(["pdp-price",s]),children:[c&&t(x,{node:c,className:g(["pdp-price__amount-special","pdp-price__amount"]),"aria-label":r,role:"text"}),i&&t(x,{node:i,className:g(["pdp-price__amount-regular","pdp-price__amount--grey"]),"aria-label":n,role:"text"}),a&&t(x,{node:a,className:g(["pdp-price__tiers"]),"aria-label":o,role:"text"})]})},M=({locale:s,tiers:i,regularPrice:c,...a})=>{const p=b("PDP.Product.TierPricing.label").label;return!i||i.length===0?null:t("div",{className:"pdp-price-tiers",...a,children:i.map((e,n)=>{var m,u;const r=((m=e==null?void 0:e.tier)==null?void 0:m.amount)??0,o=(e==null?void 0:e.quantity)??0,d=((u=e==null?void 0:e.tier)==null?void 0:u.currency)??"";let l=0;c&&r&&r<c&&(l=Math.round((c-r)/c*100));const P=p.replace("{quantity}",o.toString()).split("{price}")[0],f=p.replace("{quantity}",o.toString()).split("{price}")[1].replace("{percent}",l>0?l.toString():"0");return t("div",{className:"pdp-price-tiers__tier",children:j("span",{className:"pdp-price-tiers__text",children:[P,t(A,{amount:r,currency:d,locale:s,className:"pdp-price-tiers__price"}),f]})},n)})})},U=({initialData:s=null,scope:i,children:c,...a})=>{var d,l,P,f,m,u,N,y,D,L,S;const{globalLocale:p="en-US"}=F.getConfig(),[e,n]=T(s),[r,o]=T(p);return C(()=>{const _=R.on("pdp/data",n,{scope:i}),h=R.on("locale",o);return()=>{_==null||_.off(),h==null||h.off()}},[i]),!e||!e.prices?null:t(I,{...a,specialPrice:(d=e.prices)!=null&&d.visible?t(q,{...(l=e.prices)==null?void 0:l.final,locale:v(r)}):void 0,price:(P=e.prices)!=null&&P.visible&&((f=e.prices)!=null&&f.regular)&&((m=e.prices)==null?void 0:m.final.amount)!==((u=e.prices)==null?void 0:u.regular.amount)?t(q,{...(N=e.prices)==null?void 0:N.regular,locale:v(r)}):void 0,tiers:(y=e.prices)!=null&&y.visible&&((L=(D=e.prices)==null?void 0:D.tiers)==null?void 0:L.length)>0?t(M,{tiers:e.prices.tiers,locale:v(r),regularPrice:(S=e.prices.regular)==null?void 0:S.amount}):void 0})};U.getInitialData=B;export{U as ProductPrice,U as default};
//# sourceMappingURL=ProductPrice.js.map
