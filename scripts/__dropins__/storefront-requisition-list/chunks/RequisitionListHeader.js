/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as m,jsx as t,Fragment as C}from"@dropins/tools/preact-jsx-runtime.js";import{useState as R,useCallback as h}from"@dropins/tools/preact-hooks.js";import{R as q}from"./RequisitionListModal.js";import{R as b}from"./RequisitionListForm.js";import{u as N}from"./updateRequisitionList.js";import{d as k}from"./deleteRequisitionList.js";import{useText as M}from"@dropins/tools/i18n.js";const x=({name:i,description:n,backLink:s,actions:e,className:f,...r})=>m("div",{...r,className:`requisition-list-header ${f||""}`,children:[s&&t("div",{className:"requisition-list-header__back",children:m("a",{href:s.url,className:"requisition-list-header__back-link",onClick:s.onClick,children:[t("span",{className:"requisition-list-header__back-arrow",children:"<"}),s.label]})}),m("div",{className:"requisition-list-header__main",children:[m("div",{className:"requisition-list-header__title-section",children:[t("h1",{className:"requisition-list-header__title",children:i}),n&&t("p",{className:"requisition-list-header__description",children:n})]}),e&&(e.onRename||e.onDelete)&&m("div",{className:"requisition-list-header__actions",children:[e.onRename&&t("a",{href:"#",onClick:d=>{var a;d.preventDefault(),(a=e.onRename)==null||a.call(e)},className:"requisition-list-header__action-link","data-testid":"rename-list-btn",children:e.renameLabel}),e.onDelete&&t("a",{href:"#",onClick:d=>{var a;d.preventDefault(),(a=e.onDelete)==null||a.call(e)},className:"requisition-list-header__action-link","data-testid":"delete-list-btn",children:e.deleteLabel})]})]})]}),j=({requisitionList:i,routeRequisitionListGrid:n,onUpdate:s,onAlert:e})=>{const[f,r]=R(!1),[d,a]=R(!1),[_,L]=R(!1),l=M({actionBackToRequisitionLists:"RequisitionList.RequisitionListView.actionBackToRequisitionLists",actionRename:"RequisitionList.RequisitionListView.actionRename",actionDeleteList:"RequisitionList.RequisitionListView.actionDeleteList",deleteListTitle:"RequisitionList.RequisitionListView.deleteListTitle",deleteListMessage:"RequisitionList.RequisitionListView.deleteListMessage",confirmAction:"RequisitionList.RequisitionListWrapper.confirmAction",cancelAction:"RequisitionList.RequisitionListWrapper.cancelAction",updateTitle:"RequisitionList.RequisitionListForm.updateTitle"}),g=h(()=>{r(!0)},[]),w=h(async u=>{var o,c;try{const p=await N(i.uid,u.name,u.description,(o=i.page_info)==null?void 0:o.page_size,(c=i.page_info)==null?void 0:c.current_page);p?(s==null||s(p),r(!1),e==null||e({action:"update",type:"success",context:"requisitionList"})):e==null||e({action:"update",type:"error",context:"requisitionList"})}catch{e==null||e({action:"update",type:"error",context:"requisitionList"})}},[i.uid,i.page_info,s,e]),y=h(()=>{a(!0)},[]),D=h(async()=>{L(!0);try{if(await k(i.uid)){const o={action:"delete",type:"success",context:"requisitionList"};try{localStorage.setItem("requisitionListPendingAlert",JSON.stringify(o))}catch{}if(n){const c=n();c&&typeof c=="string"&&(window.location.href=c)}}else e==null||e({action:"delete",type:"error",context:"requisitionList"})}catch{e==null||e({action:"delete",type:"error",context:"requisitionList"})}finally{L(!1),a(!1)}},[i.uid,n,e]);return m(C,{children:[t(x,{name:i.name,description:i.description,backLink:n?{url:"#",label:l.actionBackToRequisitionLists,onClick:u=>{u.preventDefault();const o=n();o&&typeof o=="string"&&(window.location.href=o)}}:void 0,actions:{onRename:g,onDelete:y,renameLabel:l.actionRename,deleteLabel:l.actionDeleteList}}),f&&t(q,{isOpen:f,isLoading:!1,title:l.updateTitle,modalContent:t(b,{mode:"update",defaultValues:{name:i.name,description:i.description||""},onSubmit:w,onCancel:()=>r(!1)}),handleModalOnClose:()=>r(!1)}),d&&t(q,{isOpen:d,isLoading:_,title:l.deleteListTitle,modalContent:l.deleteListMessage,confirmBtnCaption:l.confirmAction,closeBtnCaption:l.cancelAction,handleModalOnClose:()=>a(!1),handleModalOnConfirm:D})]})};export{j as R};
//# sourceMappingURL=RequisitionListHeader.js.map
