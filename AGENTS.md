# AGENTS.md

This project is a website built with Edge Delivery Services in Adobe Experience Manager Sites as a Cloud Service.

## Project Overview

Based on https://github.com/adobe/aem-boilerplate/ - follow the coding style and practices established in the boilerplate, adding functionality according to the site's needs.

### Project-Specific Skills

**IMPORTANT:** This project has AEM-specific skills in `.agents/skills/`:
- **aem-development-workflow** - Required workflow gates (linting, testing, preview, PRs)
- **aem-block-reusability** - Check Block Collection and Block Party before implementing
- **aem-content-modeling** - Design author-friendly content structures

Claude Code automatically uses these skills because they are symlinked to `.claude/skills`

You should always use these skills when they are applicable. If you fail to read and apply the skillls, you are likely to fail at your tasks. 

You should read the first few lines (front-matter) or each SKILL.md file to determine if it is applicable to your current task. You can do that by running `head -n 5 .agents/skills/aem-development-workflow/SKILL.md` to decide which skills are applicable before reading the entire file.

If your human corrects you or provides key guidance, you should consider offering to update these skills or add new ones, to avoid the same problems in the future.

### Key Technologies
- Edge Delivery Services for AEM Sites (documentation at https://www.aem.live/ – search with `site:www.aem.live` to restrict web search results)
- Vanilla JavaScript (ES6+), no transpiling, no build steps
- CSS3 with modern features, no Tailwind or other CSS frameworks
- HTML5 semantic markup generated by the aem.live backend, decorated by our code
- Node.js tooling

## Setup Commands

- Install dependencies: `npm install`
- Start local development: `npx -y @adobe/aem-cli up --no-open` (run in background, if possible)
  - Install the AEM CLI globally by running `npm install -g @adobe/aem-cli` then `aem up` is equivalent to the command above
- Run linting: `npm run lint`
- Fix linting issues: `npm run lint:fix`

## Project Structure

```
├── blocks/          # Reusable content blocks
    └── {blockName}/   - Individual block directory
        ├── {blockName}.js      # Block's JavaScript
        └── {blockName}.css     # Block's styles
├── styles/          # Global styles and CSS
    ├── styles.css          # Minimal global styling and layout for your website required for LCP
    └── lazy-styles.css     # Additional global styling and layout for below the fold/post LCP content
├── scripts/         # JavaScript libraries and utilities
    ├── aem.js           # Core AEM Library for Edge Delivery page decoration logic (NEVER MODIFY THIS FILE)
    ├── scripts.js       # Global JavaScript utilities, main entry point for page decoration
    └── delayed.js       # Delayed functionality such as martech loading
├── fonts/           # Web fonts
├── icons/           # SVG icons
├── head.html        # Global HTML head content
└── 404.html         # Custom 404 page
```

## Code Style Guidelines

### JavaScript
- Use ES6+ features (arrow functions, destructuring, etc.)
- Follow Airbnb ESLint rules (already configured)
- Always include `.js` file extensions in imports
- Use Unix line endings (LF)

### CSS
- Follow Stylelint standard configuration
- Use modern CSS features (CSS Grid, Flexbox, CSS Custom Properties)
- Maintain responsive design principles
- Declare styles mobile first, use media queries for tablet and desktop specific styles
- Use 600px/900px/1200px as breakpoints

### HTML
- Use semantic HTML5 elements
- Ensure accessibility standards (ARIA labels, proper heading hierarchy)
- Follow AEM markup conventions for blocks and sections

Use `curl` and `console.log` to inspect HTML before making assumptions. Authors may omit/add fields - handle gracefully.

### Three-Phase Page Loading

Pages are progressively loaded in three phases to maximize performance. This process begins when `loadPage` from scripts.js is called.

* Eager - load only what is required to get to LCP. This generally includes decorating the overall page content to create sections, blocks, buttons, etc. and loading the first section of the page.
* Lazy - load all other page content, including the header and footer.
* Delayed - load things that can be safely loaded later here and incur a performance penalty when loaded earlier

## Development Workflow

**See aem-development-workflow skill for complete required workflow.**

## Deployment

**See aem-development-workflow skill for complete PR requirements.**

### Environment URLs

Get repo info: `gh repo view --json nameWithOwner` or `git remote -v`

- **Local**: `http://localhost:3000` (uncommitted code + preview content)
- **Production Preview**: `https://main--{repo}--{owner}.aem.page/`
- **Production Live**: `https://main--{repo}--{owner}.aem.live/`
- **Feature Preview**: `https://{branch}--{repo}--{owner}.aem.page/`
