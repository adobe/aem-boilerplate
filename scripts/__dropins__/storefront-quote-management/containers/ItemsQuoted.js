/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as m,Fragment as H}from"@dropins/tools/preact-jsx-runtime.js";import{useState as M,useEffect as $}from"@dropins/tools/preact-compat.js";import{VComponent as _,classes as p,Slot as h}from"@dropins/tools/lib.js";import{h as T}from"@dropins/tools/preact.js";import{Picker as w,Price as g,Checkbox as B,Button as E,Table as j,Accordion as A,AccordionSection as D,Skeleton as z,SkeletonRow as F}from"@dropins/tools/components.js";/* empty css                   */import{useText as k}from"@dropins/tools/i18n.js";import{events as G}from"@dropins/tools/event-bus.js";const O=({className:l,items:c,canEdit:r,onItemCheckboxChange:u,onItemDropdownChange:t,onUpdate:n,...o})=>{const s=k({updateButton:"NegotiableQuote.Manage.productListTable.submitButton",productNameHeader:"NegotiableQuote.Manage.productListTable.headers.productName",skuHeader:"NegotiableQuote.Manage.productListTable.headers.sku",priceHeader:"NegotiableQuote.Manage.productListTable.headers.price",quantityHeader:"NegotiableQuote.Manage.productListTable.headers.quantity",discountHeader:"NegotiableQuote.Manage.productListTable.headers.discount",subtotalHeader:"NegotiableQuote.Manage.productListTable.headers.subtotal",actionsHeader:"NegotiableQuote.Manage.productListTable.headers.actions",editNoteToSeller:"NegotiableQuote.Manage.productListTable.actions.editNoteToSeller",remove:"NegotiableQuote.Manage.productListTable.actions.remove"}),d=[{label:s.productNameHeader,key:"productName"},{label:s.skuHeader,key:"sku"},{label:s.priceHeader,key:"price"},{label:s.quantityHeader,key:"quantity"},{label:s.discountHeader,key:"discount"},{label:s.subtotalHeader,key:"subtotal"}];r&&(d.unshift({label:"",key:"checkbox"}),d.push({label:s.actionsHeader,key:"actions"}));const q=(a,i)=>{const N=a.target.checked;u==null||u(i,N)},b=(a,i)=>{const N=a.target.value;t==null||t(i,N)},y=a=>{a.preventDefault(),n==null||n(a)},f=(a,i)=>a>0?m("div",{className:"quote-management-product-list-table__discount-container",children:[m("span",{className:"quote-management-product-list-table__discount-percent",children:[i,"%"]}),m("span",{className:"quote-management-product-list-table__discount-price",children:["(",e(g,{amount:a}),")"]})]}):void 0,x=c.map(a=>({checkbox:e(B,{className:"quote-management-product-list-table__checkbox",name:"itemSelected","data-testid":`item-checkbox-${a.product.sku}`,onChange:i=>q(i,a),value:a.product.sku}),productName:e("span",{className:"quote-management-product-list-table__product-name",children:a.product.name}),sku:e("span",{className:"quote-management-product-list-table__sku",children:a.product.sku}),price:e(g,{className:"quote-management-product-list-table__price",amount:a.prices.originalItemPrice.value,currency:a.prices.originalItemPrice.currency}),quantity:e("span",{className:"quote-management-product-list-table__quantity",children:a.quantity}),discount:f(a.catalogDiscount.amountOff,a.catalogDiscount.percentOff),subtotal:e(g,{className:"quote-management-product-list-table__subtotal",amount:a.prices.rowTotal.value,currency:a.prices.rowTotal.currency}),actions:e(w,{className:"quote-management-product-list-table__actions","data-testid":`item-dropdown-${a.product.sku}`,name:"item-dropdown",onChange:i=>b(i,a),placeholder:"Select",options:[{text:s.editNoteToSeller,value:"edit"},{text:s.remove,value:"remove"}],value:a.product.sku})})),Q=e(j,{columns:d,rowData:x,"data-testid":"product-list-table",mobileLayout:"stacked"}),S=r?T("form",{}):T("div",{}),L=r?{onSubmit:y,...o}:o,P=r?e(E,{type:"submit","data-testid":"product-list-table-submit-button",children:s.updateButton}):void 0;return m(_,{node:S,className:p(["quote-management-product-list-table-container",l]),"data-testid":"product-list-table-container",...L,children:[Q,e("div",{className:"quote-management-product-list-table-container__submit-container",children:P})]})},R=({className:l,entries:c,...r})=>{const u=t=>{var o;const n=(o=t.children)==null?void 0:o.map(u);return e("div",{className:"quote-management-quote-prices-summary__entry","data-testid":`quote-prices-summary-entry-${t.id}`,children:n?e(A,{className:"quote-management-quote-prices-summary__accordion","data-testid":`quote-prices-summary-entry-accordion-${t.id}`,children:e(D,{className:"quote-management-quote-prices-summary__accordion-section",title:t.label,ariaLabelTitle:t.label,secondaryText:t.value,children:n})}):m(H,{children:[e("span",{className:p(["quote-management-quote-prices-summary__label",["quote-management-quote-prices-summary__label--strong",t.strong]]),"data-testid":`quote-prices-summary-entry-label-${t.id}`,children:t.label}),e("span",{className:"quote-management-quote-prices-summary__value","data-testid":`quote-prices-summary-entry-value-${t.id}`,children:t.value})]})},t.id)};return e("div",{className:p(["quote-management-quote-prices-summary",l]),"data-testid":"quote-prices-summary",...r,children:c==null?void 0:c.map(u)})},v=({className:l,loading:c,table:r,pricesSummary:u,...t})=>c?e(V,{}):m("div",{className:p(["quote-management-items-quoted",l]),...t,children:[r&&e(_,{node:r,className:p(["quote-management-items-quoted__table"]),"data-testid":"quote-management-items-quoted__table"}),u&&e(_,{node:u,className:p(["quote-management-items-quoted__prices-summary"]),"data-testid":"quote-management-items-quoted__prices-summary"})]}),V=()=>e(z,{"data-testid":"items-quoted-skeleton",children:e(F,{variant:"row",fullWidth:!0,size:"medium",lines:4,multilineGap:"xsmall"})}),C=({quoteData:l,onItemCheckboxChange:c,onItemDropdownChange:r,onUpdate:u,slots:t,...n})=>{const[o,s]=M(l),d=k({subtotal:"NegotiableQuote.Manage.quotePricesSummary.subtotal.excludingTax",grandTotal:"NegotiableQuote.Manage.quotePricesSummary.grandTotal.includingTax",appliedTaxes:"NegotiableQuote.Manage.quotePricesSummary.appliedTaxes"});if($(()=>{const b=G.on("quote-management/quote-data",y=>{s(y.quote)},{eager:!0});return()=>b==null?void 0:b.off()},[o]),!o)return e(v,{loading:!0});const q=[{label:d.subtotal,id:"subtotal",value:e(g,{amount:o.prices.subtotalExcludingTax.value,currency:o.prices.subtotalExcludingTax.currency,weight:"normal"})},{label:d.grandTotal,id:"total",value:e(g,{amount:o.prices.grandTotal.value,currency:o.prices.grandTotal.currency}),strong:!0}];return e(v,{"data-testid":"items-quoted-container",...n,loading:!1,table:e(h,{name:"ProductListTable",slot:t==null?void 0:t.ProductListTable,context:{items:o.items,canEdit:!0,onItemCheckboxChange:c,onItemDropdownChange:r,onUpdate:u},children:e(O,{items:o.items,canEdit:!0,onItemCheckboxChange:c,onItemDropdownChange:r,onUpdate:u})}),pricesSummary:e(h,{name:"QuotePricesSummary",slot:t==null?void 0:t.QuotePricesSummary,context:{items:o.items,prices:o.prices},children:e(R,{entries:q})})})};export{C as ItemsQuoted,C as default};
//# sourceMappingURL=ItemsQuoted.js.map
