/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as m,jsx as n}from"@dropins/tools/preact-jsx-runtime.js";import{useState as f,useMemo as _,useCallback as h,useEffect as y}from"@dropins/tools/preact-hooks.js";import{classes as v}from"@dropins/tools/lib.js";import"../chunks/AddressValidation.js";import"@dropins/tools/preact-compat.js";import{Header as N,ToggleButton as $}from"@dropins/tools/components.js";import"@dropins/tools/event-bus.js";import{useText as b}from"@dropins/tools/i18n.js";import"../chunks/removeCustomerAddress.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/preact.js";function A(i){if(!i)return[];const l=`${i.firstName} ${i.lastName}`.trim(),o=i.street??"",s=i.city??"",t=i.region||void 0,a=i.postcode??"",c=i.countryCode??"";let e="";s&&t?e=`${s}, ${(t==null?void 0:t.regionCode)??""}`.trim():s?e=s:t&&(e=(t==null?void 0:t.regionCode)??"");let r=e;a&&(r=e?`${e} ${a}`:a);let d=r;return c&&(d=r?`${r}, ${c}`:c),[l,o,d]}const g=({title:i,address:l,selected:o,busy:s,onChange:t})=>{const[a,c,e]=A(l);return n("div",{className:"account-address-validation__option",children:n($,{busy:s,className:"account-address-validation__radio",label:m("div",{children:[n("div",{className:"account-address-validation__option-title",children:n("strong",{children:i})}),a&&n("div",{children:a}),c&&n("div",{children:c}),e&&n("div",{children:e})]}),name:"address-validation-choice",selected:o,value:i,onChange:t})})},C=({busy:i=!1,className:l,originalAddress:o,onSelectionChange:s,selection:t,suggestedAddress:a})=>{const c=!!a,e=b({title:"Account.AddressValidation.title",subtitle:"Account.AddressValidation.subtitle",suggestedAddress:"Account.AddressValidation.suggestedAddress",originalAddress:"Account.AddressValidation.originalAddress"});return m("div",{className:v(["account-address-validation",l]),children:[n(N,{className:"account-address-validation__title",divider:!1,title:e.title}),n("div",{className:"account-address-validation__subtitle",children:e.subtitle}),m("div",{className:v(["account-address-validation__options",i&&"account-address-validation__options--busy"]),children:[c&&n(g,{address:a,busy:i,selected:t==="suggested",title:e.suggestedAddress,onChange:()=>s("suggested")}),n(g,{address:o,busy:i,selected:t==="original",title:e.originalAddress,onChange:()=>s("original")})]})]})},M=({selectedAddress:i=null,suggestedAddress:l,originalAddress:o,handleSelectedAddress:s})=>{const[t,a]=f(i),[c,e]=f(!1),r=_(()=>!l||!o?null:{...o,...l},[o,l]),d=h(async u=>{a(u);const p=u==="suggested"?r:o;e(!0);try{await(s==null?void 0:s({selection:u,address:p}))}finally{e(!1)}},[r,o,s]);return y(()=>{t&&d(t)},[t,d]),n(C,{busy:c,originalAddress:o,selection:t,suggestedAddress:r,onSelectionChange:d})};export{M as AddressValidation,M as default};
//# sourceMappingURL=AddressValidation.js.map
