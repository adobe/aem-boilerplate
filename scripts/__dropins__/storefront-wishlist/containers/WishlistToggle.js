/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as s}from"@dropins/tools/preact-jsx-runtime.js";import{useState as a,useEffect as w}from"@dropins/tools/preact-compat.js";import{Button as v,Icon as d}from"@dropins/tools/components.js";import{events as o}from"@dropins/tools/event-bus.js";import{s as y,g as S,r as P}from"../chunks/removeProductsFromWishlist.js";import{a as x}from"../chunks/getProductBySku.js";import{S as A,a as C}from"../chunks/HeartFilled.js";import"@dropins/tools/fetch-graphql.js";const E=({isGuestWishlistEnabled:m=!1,product:i})=>{const[u,h]=a(y.authenticated),[n,e]=a(!1),[f,l]=a(null);w(()=>{const k=t=>h(t),p=t=>{t.action==="add"&&t.item.product.sku===i.sku&&(l(t.item),e(!0))},W=()=>{var c;const t=S(),r=(c=t==null?void 0:t.items)==null?void 0:c.find(I=>I.product.sku===i.sku);l(r||null),e(!!r)};o.on("authenticated",k),o.on("wishlist/update",p),o.on("wishlist/data",W)},[i.sku]);const g=async()=>{n?(await P([f]),e(!1)):await x([{sku:i.sku,quantity:1}])};return!u&&!m?null:s(v,{"data-testid":"wishlist-toggle",size:"medium",variant:"tertiary",icon:n?s("span",{"data-testid":"icon-filled",children:s(d,{source:A})}):s("span",{"data-testid":"icon-empty",children:s(d,{source:C})}),onClick:g})};export{E as WishlistToggle,E as default};
