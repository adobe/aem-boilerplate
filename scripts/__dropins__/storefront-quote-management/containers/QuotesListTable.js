/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as P,jsx as t}from"@dropins/tools/preact-jsx-runtime.js";import{useState as Q,useEffect as A}from"@dropins/tools/preact-compat.js";import{classes as H,Slot as o}from"@dropins/tools/lib.js";import{Table as J,IllustratedMessage as K,Picker as W,Pagination as X,Button as Y,Price as Z}from"@dropins/tools/components.js";import{events as U}from"@dropins/tools/event-bus.js";/* empty css                        *//* empty css                         */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{useText as q}from"@dropins/tools/i18n.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{g as V}from"../chunks/transform-quote.js";import"../chunks/state.js";import{n as C}from"../chunks/negotiableQuotes.js";import"@dropins/tools/fetch-graphql.js";const ee=({rowData:S=[],loading:f=!1,className:N,emptyStateMessage:y,showItemRange:v=!0,itemRangeMessage:s,showPageSizePicker:p=!0,pageSizePickerMessage:i,showPagination:x=!0,paginationMessage:l,...g})=>{const m=q({quoteName:"QuoteManagement.QuotesListTable.quoteName",created:"QuoteManagement.QuotesListTable.created",createdBy:"QuoteManagement.QuotesListTable.createdBy",status:"QuoteManagement.QuotesListTable.status",lastUpdated:"QuoteManagement.QuotesListTable.lastUpdated",quoteTemplate:"QuoteManagement.QuotesListTable.quoteTemplate",quoteTotal:"QuoteManagement.QuotesListTable.quoteTotal",actions:"QuoteManagement.QuotesListTable.actions"}),h=[{key:"quoteName",label:m.quoteName},{key:"created",label:m.created},{key:"createdBy",label:m.createdBy},{key:"status",label:m.status},{key:"lastUpdated",label:m.lastUpdated},{key:"quoteTemplate",label:m.quoteTemplate},{key:"quoteTotal",label:m.quoteTotal},{key:"actions",label:m.actions}],z=!f&&S.length===0&&y,d=v&&s,b=p&&i,u=x&&l,T=d||b||u;return P("div",{...g,className:H(["quote-management-quotes-list-table",N]),children:[t(J,{columns:h,rowData:S,loading:f,mobileLayout:"none",className:"quote-management-quotes-list-table__table"}),z&&t("div",{className:"quotes-list-table__empty-state",children:y}),T&&P("div",{className:"quotes-list-table__footer",children:[t("div",{className:"quotes-list-table__item-range",children:d&&s}),t("div",{className:"quotes-list-table__pagination",children:u&&l}),t("div",{className:"quotes-list-table__page-size-picker",children:b&&i})]})]})},ye=({pageSize:S,showItemRange:f=!0,showPageSizePicker:N=!0,showPagination:y=!0,onViewQuote:v,onPageSizeChange:s,onPageChange:p,slots:i,...x})=>{const[l,g]=Q(null),[m,h]=Q(!0),z=V()[0],[d,b]=Q(S||z),[u,T]=Q(1);A(()=>{const c=async()=>{try{h(!0);const r=await C({pageSize:d,currentPage:u});g(r)}catch(r){console.error("Failed to fetch quotes:",r)}finally{h(!1)}},e=U.on("authenticated",r=>{r?c():(g(null),h(!1))},{eager:!0});return()=>{e==null||e.off()}},[d,u]),A(()=>{const c=async()=>{try{const r=await C({pageSize:d,currentPage:u});g(r)}catch(r){console.error("Failed to fetch quotes:",r)}},e=U.on("quote-management/quote-renamed",()=>{c()},{eager:!0});return()=>{e==null||e.off()}},[d,u]);const k=c=>{b(c),T(1),s==null||s(c)},_=c=>{T(c),p==null||p(c)},O=c=>{const e=c.target,r=e==null?void 0:e.value;r&&k(Number(r))},R=(c,e,r)=>c.filter(a=>a==null?void 0:a.uid).map(a=>{var w,I,B,M;const G=`${a.buyer.firstname} ${a.buyer.lastname}`;return{id:a.uid,quoteName:t(o,{name:"QuoteName",slot:e==null?void 0:e.QuoteName,context:{quote:a},children:t("span",{children:a.name})}),created:t(o,{name:"Created",slot:e==null?void 0:e.Created,context:{quote:a},children:t("span",{children:a.createdAt?new Date(a.createdAt).toLocaleDateString():"N/A"})}),createdBy:t(o,{name:"CreatedBy",slot:e==null?void 0:e.CreatedBy,context:{quote:a},children:t("span",{children:G})}),status:t(o,{name:"Status",slot:e==null?void 0:e.Status,context:{quote:a},children:t("span",{children:a.status})}),lastUpdated:t(o,{name:"LastUpdated",slot:e==null?void 0:e.LastUpdated,context:{quote:a},children:t("span",{children:a.updatedAt?new Date(a.updatedAt).toLocaleDateString():"N/A"})}),quoteTemplate:t(o,{name:"QuoteTemplate",slot:e==null?void 0:e.QuoteTemplate,context:{quote:a},children:t("span",{children:a.templateName})}),quoteTotal:t(o,{name:"QuoteTotal",slot:e==null?void 0:e.QuoteTotal,context:{quote:a},children:t(Z,{amount:(I=(w=a.prices)==null?void 0:w.grandTotal)==null?void 0:I.value,currency:(M=(B=a.prices)==null?void 0:B.grandTotal)==null?void 0:M.currency})}),actions:t(o,{name:"Actions",slot:e==null?void 0:e.Actions,context:{quote:a,onViewQuote:r},children:t(Y,{variant:"tertiary",size:"medium",onClick:()=>r==null?void 0:r(a.uid,a.name,a.status),children:"View"})})}}),D=l!=null&&l.items?R(l.items,i,v):[],n=l==null?void 0:l.paginationInfo,L=!!n,E=t(o,{name:"EmptyQuotes",slot:i==null?void 0:i.EmptyQuotes,context:{quotesData:l},children:t(K,{heading:"No Quotes Found"})}),F=n?t(o,{name:"ItemRange",slot:i==null?void 0:i.ItemRange,context:n,children:P("span",{children:["Items ",n.startItem," to ",n.endItem," of"," ",n.totalCount," total"]})}):void 0,$=n&&n.pageSizeOptions?P(o,{name:"PageSizePicker",slot:i==null?void 0:i.PageSizePicker,context:{pageSize:n.pageSize,pageSizeOptions:n.pageSizeOptions,onPageSizeChange:k},children:[t("span",{children:"Show "}),t(W,{variant:"primary",size:"medium",value:String(n.pageSize),options:n.pageSizeOptions.map(c=>({value:String(c),text:String(c)})),handleSelect:O}),t("span",{children:" per page"})]}):void 0,j=n?t(o,{name:"Pagination",slot:i==null?void 0:i.Pagination,context:{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_},children:t(X,{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_})}):void 0;return t(ee,{rowData:D,loading:m,className:x.className,emptyStateMessage:E,showItemRange:f&&L,itemRangeMessage:F,showPageSizePicker:N&&L,pageSizePickerMessage:$,showPagination:y&&L,paginationMessage:j})};export{ye as QuotesListTable,ye as default};
//# sourceMappingURL=QuotesListTable.js.map
