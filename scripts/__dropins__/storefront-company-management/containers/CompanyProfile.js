/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as f,jsx as r,Fragment as K}from"@dropins/tools/preact-jsx-runtime.js";import{classes as ee,Slot as ye}from"@dropins/tools/lib.js";import{Card as J,Skeleton as ve,SkeletonRow as Q,Button as X,Field as V,Input as R,Picker as pe,Header as ge,InLineAlert as Ce,ProgressSpinner as Ae}from"@dropins/tools/components.js";import{useState as L,useEffect as O,useMemo as U,useRef as G,useCallback as S}from"@dropins/tools/preact-hooks.js";import{events as Ne}from"@dropins/tools/event-bus.js";import{u as Ee}from"../chunks/useCompanyContextListener.js";import{g as be,u as _e}from"../chunks/updateCompany.js";import{useText as Z}from"@dropins/tools/i18n.js";import{g as he,v as Ie}from"../chunks/validateCompanyEmail.js";import*as $ from"@dropins/tools/preact-compat.js";import"../chunks/fetch-error.js";import"../chunks/fetch-graphql.js";import"@dropins/tools/fetch-graphql.js";const we=({testId:t,withCard:e=!0})=>{const n=f(ve,{"data-testid":t||"companySkeletonLoader",children:[r(Q,{variant:"heading",size:"xlarge",fullWidth:!1,lines:1}),r(Q,{variant:"heading",size:"xlarge",fullWidth:!0,lines:1}),r(Q,{variant:"heading",size:"xlarge",fullWidth:!0,lines:1})]});return e?n:r(J,{variant:"secondary",className:ee(["company-company-loaders","company-company-loaders--card-loader"]),children:n})},xe=({company:t,slots:e,showEditForm:n,handleShowEditForm:u})=>{const d=Z({editButton:"Company.shared.buttons.edit",noDataMessage:"Company.CompanyProfile.companyProfileCard.noDataMessage",companyName:"Company.shared.fields.companyName",email:"Company.shared.fields.email",legalName:"Company.shared.fields.legalName",vatTaxId:"Company.shared.fields.vatTaxId",resellerId:"Company.shared.fields.resellerId",legalAddress:"Company.shared.fields.legalAddress",contacts:"Company.CompanyProfile.companyProfileCard.contacts",companyAdministrator:"Company.CompanyProfile.companyProfileCard.companyAdministrator",salesRepresentative:"Company.CompanyProfile.companyProfileCard.salesRepresentative",paymentInformation:"Company.CompanyProfile.companyProfileCard.paymentInformation",shippingInformation:"Company.CompanyProfile.companyProfileCard.shippingInformation",availablePaymentMethods:"Company.CompanyProfile.companyProfileCard.availablePaymentMethods",availableShippingMethods:"Company.CompanyProfile.companyProfileCard.availableShippingMethods",noPaymentMethods:"Company.CompanyProfile.companyProfileCard.noPaymentMethods",noShippingMethods:"Company.CompanyProfile.companyProfileCard.noShippingMethods"});if(!t)return r(J,{variant:"secondary",className:"account-company-profile-card",children:r("div",{className:"account-company-profile-card__wrapper",children:r("div",{className:"account-company-profile-card__content",children:r("div",{className:"account-company-profile-card__no-data",children:r("p",{children:d.noDataMessage})})})})});const i=t.permissionsFlags||{canViewAccount:!0,canViewAddress:!0,canViewContacts:!0,canViewPaymentInformation:!0,canViewShippingInformation:!0},a=[i.canViewAccount?{name:"name",label:d.companyName,value:t.name||"",legalName:t.legalName||""}:null,i.canViewAccount?{name:"email",label:d.email,value:t.email||""}:null,i.canViewAccount?{name:"vatTaxId",label:d.vatTaxId,value:t.vatTaxId||""}:null,i.canViewAccount?{name:"resellerId",label:d.resellerId,value:t.resellerId||""}:null].filter(Boolean);return r(J,{variant:"secondary",className:ee(["account-company-profile-card",["account-company-profile-card-short",n]]),children:f("div",{className:"account-company-profile-card__wrapper",children:[r("div",{className:"account-company-profile-card__actions",children:(t.canEditAccount||t.canEditAddress)&&r(X,{type:"button",variant:"tertiary",onClick:u,children:d.editButton})}),r("div",{className:"account-company-profile-card__content",children:(()=>{var A,l;const y=f(K,{children:[a.map((s,c)=>{if(!s.value)return null;let C;return s.name==="name"&&s.legalName?C=`${s.label}: ${s.value} (${s.legalName})`:C=s.label?`${s.label}: ${s.value}`:s.value,r("p",{"data-testid":`${s.name}_${c}`,children:C},`${s.name}_${c}`)}),i.canViewAddress&&t.legalAddress&&f("div",{className:"company-legal-address",children:[r("p",{children:f("strong",{children:[d.legalAddress,":"]})}),(A=t.legalAddress.street)==null?void 0:A.map((s,c)=>r("p",{children:s},c)),f("p",{children:[t.legalAddress.city,", ",(l=t.legalAddress.region)==null?void 0:l.region," ",t.legalAddress.postcode]}),r("p",{children:t.legalAddress.countryCode}),t.legalAddress.telephone&&f("p",{children:["Phone: ",t.legalAddress.telephone]})]}),i.canViewContacts&&(t.companyAdmin||t.salesRepresentative)&&f("div",{className:"company-contacts",children:[r("p",{children:f("strong",{children:[d.contacts,":"]})}),t.companyAdmin&&f("div",{className:"company-contact",children:[r("p",{children:f("strong",{children:[d.companyAdministrator,":"]})}),f("p",{children:[t.companyAdmin.firstname," ",t.companyAdmin.lastname]}),t.companyAdmin.jobTitle&&r("p",{children:t.companyAdmin.jobTitle}),r("p",{children:t.companyAdmin.email})]}),t.salesRepresentative&&f("div",{className:"company-contact",children:[r("p",{children:f("strong",{children:[d.salesRepresentative,":"]})}),f("p",{children:[t.salesRepresentative.firstname," ",t.salesRepresentative.lastname]}),r("p",{children:t.salesRepresentative.email})]})]}),i.canViewPaymentInformation&&f("div",{className:"company-payment-methods",children:[r("p",{children:f("strong",{children:[d.paymentInformation,":"]})}),t.availablePaymentMethods&&t.availablePaymentMethods.length>0?f(K,{children:[r("p",{children:f("strong",{children:[d.availablePaymentMethods,":"]})}),r("ul",{className:"payment-methods-list",children:t.availablePaymentMethods.map((s,c)=>r("li",{children:s.title},`payment_${c}`))})]}):r("div",{className:"message message-notice notice",children:r("div",{children:d.noPaymentMethods})})]}),i.canViewShippingInformation&&f("div",{className:"company-shipping-methods",children:[r("p",{children:f("strong",{children:[d.shippingInformation,":"]})}),t.availableShippingMethods&&t.availableShippingMethods.length>0?f(K,{children:[r("p",{children:f("strong",{children:[d.availableShippingMethods,":"]})}),r("ul",{className:"shipping-methods-list",children:t.availableShippingMethods.map((s,c)=>r("li",{children:s.title},`shipping_${c}`))})]}):r("div",{className:"message message-notice notice",children:r("div",{children:d.noShippingMethods})})]})]});return e!=null&&e.CompanyData?r(ye,{name:"CompanyData",slot:e.CompanyData,context:{companyData:a,Default:y}}):y})()})]})})},Te=t=>{const[e,n]=L(null),[u,d]=L(!0);O(()=>{let l=!0;return he().then(({availableCountries:s,countriesWithRequiredRegion:c,optionalZipCountries:C})=>{l&&(n({availableCountries:s,countriesWithRequiredRegion:c,optionalZipCountries:C}),d(!1))}).catch(()=>{l&&d(!1)}),()=>{l=!1}},[]);const i=U(()=>(e==null?void 0:e.availableCountries)||[],[e]),a=U(()=>{if(!t||!e)return[];const l=e.availableCountries.find(s=>s.value===t);return!(l!=null&&l.availableRegions)||l.availableRegions.length===0?[]:l.availableRegions.map(s=>({text:s.name,value:`${s.code},${s.id}`}))},[t,e]),y=U(()=>!t||!e?!1:e.countriesWithRequiredRegion.includes(t),[t,e]),A=U(()=>a.length>0,[a]);return{countryOptions:i,regionOptions:a,isRegionRequired:y,hasRegionOptions:A,loadingCountries:u}},$e=({loading:t,value:e,errors:n,touched:u,onBlur:d,namePrefix:i="",fieldPathPrefix:a=""})=>{const y=Z({companyName:"Company.shared.fields.companyName",email:"Company.shared.fields.email",legalName:"Company.shared.fields.legalName",vatTaxId:"Company.shared.fields.vatTaxId",resellerId:"Company.shared.fields.resellerId"}),A=i?`${i}_`:"",l=s=>a?`${a}.${s}`:s;return f("div",{className:"account-edit-company-profile-form__group",children:[r(V,{label:y.companyName,required:!0,className:"account-edit-company-profile-form__field",error:u.name&&n.name?n.name:void 0,children:r(R,{name:`${A}name`,type:"text",value:e.name,onBlur:s=>{const c=s.target;d(l("name"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})}),r(V,{label:y.legalName,className:"account-edit-company-profile-form__field",children:r(R,{name:`${A}legalName`,type:"text",value:e.legalName,onBlur:s=>{const c=s.target;d(l("legalName"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:80})}),r(V,{label:y.email,required:!0,className:"account-edit-company-profile-form__field",error:u.email&&n.email?n.email:void 0,children:r(R,{name:`${A}email`,type:"email",value:e.email,onBlur:s=>{const c=s.target;d(l("email"),c.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:y.vatTaxId,className:"account-edit-company-profile-form__field",children:r(R,{name:`${A}vatTaxId`,type:"text",value:e.vatTaxId,onBlur:s=>{const c=s.target;d(l("vatTaxId"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})}),r(V,{label:y.resellerId,className:"account-edit-company-profile-form__field",children:r(R,{name:`${A}resellerId`,type:"text",value:e.resellerId,onBlur:s=>{const c=s.target;d(l("resellerId"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})})]})},Le=({loading:t,loadingCountries:e,value:n,errors:u,touched:d,onChange:i,onBlur:a,countryOptions:y,regionOptions:A,isRegionRequired:l,hasRegionOptions:s,namePrefix:c="legalAddress",fieldPathPrefix:C="legalAddress",requiredConfig:N})=>{var D;const _=Z({legalAddress:"Company.shared.fields.legalAddress",streetAddress:"Company.shared.fields.streetAddress",city:"Company.shared.fields.city",country:"Company.shared.fields.country",stateProvince:"Company.shared.fields.stateProvince",zipPostalCode:"Company.shared.fields.zipPostalCode",phoneNumber:"Company.shared.fields.phoneNumber"}),k={street:`${c}_street`,street2:`${c}_street2`,city:`${c}_city`,countryCode:`${c}_countryCode`,region:`${c}_region`,postcode:`${c}_postcode`,telephone:`${c}_telephone`},h={street:`${C}.street`,street2:`${C}.street2`,city:`${C}.city`,countryCode:`${C}.countryCode`,region:`${C}.region`,regionCode:`${C}.regionCode`,postcode:`${C}.postcode`,telephone:`${C}.telephone`},z={street:(N==null?void 0:N.street)??!0,city:(N==null?void 0:N.city)??!0,postcode:(N==null?void 0:N.postcode)??!0,telephone:(N==null?void 0:N.telephone)??!0};return f("div",{className:"account-edit-company-profile-form__section",children:[r("h3",{className:"account-edit-company-profile-form__section-title",children:_.legalAddress}),r(V,{label:_.streetAddress,required:z.street,className:"account-edit-company-profile-form__field",error:d[h.street]&&u[h.street]?u[h.street]:void 0,children:r(R,{name:k.street,type:"text",value:n.street,onBlur:p=>{const E=p.target;a(h.street,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:`${_.streetAddress} 2`,className:"account-edit-company-profile-form__field",children:r(R,{name:k.street2,type:"text",value:n.street2,onBlur:p=>{const E=p.target;a(h.street2,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.city,required:z.city,className:"account-edit-company-profile-form__field",error:d[h.city]&&u[h.city]?u[h.city]:void 0,children:r(R,{name:k.city,type:"text",value:n.city,onBlur:p=>{const E=p.target;a(h.city,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.country,required:!0,className:"account-edit-company-profile-form__field",error:d[h.countryCode]&&u[h.countryCode]?u[h.countryCode]:void 0,children:r(pe,{name:k.countryCode,floatingLabel:`${_.country} *`,placeholder:_.country,options:y,value:n.countryCode,handleSelect:p=>{const E=p.target;i(h.countryCode)(E.value)},onBlur:()=>a(h.countryCode),disabled:!!t||e})}),r(V,{label:_.stateProvince,required:l,className:"account-edit-company-profile-form__field",error:d["legalAddress.region"]&&u["legalAddress.region"]?u["legalAddress.region"]:void 0,children:s?r(pe,{name:"legalAddress_region",floatingLabel:`${_.stateProvince} ${l?"*":""}`,placeholder:_.stateProvince,options:A,value:n.regionCode&&((D=A.find(p=>p.value.split(",")[0]===n.regionCode))==null?void 0:D.value)||"",handleSelect:p=>{var M;const E=p.target,[B]=E.value.split(","),W=((M=A.find(H=>H.value===E.value))==null?void 0:M.text)||"";i(h.region)(W),i(h.regionCode)(B)},onBlur:()=>a(h.region),disabled:!!t||e},`region_picker_${n.countryCode}`):r(R,{name:k.region,type:"text",value:n.region,onBlur:p=>{const E=p.target;a(h.region,E.value)},disabled:!!t||e,variant:"primary",size:"medium"},`region_input_${n.countryCode}`)}),r(V,{label:_.zipPostalCode,required:z.postcode,className:"account-edit-company-profile-form__field",error:d[h.postcode]&&u[h.postcode]?u[h.postcode]:void 0,children:r(R,{name:k.postcode,type:"text",value:n.postcode,onBlur:p=>{const E=p.target;a(h.postcode,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.phoneNumber,required:z.telephone,className:"account-edit-company-profile-form__field",error:d[h.telephone]&&u[h.telephone]?u[h.telephone]:void 0,children:r(R,{name:k.telephone,type:"tel",value:n.telephone,onBlur:p=>{const E=p.target;a(h.telephone,E.value)},disabled:!!t,variant:"primary",size:"medium"})})]})},Me=({inLineAlertProps:t,company:e,loading:n=!1,onSubmit:u,onCancel:d})=>{var j,Y,q,v,F,te,re,ae,se,le,ne,oe,ie,de;const i=Z({title:"Company.EditCompanyProfile.title",cancel:"Company.shared.buttons.cancel",save:"Company.shared.buttons.save",saving:"Company.shared.buttons.saving",required:"Company.shared.validation.required",invalidEmail:"Company.shared.validation.invalidEmail",companyNameRequired:"Company.shared.validation.companyNameRequired",emailRequired:"Company.shared.validation.emailRequired",emailNotAvailable:"Company.shared.validation.emailNotAvailable",companyNameLengthError:"Company.shared.validation.companyNameLengthError",legalNameLengthError:"Company.shared.validation.legalNameLengthError",vatTaxIdLengthError:"Company.shared.validation.vatTaxIdLengthError",resellerIdLengthError:"Company.shared.validation.resellerIdLengthError"}),[a,y]=L({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",legalName:(e==null?void 0:e.legalName)||"",vatTaxId:(e==null?void 0:e.vatTaxId)||"",resellerId:(e==null?void 0:e.resellerId)||"",legalAddress:{street:((Y=(j=e==null?void 0:e.legalAddress)==null?void 0:j.street)==null?void 0:Y[0])||"",street2:((v=(q=e==null?void 0:e.legalAddress)==null?void 0:q.street)==null?void 0:v[1])||"",city:((F=e==null?void 0:e.legalAddress)==null?void 0:F.city)||"",region:((re=(te=e==null?void 0:e.legalAddress)==null?void 0:te.region)==null?void 0:re.region)||"",regionCode:((se=(ae=e==null?void 0:e.legalAddress)==null?void 0:ae.region)==null?void 0:se.regionCode)||"",countryCode:((le=e==null?void 0:e.legalAddress)==null?void 0:le.countryCode)||"",postcode:((ne=e==null?void 0:e.legalAddress)==null?void 0:ne.postcode)||"",telephone:((oe=e==null?void 0:e.legalAddress)==null?void 0:oe.telephone)||""}}),[A,l]=L({}),[s,c]=L({}),C=((ie=e==null?void 0:e.permissionsFlags)==null?void 0:ie.canEditAccount)===!0,N=((de=e==null?void 0:e.permissionsFlags)==null?void 0:de.canEditAddress)===!0,{countryOptions:_,regionOptions:k,isRegionRequired:h,hasRegionOptions:z,loadingCountries:D}=Te(a.legalAddress.countryCode),p=(o,m)=>o==="name"?m.trim()?m.length>40?i.companyNameLengthError:null:i.companyNameRequired:o==="email"?m.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m)?null:i.invalidEmail:i.emailRequired:o==="legalName"?m.length>80?i.legalNameLengthError:null:o==="vatTaxId"?m.length>40?i.vatTaxIdLengthError:null:o==="resellerId"?m.length>40?i.resellerIdLengthError:null:o==="legalAddress.street"||o==="legalAddress.city"||o==="legalAddress.postcode"||o==="legalAddress.telephone"||o==="legalAddress.countryCode"?m.trim()?null:i.required:o==="legalAddress.region"&&h&&!m.trim()?i.required:null,E=()=>{var T,P;const o={};let m=!0;const x=((T=e==null?void 0:e.permissionsFlags)==null?void 0:T.canEditAccount)===!0,g=((P=e==null?void 0:e.permissionsFlags)==null?void 0:P.canEditAddress)===!0;if(x){const b=p("name",a.name);b&&(o.name=b,m=!1);const I=p("email",a.email);if(I&&(o.email=I,m=!1),a.legalName){const w=p("legalName",a.legalName);w&&(o.legalName=w,m=!1)}if(a.vatTaxId){const w=p("vatTaxId",a.vatTaxId);w&&(o.vatTaxId=w,m=!1)}if(a.resellerId){const w=p("resellerId",a.resellerId);w&&(o.resellerId=w,m=!1)}}if(g){const b=p("legalAddress.street",a.legalAddress.street);b&&(o["legalAddress.street"]=b,m=!1);const I=p("legalAddress.city",a.legalAddress.city);I&&(o["legalAddress.city"]=I,m=!1);const w=p("legalAddress.postcode",a.legalAddress.postcode);w&&(o["legalAddress.postcode"]=w,m=!1);const ce=p("legalAddress.telephone",a.legalAddress.telephone);ce&&(o["legalAddress.telephone"]=ce,m=!1);const me=p("legalAddress.countryCode",a.legalAddress.countryCode);me&&(o["legalAddress.countryCode"]=me,m=!1);const ue=p("legalAddress.region",a.legalAddress.region);ue&&(o["legalAddress.region"]=ue,m=!1)}return l(o),m},B=async o=>{var T,P;o.preventDefault();const m=((T=e==null?void 0:e.permissionsFlags)==null?void 0:T.canEditAccount)===!0,x=((P=e==null?void 0:e.permissionsFlags)==null?void 0:P.canEditAddress)===!0,g={};if(m&&(g.name=!0,g.email=!0,g.legalName=!0,g.vatTaxId=!0,g.resellerId=!0),x&&(g["legalAddress.street"]=!0,g["legalAddress.street2"]=!0,g["legalAddress.city"]=!0,g["legalAddress.region"]=!0,g["legalAddress.regionCode"]=!0,g["legalAddress.countryCode"]=!0,g["legalAddress.postcode"]=!0,g["legalAddress.telephone"]=!0),c(g),!!E()){if(m&&a.email!==(e==null?void 0:e.email)){const b=await Ie(a.email);if(!b.isValid){l(I=>({...I,email:b.error||i.emailNotAvailable}));return}}if(u){const b={};m&&(b.name=a.name,b.email=a.email,b.legalName=a.legalName,b.vatTaxId=a.vatTaxId,b.resellerId=a.resellerId),x&&(b.legalAddress={street:[a.legalAddress.street,a.legalAddress.street2].filter(Boolean),city:a.legalAddress.city,region:{region:a.legalAddress.region,regionCode:a.legalAddress.regionCode},countryCode:a.legalAddress.countryCode,postcode:a.legalAddress.postcode,telephone:a.legalAddress.telephone}),await u(b)}}},W=(o,m)=>{if(o.startsWith("legalAddress.")){const x=o.split(".")[1];x==="countryCode"?(y(g=>({...g,legalAddress:{...g.legalAddress,[x]:m,region:"",regionCode:""}})),l(g=>{const T={...g};return delete T["legalAddress.region"],delete T["legalAddress.regionCode"],T}),c(g=>{const T={...g};return delete T["legalAddress.region"],delete T["legalAddress.regionCode"],T})):y(x==="region"?g=>({...g,legalAddress:{...g.legalAddress,region:m,regionCode:z?g.legalAddress.regionCode:m}}):g=>({...g,legalAddress:{...g.legalAddress,[x]:m}}))}else y(x=>({...x,[o]:m}))},M=o=>m=>{const x=new Set(["name","email","legalName","vatTaxId","resellerId"]),g=o.startsWith("legalAddress.");x.has(o)&&!C||g&&!N||(W(o,m),A[o]&&l(P=>{const b={...P};return delete b[o],b}))},H=(o,m)=>{const x=new Set(["name","email","legalName","vatTaxId","resellerId"]),g=o.startsWith("legalAddress.");if(x.has(o)&&!C||g&&!N)return;m!==void 0&&W(o,m),c(I=>({...I,[o]:!0}));let P=m;if(P===void 0)if(o.startsWith("legalAddress.")){const I=o.split(".")[1],w=a.legalAddress[I];P=typeof w=="string"?w:""}else{const I=a[o];P=typeof I=="string"?I:""}const b=p(o,P);l(b?I=>({...I,[o]:b}):I=>{const w={...I};return delete w[o],w})};return f(J,{variant:"secondary",className:"account-edit-company-profile",children:[r(ge,{title:i.title,divider:!1,className:"account-edit-company-profile__title"}),t!=null&&t.text?r(Ce,{className:"account-edit-company-profile__notification",type:t.type,variant:"secondary",heading:t.text,icon:t.icon,"data-testid":"editCompanyInLineAlert"}):null,f("form",{className:"account-edit-company-profile-form",onSubmit:B,children:[C&&r($e,{loading:n,value:{name:a.name,email:a.email,legalName:a.legalName,vatTaxId:a.vatTaxId,resellerId:a.resellerId},errors:A,touched:s,onBlur:H}),N&&r(Le,{loading:n,loadingCountries:D,value:a.legalAddress,errors:A,touched:s,onChange:M,onBlur:H,countryOptions:_,regionOptions:k,isRegionRequired:h,hasRegionOptions:z}),f("div",{className:"account-edit-company-profile__actions",children:[r(X,{disabled:n,type:"button",variant:"secondary",onClick:()=>d==null?void 0:d(),children:i.cancel}),r(X,{disabled:n||!C&&!N,type:"submit",variant:"primary",children:i.save})]})]}),n&&f("div",{className:"account-edit-company-profile__loading-overlay","data-testid":"editCompanyLoadingOverlay",children:[r(Ae,{size:"large"}),r("div",{className:"account-edit-company-profile__loading-text",children:i.saving})]})]})},Pe=t=>$.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("g",{clipPath:"url(#clip0_841_1324)"},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),$.createElement("defs",null,$.createElement("clipPath",{id:"clip0_841_1324"},$.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),Ve=t=>$.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),Se=t=>$.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"}));var fe=(t=>(t.EDIT_COMPANY_EVENT="edit-company",t))(fe||{});const ke={EDIT_COMPANY_EVENT:"edit-company"},Fe=()=>(window.adobeDataLayer||(window.adobeDataLayer=[]),window.adobeDataLayer),Re=t=>{Fe().push(n=>{const u=n.getState?n.getState():{};n.push({event:t,context:u})})},De=(t,e)=>{if(!ke[t])return null;switch(t){case"edit-company":Re({type:"company",eventType:"edit",companyData:e});break;default:return null}},ze=({handleSetInLineAlert:t,editFormRef:e})=>{const n=Z({companySuccess:"Company.CompanyProfile.editCompanyProfile.companySuccess",companyError:"Company.CompanyProfile.editCompanyProfile.companyError",loadError:"Company.CompanyProfile.messages.loadError",updateError:"Company.CompanyProfile.messages.updateError"}),{companySuccess:u,companyError:d,loadError:i,updateError:a}=n,[y,A]=L(null),[l,s]=L(!0),[c,C]=L(!1),[N,_]=L(!1),[k,h]=L([]),[z,D]=L({}),p=G(t),E=G(!1),B=G(!1);O(()=>{p.current=t},[t]);const W=S(v=>{D(v)},[]),M=S((v,F)=>{t&&(v==="success"?t({type:"success",text:F??u}):v==="error"?t({type:"error",text:F??d}):t(),C(!1))},[t,u,d]),H=S(async()=>{if(E.current)return null;E.current=!0,s(!0);try{const v=await be();return v&&A(v),s(!1),v}catch(v){return console.error("Failed to load company:",v),s(!1),p.current&&p.current({type:"error",text:i}),null}finally{E.current=!1}},[i]);O(()=>{B.current||(B.current=!0,H())},[H]),Ee(S(()=>{s(!0),_(!1),D({}),H()},[H])),O(()=>{he().then(v=>{h(v.availableCountries)}).catch(v=>{console.error("Failed to load countries:",v)})},[]);const j=S(()=>{_(!0),M("success",""),D({})},[M]);O(()=>{N&&(e!=null&&e.current)&&setTimeout(()=>{var v;(v=e.current)==null||v.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},[N,e]);const Y=S(v=>{v==null||v(),_(!1),D({})},[]),q=S(async v=>{try{if(C(!0),!v){M("error","No data to update");return}const F=await _e(v);A(F),_(!1),D({}),M("success"),De(fe.EDIT_COMPANY_EVENT,{...v,companyId:y==null?void 0:y.id}),Ne.emit("company/updated",{company:F})}catch(F){console.error("Failed to update company:",F),M("error",F.message||a)}finally{C(!1)}},[y,M,a]);return{company:y,countries:k,loading:l,submitLoading:c,showEditForm:N,inputChange:z,handleShowEditForm:j,handleHideEditForm:Y,handleUpdateCompany:q,handleInputChange:W,renderAlertMessage:M,saving:c}},He={success:r(Ve,{}),warning:r(Pe,{}),error:r(Se,{})},Be=()=>{const[t,e]=L({}),[n,u]=L(null),d=S(()=>{e({}),n&&(clearTimeout(n),u(null))},[n]),i=S(l=>{if(n&&(clearTimeout(n),u(null)),!(l!=null&&l.type)){e({});return}const s=He[l.type];if(e({type:l.type,text:l.text,icon:s}),l.autoHide!==!1){const c=l.autoHideDelay||(l.type==="success"?3e3:5e3),C=setTimeout(()=>{e({}),u(null)},c);u(C)}},[n]),a=S((l,s=!0)=>{i({type:"success",text:l,autoHide:s})},[i]),y=S((l,s=!1)=>{i({type:"warning",text:l,autoHide:s})},[i]),A=S((l,s=!1)=>{i({type:"error",text:l,autoHide:s})},[i]);return O(()=>()=>{n&&clearTimeout(n)},[n]),{inLineAlertProps:t,handleSetInLineAlert:i,clearAlert:d,showSuccess:a,showWarning:y,showError:A}},et=({className:t,withHeader:e=!0,slots:n})=>{const u=Z({containerTitle:"Company.CompanyProfile.containerTitle"}),{inLineAlertProps:d,handleSetInLineAlert:i}=Be(),a=G(null),{company:y,loading:A,saving:l,showEditForm:s,handleShowEditForm:c,handleHideEditForm:C,handleUpdateCompany:N}=ze({handleSetInLineAlert:i,editFormRef:a});return A?r("div",{"data-testid":"companyProfileLoader",children:r(we,{withCard:!0})}):f("div",{className:ee(["account-company-profile",t]),children:[e?r(ge,{title:u.containerTitle,divider:!1,className:"company-profile__title"}):null,r(xe,{company:y,slots:n,showEditForm:s,handleShowEditForm:c}),s?r("div",{ref:a,children:r(Me,{inLineAlertProps:d,company:y,loading:l,onSubmit:N,onCancel:C})}):null]})};export{et as CompanyProfile,et as default};
//# sourceMappingURL=CompanyProfile.js.map
