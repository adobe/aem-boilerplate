/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsx as n,jsxs as R}from"@dropins/tools/preact-jsx-runtime.js";import{h as j,i as w}from"../chunks/fetch-graphql.js";import"@dropins/tools/lib.js";import{h as C,a as L}from"../chunks/events2.js";import{n as P,g as U}from"../chunks/values.js";import{events as D}from"@dropins/tools/event-bus.js";import{c as W}from"../chunks/synchronizeCheckout.js";import{s as V}from"../chunks/setBillingAddress.js";/* empty css                             */import{Skeleton as q,SkeletonRow as $,Checkbox as y,InLineAlert as F}from"@dropins/tools/components.js";import{W as G}from"../chunks/ConditionalWrapper.js";import{c as H}from"../chunks/classes.js";import{useText as v}from"@dropins/tools/i18n.js";import{useState as b,useRef as J,useCallback as A,useEffect as B}from"@dropins/tools/preact-hooks.js";import"@dropins/tools/signals.js";import"@dropins/tools/fetch-graphql.js";import"../fragments.js";import"../chunks/transform-shipping-methods.js";import"../chunks/classifiers.js";import"../chunks/guards.js";const K=()=>n(q,{className:"bill-to-shipping-address__skeleton","data-testid":"bill-to-shipping-skeleton",children:n($,{size:"small",variant:"row"})}),M=({className:i,checked:c,disabled:e,error:t=null,onChange:p=()=>{},onDismissError:a=()=>{}})=>{const f=v({title:"Checkout.BillToShippingAddress.title"}),g=t!==null,r=l=>{const d=l.target;p==null||p(d.checked)};return R("div",{className:"checkout-bill-to-shipping-address",children:[n(y,{checked:c,className:H(["checkout-bill-to-shipping-address__checkbox",i]),"data-testid":"bill-to-shipping-checkbox",disabled:e,label:f.title,name:"checkout-bill-to-shipping-address__checkbox",onChange:r}),g&&n("div",{className:"checkout-bill-to-shipping-address__error","data-testid":"checkout-bill-to-shipping-address-alert",children:n(F,{heading:t,type:"error",variant:"primary",onDismiss:a})})]})},O=G(M,K),gs=({active:i=!0,autoSync:c=!0,onCartSyncError:e,onChange:t})=>{const[p,a]=b(null),[f,g]=b(!1),[r,l]=b(),d=J(!1),E=j.value||w.value,{cartSyncError:S}=v({cartSyncError:"Checkout.BillToShippingAddress.cartSyncError"}),I=A(()=>{a(null)},[]),N=A(s=>{a(null),l(s),t==null||t(s),!(!c||!s||!C())&&V({sameAsShipping:!0}).catch(o=>{l(!1),e==null||e({error:o}),e||a(S)})},[c,S,e,t]),h=A(s=>{var _;const o=!s||s.isEmpty,u=!!(s!=null&&s.isVirtual);if(o||u){g(u),l(!1),d.current=!1;return}if(d.current)return;const x=s,k=(_=x.shippingAddresses)==null?void 0:_[0],T=!!x.billingAddress;let m;if(k)m=k.sameAsBilling??!T;else{const{defaults:z}=W.getConfig();m=z.isBillToShipping}l(m),d.current=!0,c&&m&&k&&!T&&V({sameAsShipping:!0}).catch(()=>{})},[]);return B(()=>{!i||r===void 0||P({isBillToShipping:r})},[i,r]),B(()=>{if(!i)return;const s=L();if(s){const u=U("isBillToShipping");u!=null&&l(u),h(s);return}const o=D.on("checkout/initialized",h,{eager:!0});return()=>{o==null||o.off()}},[i,h]),B(()=>{if(!i)return;const s=D.on("checkout/updated",h,{eager:!1});return()=>{s==null||s.off()}},[i,h]),n(O,{checked:r,disabled:E,error:p,initialized:r!==void 0,visible:i&&!f,onChange:N,onDismissError:I})};export{gs as BillToShippingAddress,gs as default};
//# sourceMappingURL=BillToShippingAddress.js.map
