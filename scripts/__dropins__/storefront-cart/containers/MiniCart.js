/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as o,Fragment as j}from"@dropins/tools/preact-jsx-runtime.js";import{useState as w,useEffect as O,useCallback as V}from"@dropins/tools/preact-compat.js";import{classes as y,VComponent as u,Slot as x}from"@dropins/tools/lib.js";import{g as $}from"../chunks/persisted-data.js";import{events as q}from"@dropins/tools/event-bus.js";import{Button as N,Price as P}from"@dropins/tools/components.js";/* empty css                        */import{useText as S}from"@dropins/tools/i18n.js";import"@dropins/tools/preact-hooks.js";import{s as I}from"../chunks/resetCart.js";import{a as z}from"../chunks/acdl.js";import{u as J}from"../chunks/updateProductsFromCart.js";import"../chunks/CartSummaryGrid.js";import{C as K}from"../chunks/CartSummaryList.js";import"../chunks/OrderSummary.js";import"../chunks/CartSummaryTable2.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/refreshCart.js";import"../fragments.js";import"../chunks/EmptyCart2.js";import"../chunks/createGuestCart.js";import"../chunks/Trash.js";import"../chunks/ChevronDown.js";import"../chunks/getEstimatedTotals.js";import"../chunks/OrderSummaryLine.js";import"../chunks/ChevronUp.js";import"../chunks/Coupon.js";import"../chunks/GiftCard.js";import"../chunks/EmptyCart.js";import"../chunks/Close.js";const W=({className:C,products:d,productListFooter:p,subtotal:t,subtotalExcludingTaxes:h,preCheckoutSection:n,ctas:c,...l})=>{const b=S({subtotal:"Cart.MiniCart.subtotal",subtotalExcludingTaxes:"Cart.MiniCart.subtotalExcludingTaxes"});return e("div",{...l,className:y(["cart-mini-cart",C]),children:d&&o(j,{children:[e("div",{className:"cart-mini-cart__products","data-testid":"mini-cart-products-wrapper",children:d}),p&&e("div",{className:y(["cart-mini-cart__productListFooter"]),"data-testid":"mini-cart-product-list-footer",children:e(u,{node:p})}),o("div",{className:"cart-mini-cart__footer","data-testid":"mini-cart-subtotals",children:[t&&o("div",{className:"cart-mini-cart__footer__estimated-total","data-testid":"mini-cart-subtotal",children:[b.subtotal,e(u,{node:t})]}),h&&o("div",{className:"cart-mini-cart__footer__estimated-total-excluding-taxes","data-testid":"mini-cart-subtotal-excluding-taxes",children:[b.subtotalExcludingTaxes,e(u,{node:h,className:y(["dropin-price-summary__price","dropin-price-summary__price--muted"])})]}),n&&e("div",{className:y(["cart-mini-cart__preCheckoutSection"]),"data-testid":"mini-cart-pre-checkout-section",children:e(u,{node:n})}),c&&e(u,{node:c,className:"cart-mini-cart__footer__ctas"})]})]})})},Y=({children:C,initialData:d=null,hideFooter:p=!0,slots:t,routeProduct:h,routeCart:n,routeCheckout:c,routeEmptyCartCTA:l,showDiscount:b,showSavings:T,enableItemRemoval:D=!0,enableQuantityUpdate:Q=!1,hideHeading:F=!1,undo:U=!1,...E})=>{var v,k,L;const[i,M]=w(d),a=(v=I.config)==null?void 0:v.shoppingCartDisplaySetting;O(()=>{const r=q.on("cart/data",f=>{M(f)},{eager:!0});return()=>{r==null||r.off()}},[]);const _=S({cartLink:"Cart.MiniCart.cartLink",checkoutLink:"Cart.MiniCart.checkoutLink"}),g=(r,f)=>J([{uid:r,quantity:f}]),A=r=>g(r,0),m=i==null?void 0:i.hasOutOfStockItems,G=V(()=>{i&&!m&&z(i,I.locale)},[i,m]),H=e(x,{name:"ProductList",slot:t==null?void 0:t.ProductList,context:{itemQuantityUpdateHandler:g,itemRemoveHandler:A,totalQuantity:i==null?void 0:i.totalQuantity},children:e(K,{"data-testid":"default-cart-summary-list",routeProduct:h,routeEmptyCartCTA:l,initialData:i,maxItems:(k=I.config)==null?void 0:k.miniCartMaxItemsDisplay,showMaxItems:!!((L=I.config)!=null&&L.miniCartMaxItemsDisplay),hideHeading:F||!(i!=null&&i.totalQuantity),hideFooter:p,enableRemoveItem:D,enableUpdateItemQuantity:Q,showDiscount:b,showSavings:T,undo:U,slots:{Thumbnail:t==null?void 0:t.Thumbnail,Heading:t==null?void 0:t.Heading,EmptyCart:t==null?void 0:t.EmptyCart,Footer:t==null?void 0:t.Footer,ProductAttributes:t==null?void 0:t.ProductAttributes,CartSummaryFooter:t==null?void 0:t.CartSummaryFooter,CartItem:t==null?void 0:t.CartItem,UndoBanner:t==null?void 0:t.UndoBanner,ItemTitle:t==null?void 0:t.ItemTitle,ItemPrice:t==null?void 0:t.ItemPrice,ItemQuantity:t==null?void 0:t.ItemQuantity,ItemTotal:t==null?void 0:t.ItemTotal,ItemSku:t==null?void 0:t.ItemSku,ItemRemoveAction:t==null?void 0:t.ItemRemoveAction}})}),R=r=>e(x,{name:"ProductListFooter",slot:t==null?void 0:t.ProductListFooter,context:{data:r}}),X=r=>e(x,{name:"PreCheckoutSection",slot:t==null?void 0:t.PreCheckoutSection,context:{data:r}}),B=()=>(a==null?void 0:a.subtotal)==="INCLUDING_TAX"||(a==null?void 0:a.subtotal)==="INCLUDING_EXCLUDING_TAX"?{amount:i==null?void 0:i.subtotal.includingTax.value,currency:i==null?void 0:i.subtotal.includingTax.currency,"data-testid":"subtotal-including-tax",style:{font:"inherit"}}:{amount:i==null?void 0:i.subtotal.excludingTax.value,currency:i==null?void 0:i.subtotal.excludingTax.currency,"data-testid":"subtotal-excluding-tax",style:{font:"inherit"}};return e(W,{...E,productListFooter:R(i),subtotal:i!=null&&i.totalQuantity?(i==null?void 0:i.subtotal)&&e(P,{...B()}):void 0,subtotalExcludingTaxes:i!=null&&i.totalQuantity?(i==null?void 0:i.subtotal)&&((a==null?void 0:a.subtotal)==="INCLUDING_EXCLUDING_TAX"?e(P,{amount:i==null?void 0:i.subtotal.excludingTax.value,currency:i==null?void 0:i.subtotal.excludingTax.currency,"data-testid":"subtotal-including-excluding-tax",style:{font:"inherit"}}):void 0):void 0,preCheckoutSection:X(i),ctas:i!=null&&i.totalQuantity?o("div",{children:[c&&e(N,{"data-testid":"route-checkout-button",variant:"primary",href:m?void 0:c(),disabled:m,"aria-disabled":m,onClick:G,children:_.checkoutLink}),n&&e(N,{"data-testid":"route-cart-button",variant:"tertiary",href:n(),children:_.cartLink})]}):void 0,products:H})};Y.getInitialData=async function(){return $()};export{Y as MiniCart,Y as default};
//# sourceMappingURL=MiniCart.js.map
