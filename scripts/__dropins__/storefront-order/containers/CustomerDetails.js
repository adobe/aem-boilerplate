/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r,jsxs as a,Fragment as T}from"@dropins/tools/preact-jsx-runtime.js";import{Slot as E,classes as g}from"@dropins/tools/lib.js";import{useMemo as w,useState as k,useEffect as O,useCallback as z}from"@dropins/tools/preact-hooks.js";import"@dropins/tools/preact.js";import{events as F}from"@dropins/tools/event-bus.js";import{c as q}from"../chunks/transform-attributes-form.js";import{g as K}from"../chunks/getAttributesForm.js";import{Icon as G,Price as J,Card as Q,Header as U}from"@dropins/tools/components.js";import{f as X}from"../chunks/returnOrdersHelper.js";import{f as Y}from"../chunks/formatDateToLocale.js";import"../chunks/ShippingStatusCard.js";import*as h from"@dropins/tools/preact-compat.js";import{D as ee}from"../chunks/OrderLoaders.js";import{Text as te,useText as re}from"@dropins/tools/i18n.js";import"../chunks/network-error.js";import"../chunks/fetch-graphql.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/getFormValues.js";const ne=s=>h.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M17.93 14.8V18.75H5.97C4.75 18.75 3.75 17.97 3.75 17V6.5M3.75 6.5C3.75 5.53 4.74 4.75 5.97 4.75H15.94V8.25H5.97C4.75 8.25 3.75 7.47 3.75 6.5Z",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round"}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M19.35 11.64H14.04V14.81H19.35V11.64Z",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round"}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M17.9304 11.64V8.25H15.1504",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round"})),ie=s=>h.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M2.00718 5H22.1507C22.7047 5 23.1579 5.45323 23.1579 6.00718V7.51794C23.1579 7.51794 1.01007 7.58844 1 7.55823V6.00718C1 5.45323 1.45323 5 2.00718 5Z",stroke:"currentColor",strokeWidth:1}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M23.1579 9.78409V18.3451C23.1579 18.899 22.7047 19.3523 22.1507 19.3523H2.00718C1.45323 19.3523 1 18.899 1 18.3451V9.78409H23.1579Z",stroke:"currentColor",strokeWidth:1}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M3.01465 15.9682H8.40305",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round"}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M17.6192 17.5897C18.4535 17.5897 19.1299 16.9133 19.1299 16.0789C19.1299 15.2446 18.4535 14.5682 17.6192 14.5682C16.7848 14.5682 16.1084 15.2446 16.1084 16.0789C16.1084 16.9133 16.7848 17.5897 17.6192 17.5897Z",stroke:"currentColor",strokeWidth:1}),h.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M19.8848 17.5897C20.7192 17.5897 21.3956 16.9133 21.3956 16.0789C21.3956 15.2446 20.7192 14.5682 19.8848 14.5682C19.0504 14.5682 18.374 15.2446 18.374 16.0789C18.374 16.9133 19.0504 17.5897 19.8848 17.5897Z",stroke:"currentColor",strokeWidth:1})),S=(s,e)=>{var c;const u=n=>{const o=Array.isArray(n.value)?n.value.join(" "):n==null?void 0:n.value;return n.label?`${n.label}: ${o}`:o};return(c=s[e])==null?void 0:c.map((n,o)=>r("p",{children:u(n)},`${n.value}${o}`))},se=s=>{var o,t;const e=s&&s.length>0,u=e?(o=s[0])==null?void 0:o.name:"",c=e?(t=s[0])==null?void 0:t.code:"";return{selectedPaymentMethod:u,selectedPaymentMethodCode:c,hasToDisplayPaymentMethod:e&&u!==""}},oe=({loading:s,order:e,withHeader:u=!0,title:c,paymentIconsMap:n={},normalizeAddress:o,translations:t,slots:m})=>{var M,A,N,L;const p=!!(e!=null&&e.returnNumber),d=!!(e!=null&&e.isVirtual),i=(M=e==null?void 0:e.returns)==null?void 0:M[0],l=w(()=>({checkmo:ne,card:ie,...n}),[n]);if(!e||s)return r(ee,{});const _=(e==null?void 0:e.email)??"",f=(A=e==null?void 0:e.shipping)==null?void 0:A.code,y=(N=e==null?void 0:e.shipping)==null?void 0:N.amount,x=(L=e==null?void 0:e.shipping)==null?void 0:L.currency,P=e==null?void 0:e.payments,{selectedPaymentMethod:V,selectedPaymentMethodCode:D,hasToDisplayPaymentMethod:H}=se(P),v=l[D],C=S(o,"shippingAddress")??[],b=S(o,"billingAddress")??[],I=a("div",{className:"order-customer-details-content__container-email",children:[r("div",{className:"order-customer-details-content__container-title",children:t==null?void 0:t.emailTitle}),r("p",{children:_})]}),W=p?a("div",{className:"order-customer-details-content__container-return-information","data-testid":"returnDetailsBlock",children:[r("div",{className:"order-customer-details-content__container-title",children:t==null?void 0:t.returnInformationTitle}),r("div",{className:"order-customer-details-content__container-description",children:r(E,{"data-testid":"OrderReturnInformation",name:"OrderReturnInformation",slot:m==null?void 0:m.OrderReturnInformation,context:i,children:a(T,{children:[a("p",{children:[t.createdReturnAt,r("span",{children:Y(i==null?void 0:i.createdReturnAt)})]}),a("p",{children:[t.returnStatusLabel,r(te,{id:`Order.CustomerDetails.returnStatus.${X(i==null?void 0:i.returnStatus)}`})]}),a("p",{children:[t.orderNumberLabel,r("span",{children:i==null?void 0:i.orderNumber})]})]})})})]}):null,j=!d&&C.length?a("div",{className:"order-customer-details-content__container-shipping_address",children:[r("div",{className:"order-customer-details-content__container-title",children:t.shippingAddressTitle}),r("div",{className:"order-customer-details-content__container-description",children:C})]}):null,R=b.length?a("div",{className:g(["order-customer-details-content__container-billing_address",["order-customer-details-content__container-billing_address--fullwidth",!C.length||d]]),children:[r("div",{className:"order-customer-details-content__container-title",children:t.billingAddressTitle}),r("div",{className:"order-customer-details-content__container-description",children:b})]}):null,Z=H?a("div",{className:g(["order-customer-details-content__container-payment_methods",["order-customer-details-content__container-payment_methods--fullwidth",!f]]),children:[r("div",{className:"order-customer-details-content__container-title",children:t==null?void 0:t.paymentMethodsTitle}),a("p",{"data-testid":"payment_methods_description",className:g([["order-customer-details-content__container-payment_methods--icon",!!v]]),children:[r(E,{"data-testid":"PaymentMethodIcon",name:"PaymentMethodIcon",slot:m==null?void 0:m.PaymentMethodIcon,context:{selectedPaymentMethodCode:D},children:v?r(G,{source:v}):null}),V]})]}):null,$=f?a("div",{className:"order-customer-details-content__container-shipping_methods",children:[r("div",{className:"order-customer-details-content__container-title",children:t==null?void 0:t.shippingMethodsTitle}),y?a("p",{"data-testid":"shipping_methods_price",children:[r(J,{amount:y,currency:x})," ",f]}):r("p",{"data-testid":"shipping_methods_placeholder",children:t==null?void 0:t.freeShipping})]}):null,B=p?W:a(T,{children:[R,$,Z]});return a(Q,{"data-testid":"order-details",variant:"secondary",className:g(["order-customer-details-content"]),children:[u?r(U,{title:c??(t==null?void 0:t.headerText)}):null,a("div",{className:g(["order-customer-details-content__container",["order-customer-details-content__container--no-margin",C.length||b.length]]),children:[I,j,B]})]})},ce=["firstname","lastname","city","company","country_code","region","region_code","region_id","telephone","id","vat_id","postcode","street","street_2","default_shipping","default_billing"],ae=({orderData:s})=>{const[e,u]=k(!0),[c,n]=k(s),[o,t]=k([]);O(()=>{const d=F.on("order/data",i=>{n(i)},{eager:!0});return()=>{d==null||d.off()}},[]),O(()=>{K("shortRequest").then(d=>{if(d){const i=d.map(({name:l,orderNumber:_,label:f})=>({name:q(l),orderNumber:_,label:ce.includes(l)?null:f}));t(i)}}).finally(()=>{u(!1)})},[]);const m=z(d=>{if(!o.length||!c||!c[d])return[];const i=c[d]?Object.fromEntries(Object.entries(c[d]).map(([l,_])=>[l.toLowerCase(),_])):{};return o.filter(({name:l})=>i[l.toLowerCase()]).map(l=>({name:l.name,orderNumber:l.orderNumber,value:i[l.name.toLowerCase()],label:l.label}))},[o,c]),p=w(()=>({billingAddress:m("billingAddress"),shippingAddress:m("shippingAddress")}),[m]);return{order:c,normalizeAddress:p,loading:e}},Ne=({paymentIconsMap:s,orderData:e,title:u,className:c,slots:n})=>{const o=re({emailTitle:"Order.CustomerDetails.email.title",shippingAddressTitle:"Order.CustomerDetails.shippingAddress.title",shippingMethodsTitle:"Order.CustomerDetails.shippingMethods.title",billingAddressTitle:"Order.CustomerDetails.billingAddress.title",paymentMethodsTitle:"Order.CustomerDetails.paymentMethods.title",returnInformationTitle:"Order.CustomerDetails.returnInformation.title",headerText:"Order.CustomerDetails.headerText",freeShipping:"Order.CustomerDetails.freeShipping",createdReturnAt:"Order.CustomerDetails.orderReturnLabels.createdReturnAt",orderNumberLabel:"Order.CustomerDetails.orderReturnLabels.orderNumberLabel",returnStatusLabel:"Order.CustomerDetails.orderReturnLabels.returnStatusLabel"}),{order:t,normalizeAddress:m,loading:p}=ae({orderData:e});return r("div",{className:g(["order-customer-details",c]),children:r(oe,{slots:n,loading:p,order:t,title:u,paymentIconsMap:s,normalizeAddress:m,translations:o})})};export{Ne as CustomerDetails,Ne as default};
//# sourceMappingURL=CustomerDetails.js.map
