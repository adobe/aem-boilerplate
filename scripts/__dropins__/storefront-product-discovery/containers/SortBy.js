/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as g}from"@dropins/tools/preact-jsx-runtime.js";import{useState as n,useEffect as $}from"@dropins/tools/preact-compat.js";import{Picker as w}from"@dropins/tools/components.js";import{events as x}from"@dropins/tools/event-bus.js";import{c as p}from"../chunks/search.js";import{useText as T}from"@dropins/tools/i18n.js";import"@dropins/tools/lib.js";import"../chunks/initialize.js";import"../fragments.js";import"../chunks/acdlEvents.js";import"@dropins/tools/fetch-graphql.js";const j=({scope:t,onSortChange:e})=>{const r=T({sortLabel:"Search.SortBy.title",lowToHigh:"Search.SortBy.lowToHigh",highToLow:"Search.SortBy.highToLow"}),[s,u]=n([]),[f,S]=n("relevance_DESC"),[b,h]=n({});$(()=>{const i=x.on("search/result",o=>{var a,c;if(h(o.request),(c=(a=o.result)==null?void 0:a.metadata)!=null&&c.sortableAttributes&&(u([...o.result.metadata.sortableAttributes]),o.request.sort)){const l=L(o.request.sort);l&&S(l)}},{eager:!0,scope:t});return()=>{i==null||i.off()}},[]);const m=async i=>{e==null||e(i[0]),p({...b,sort:i,currentPage:1},{scope:t})};return g(w,{required:!0,floatingLabel:r.sortLabel,...d(s,r),value:f,handleSelect:i=>{const{value:o}=i.target,a=C(o);m(a)}})};function d(t,e){const r=[];return t.forEach((s,u)=>{s.bidirectional?r.splice(u+r.length,0,{text:`${s.label}: ${e.lowToHigh}`,value:`${s.attribute}_ASC`},{text:`${s.label}: ${e.highToLow}`,value:`${s.attribute}_DESC`}):r.splice(u+r.length,0,{text:s.label,value:`${s.attribute}_DESC`})}),{options:r}}function C(t){const e=t.indexOf("_");return[{attribute:t.substring(0,e),direction:t.substring(e+1)==="ASC"?"ASC":"DESC"}]}function L(t){return t.length>0&&t[0]?`${t[0].attribute}_${t[0].direction}`:""}export{j as SortBy,j as default};
//# sourceMappingURL=SortBy.js.map
