/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as U,jsx as e}from"@dropins/tools/preact-jsx-runtime.js";import*as w from"@dropins/tools/preact-compat.js";import{useState as E,useEffect as q}from"@dropins/tools/preact-compat.js";import{VComponent as G,classes as J,Slot as y}from"@dropins/tools/lib.js";import{events as C}from"@dropins/tools/event-bus.js";import{PriceRange as R,InLineAlert as K,Icon as Q,ProductItemCard as H,Image as W}from"@dropins/tools/components.js";/* empty css                 */import{c as X,d as Y,e as $,S as ee,P as re}from"../chunks/acdlEvents.js";import{useText as ne}from"@dropins/tools/i18n.js";const F=t=>new DOMParser().parseFromString(t,"text/html").documentElement.textContent,M=({productList:t,header:a,footer:n,imageWidth:i,imageHeight:l})=>U("div",{className:"product-discovery-product-list",style:{"--imageWidth":i,"--imageHeight":l},children:[a&&e("div",{className:"product-discovery-product-list__header",children:a}),e("div",{className:"product-discovery-product-list__grid",children:t&&e(G,{node:t})}),n&&e("div",{className:"product-discovery-product-list__footer",children:n})]}),te=({product:t})=>{var h,v,u,p,o,P,d,x,_;let a=((u=(v=(h=t.price)==null?void 0:h.regular)==null?void 0:v.amount)==null?void 0:u.currency)??"USD";Intl.supportedValuesOf("currency").includes(a)||(a="USD");const n=(P=(o=(p=t.price)==null?void 0:p.final)==null?void 0:o.amount)==null?void 0:P.value,i=(_=(x=(d=t.price)==null?void 0:d.regular)==null?void 0:x.amount)==null?void 0:_.value;return n!==void 0&&i!==void 0&&n<i?U("div",{class:"product-price",children:[e("span",{class:"regular-price-normal",children:e(R,{amount:n,currency:a})}),e("span",{class:"special-price-crossed",children:e(R,{amount:i,currency:a})})]}):e(R,{amount:i,currency:a})},ae=({product:t})=>{var u,p,o,P,d,x,_,L,S,A,N,k;let a=((P=(o=(p=(u=t.priceRange)==null?void 0:u.minimum)==null?void 0:p.regular)==null?void 0:o.amount)==null?void 0:P.currency)??"USD";Intl.supportedValuesOf("currency").includes(a)||(a="USD");const n=(x=(d=t.priceRange)==null?void 0:d.minimum)==null?void 0:x.final.amount.value,i=(L=(_=t.priceRange)==null?void 0:_.minimum)==null?void 0:L.regular.amount.value,l=(A=(S=t.priceRange)==null?void 0:S.maximum)==null?void 0:A.final.amount.value,h=(k=(N=t.priceRange)==null?void 0:N.maximum)==null?void 0:k.regular.amount.value;return n<i||l<h?U("div",{class:"product-price",children:[e("span",{class:"regular-price-normal",children:e(R,{display:"from to",minimumAmount:n,maximumAmount:l,currency:a})}),e("span",{class:"special-price-crossed",children:e(R,{display:"from to",minimumAmount:i,maximumAmount:h,currency:a})})]}):e(R,{display:"from to",minimumAmount:i,maximumAmount:h,currency:a})},ce=t=>w.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},w.createElement("g",{clipPath:"url(#clip0_841_1324)"},w.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),w.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),w.createElement("defs",null,w.createElement("clipPath",{id:"clip0_841_1324"},w.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),ie=({alertMessage:t=""})=>e("div",{className:J(["product-discovery-search-alert-message__wrapper"]),children:e("div",{className:"product-discovery-search-alert-message__content",children:e(K,{heading:t,type:"warning",icon:e(Q,{source:ce,size:"24"}),onDismiss:void 0})})}),fe=({routeProduct:t,scope:a,slots:n,imageWidth:i=400,imageHeight:l=450,skeletonCount:h=8,onSearchResult:v})=>{const u=a==="popover"?ee:re,p=ne({noResults:"Search.PLP.noResults",searchError:"Search.PLP.searchError"}),[o,P]=E(null),[d,x]=E([]),[_,L]=E(!1),[S,A]=E(null);q(()=>{const r=C.on("search/loading",L,{eager:!0,scope:a}),c=C.on("search/error",()=>{A(p.searchError)},{eager:!0,scope:a}),s=C.on("search/result",m=>{var g,f,I;A(((g=m.result)==null?void 0:g.items.length)<1?p.noResults:null),P(m.request),x((f=m.result)==null?void 0:f.items),v==null||v((I=m.result)==null?void 0:I.items),m.request.phrase?X(u):Y(u)},{eager:!0,scope:a});return()=>{r==null||r.off(),c==null||c.off(),s==null||s.off()}},[]);const N=(r,c)=>{var f;const s=(f=r.target)==null?void 0:f.closest("a");if(!s||!t)return;const m=new URL(s.href),g=new URL(t(c),window.location.origin);m.pathname===g.pathname&&m.hostname===g.hostname&&$(c.sku,u)},k=(r,c)=>{var f,I,V,D;const s={loading:c<8?"eager":"lazy",src:((I=(f=r.images)==null?void 0:f[0])==null?void 0:I.url)||"",alt:((D=(V=r.images)==null?void 0:V[0])==null?void 0:D.label)||"",width:i,height:l,params:{width:i}},m=r.name!==null?F(r.name):r.sku,g=e(W,{class:"product-discovery-product-item__image",...s,"aria-label":m||""});return e(y,{name:"ProductImage",slot:n==null?void 0:n.ProductImage,context:{product:r,defaultImageProps:s,variables:o},children:t?e("a",{href:t(r),children:g}):g})},b=r=>{const c=r.name!==null?F(r.name):"";return e(y,{name:"ProductName",slot:n==null?void 0:n.ProductName,context:{product:r,variables:o},children:t?e("a",{href:t(r),children:c}):c})},j=r=>{const c=r.typename==="ComplexProductView"?e(ae,{product:r}):e(te,{product:r});return e(y,{name:"ProductPrice",slot:n==null?void 0:n.ProductPrice,context:{product:r,variables:o},children:t?e("a",{href:t(r),children:c}):c})},z=r=>e(y,{name:"ProductActions",slot:n==null?void 0:n.ProductActions,context:{product:r,variables:o}}),B=()=>e(y,{name:"NoResults",slot:n==null?void 0:n.NoResults,context:{error:S,variables:o},children:S&&e(ie,{alertMessage:S})}),O=()=>e(M,{imageWidth:i,imageHeight:l,productList:Array.from({length:h}).map((r,c)=>e(H,{initialized:!1},c))}),T=()=>e(y,{name:"Header",slot:n==null?void 0:n.Header,context:{products:d,variables:o}}),Z=()=>e(y,{name:"Footer",slot:n==null?void 0:n.Footer,context:{products:d,variables:o}});return e("div",{children:_?O():S?B():e(M,{header:T(),footer:Z(),imageWidth:i,imageHeight:l,productList:d.map((r,c)=>e(H,{image:k(r,c),titleNode:b(r),price:j(r),actionButton:n!=null&&n.ProductActions?z(r):void 0,onClick:s=>N(s,r),initialized:!0},r.id||r.sku||c))})})};export{fe as SearchResults,fe as default};
//# sourceMappingURL=SearchResults.js.map
