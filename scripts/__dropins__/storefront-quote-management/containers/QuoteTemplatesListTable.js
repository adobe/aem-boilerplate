/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as I,jsx as a}from"@dropins/tools/preact-jsx-runtime.js";import{useState as Q,useEffect as E}from"@dropins/tools/preact-compat.js";import{classes as A,Slot as l}from"@dropins/tools/lib.js";import{Table as C,IllustratedMessage as F,Picker as j,Pagination as G,Price as V}from"@dropins/tools/components.js";import{events as $}from"@dropins/tools/event-bus.js";/* empty css                        *//* empty css                         */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{useText as B}from"@dropins/tools/i18n.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{g as k}from"../chunks/fetch-graphql.js";import"../chunks/state.js";import{g as H}from"../chunks/getQuoteTemplates.js";import"@dropins/tools/fetch-graphql.js";const J=({rowData:g=[],loading:h=!1,className:v,emptyStateMessage:T,showItemRange:m=!0,itemRangeMessage:d,showPageSizePicker:o=!0,pageSizePickerMessage:S,showPagination:n=!0,paginationMessage:u,...y})=>{const c=B({templateId:"QuoteManagement.QuoteTemplatesListTable.templateId",name:"QuoteManagement.QuoteTemplatesListTable.name",state:"QuoteManagement.QuoteTemplatesListTable.state",status:"QuoteManagement.QuoteTemplatesListTable.status",validUntil:"QuoteManagement.QuoteTemplatesListTable.validUntil",minQuoteTotal:"QuoteManagement.QuoteTemplatesListTable.minQuoteTotal",ordersPlaced:"QuoteManagement.QuoteTemplatesListTable.ordersPlaced",lastOrdered:"QuoteManagement.QuoteTemplatesListTable.lastOrdered",actions:"QuoteManagement.QuoteTemplatesListTable.actions"}),z=[{key:"templateId",label:c.templateId},{key:"name",label:c.name},{key:"state",label:c.state},{key:"status",label:c.status},{key:"validUntil",label:c.validUntil},{key:"minQuoteTotal",label:c.minQuoteTotal},{key:"ordersPlaced",label:c.ordersPlaced},{key:"lastOrdered",label:c.lastOrdered},{key:"actions",label:c.actions}],P=!h&&g.length===0&&T,f=m&&d,s=o&&S,p=n&&u,b=f||s||p;return I("div",{...y,className:A(["quote-management-quote-templates-list-table",v]),children:[a(C,{columns:z,rowData:g,loading:h,mobileLayout:"none",className:"quote-management-quote-templates-list-table__table"}),P&&a("div",{className:"quote-templates-list-table__empty-state",children:T}),b&&I("div",{className:"quote-templates-list-table__footer",children:[a("div",{className:"quote-templates-list-table__item-range",children:f&&d}),a("div",{className:"quote-templates-list-table__pagination",children:p&&u}),a("div",{className:"quote-templates-list-table__page-size-picker",children:s&&S})]})]})},se=({pageSize:g,showItemRange:h=!0,showPageSizePicker:v=!0,showPagination:T=!0,onPageSizeChange:m,onPageChange:d,slots:o,...S})=>{const[n,u]=Q(null),[y,c]=Q(!0),z=k()[0],[P,f]=Q(g||z),[s,p]=Q(1);E(()=>{const r=async()=>{try{c(!0);const t=await H({pageSize:P,currentPage:s});u(t)}catch(t){console.error("Failed to fetch quote templates:",t)}finally{c(!1)}},e=$.on("authenticated",t=>{t?r():(u(null),c(!1))},{eager:!0});return()=>{e==null||e.off()}},[P,s]);const b=r=>{f(r),p(1),m==null||m(r)},N=r=>{p(r),d==null||d(r)},M=r=>{const e=r.target,t=e==null?void 0:e.value;t&&b(Number(t))},L=r=>{const e=new Date(r);return isNaN(e.getTime())?"â€“":e.toLocaleDateString()},_=(r,e)=>r.filter(t=>t==null?void 0:t.uid).map(t=>{var O;return{id:t.id,templateId:a(l,{name:"TemplateId",slot:e==null?void 0:e.TemplateId,context:{template:t},children:a("span",{children:t.id})}),name:a(l,{name:"Name",slot:e==null?void 0:e.Name,context:{template:t},children:a("span",{children:t.name})}),state:a(l,{name:"State",slot:e==null?void 0:e.State,context:{template:t},children:a("span",{style:{textTransform:"capitalize"},children:((O=t.state)==null?void 0:O.replace(/_/g," "))||"-"})}),status:a(l,{name:"Status",slot:e==null?void 0:e.Status,context:{template:t},children:a("span",{children:t.status})}),validUntil:a(l,{name:"ValidUntil",slot:e==null?void 0:e.ValidUntil,context:{template:t},children:a("span",{children:L(t.expirationDate)})}),minQuoteTotal:a(l,{name:"MinQuoteTotal",slot:e==null?void 0:e.MinQuoteTotal,context:{template:t},children:a(V,{amount:t.prices.minNegotiatedGrandTotal.value,currency:t.prices.minNegotiatedGrandTotal.currency})}),ordersPlaced:a(l,{name:"OrdersPlaced",slot:e==null?void 0:e.OrdersPlaced,context:{template:t},children:a("span",{children:t.ordersPlaced})}),lastOrdered:a(l,{name:"LastOrdered",slot:e==null?void 0:e.LastOrdered,context:{template:t},children:a("span",{children:L(t.lastOrderedAt)})}),actions:a(l,{name:"Actions",slot:e==null?void 0:e.Actions,context:{template:t},children:a("span",{})})}}),w=n!=null&&n.items?_(n.items,o):[],i=n!=null&&n.pageInfo?{currentPage:n.pageInfo.currentPage,pageSize:n.pageInfo.pageSize,totalPages:n.pageInfo.totalPages,totalCount:n.totalCount,startItem:(n.pageInfo.currentPage-1)*n.pageInfo.pageSize+1,endItem:Math.min(n.pageInfo.currentPage*n.pageInfo.pageSize,n.totalCount),pageSizeOptions:k()}:void 0,x=!!i,q=a(l,{name:"EmptyTemplates",slot:o==null?void 0:o.EmptyTemplates,context:{templatesData:n},children:a(F,{heading:"No Quote Templates Found"})}),U=i?a(l,{name:"ItemRange",slot:o==null?void 0:o.ItemRange,context:i,children:I("span",{children:["Items ",i.startItem," to ",i.endItem," of"," ",i.totalCount," total"]})}):void 0,R=i&&i.pageSizeOptions?I(l,{name:"PageSizePicker",slot:o==null?void 0:o.PageSizePicker,context:{pageSize:i.pageSize,pageSizeOptions:i.pageSizeOptions,onPageSizeChange:b},children:[a("span",{children:"Show "}),a(j,{variant:"primary",size:"medium",value:String(i.pageSize),options:i.pageSizeOptions.map(r=>({value:String(r),text:String(r)})),handleSelect:M}),a("span",{children:" per page"})]}):void 0,D=i?a(l,{name:"Pagination",slot:o==null?void 0:o.Pagination,context:{currentPage:i.currentPage,totalPages:i.totalPages,onChange:N},children:a(G,{currentPage:i.currentPage,totalPages:i.totalPages,onChange:N})}):void 0;return a(J,{rowData:w,loading:y,className:S.className,emptyStateMessage:q,showItemRange:h&&x,itemRangeMessage:U,showPageSizePicker:v&&x,pageSizePickerMessage:R,showPagination:T&&x,paginationMessage:D})};export{se as QuoteTemplatesListTable,se as default};
//# sourceMappingURL=QuoteTemplatesListTable.js.map
