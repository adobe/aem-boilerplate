/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as l,jsx as o,Fragment as v}from"@dropins/tools/preact-jsx-runtime.js";import{classes as b}from"@dropins/tools/lib.js";import{TextArea as T,Button as y,Skeleton as F,SkeletonRow as f,Card as A}from"@dropins/tools/components.js";import{events as S}from"@dropins/tools/event-bus.js";import"../chunks/PurchaseOrderHistoryLogContent.js";import{P as h}from"../chunks/PurchaseOrdersHeader.js";import{useState as c,useMemo as k,useCallback as x}from"@dropins/tools/preact-hooks.js";import{u as M}from"../chunks/usePurchaseOrderData.js";import"@dropins/tools/preact.js";import{a as p}from"../chunks/addPurchaseOrderComment.js";import{useText as V}from"@dropins/tools/i18n.js";import"../chunks/fetch-graphql.js";import"@dropins/tools/fetch-graphql.js";const j=({t:r,purchaseOrderData:e})=>{const[s,i]=c(!1),[t,m]=c(""),[n,u]=c(""),g=k(()=>!t.trim().length||!(e!=null&&e.uid)||s,[t,e,s]),C=x(d=>{const a=d.target.value;m(a),n&&u("")},[n]),P=x(()=>{const d=(e==null?void 0:e.uid)??"";!d||!t.trim().length||(i(!0),p(d,t).then(a=>{a&&(e!=null&&e.uid)&&(S.emit("purchase-order/refresh",!0),m(""))}).catch(()=>{u(r.errorMessage||"Failed to add comment. Please try again.")}).finally(()=>{i(!1)}))},[e,t,r]);return l("div",{className:b(["b2b-purchase-order-comment-form-content"]),children:[o(T,{errorMessage:n,disabled:s,value:t,label:r.textAreaPlaceholder,onChange:C}),o(y,{variant:"primary",disabled:g,onClick:P,children:r.buttonText})]})},K=({withHeader:r=!0,withWrapper:e=!0,className:s})=>{const{poDataLoading:i,purchaseOrderData:t}=M(),m=V({headerText:"PurchaseOrders.comments.add.headerText",buttonText:"PurchaseOrders.comments.add.submit",textAreaPlaceholder:"PurchaseOrders.comments.add.placeholder"}),n=l(v,{children:[r&&e?o(h,{headerText:m.headerText,divider:!0}):null,i?l(F,{rowGap:"medium","data-testid":"comment-form-loader",children:[o(f,{size:"xlarge",variant:"row",fullWidth:!0,lines:2,style:{maxWidth:500}}),o(f,{size:"medium",variant:"row",lines:1})]}):o(j,{purchaseOrderData:t,t:m})]});return l("div",{className:b(["b2b-purchase-order-comment-form",s]),"data-testid":"order-history-log-container",children:[r&&!e?o(h,{headerText:m.headerText}):null,e?o(A,{variant:"secondary","data-testid":"orderCommentFormCard",children:n}):n]})};export{K as PurchaseOrderCommentForm,K as default};
//# sourceMappingURL=PurchaseOrderCommentForm.js.map
