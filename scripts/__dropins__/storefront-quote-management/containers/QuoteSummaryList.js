/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as i,jsxs as f,Fragment as k}from"@dropins/tools/preact-jsx-runtime.js";import*as S from"@dropins/tools/preact-compat.js";import{useState as A,useEffect as ie,useCallback as oe}from"@dropins/tools/preact-compat.js";import{Divider as $,Skeleton as ce,SkeletonRow as ue,Price as Q,Image as le,Button as se,CartList as de,Accordion as me,AccordionSection as ge,CartItem as ye}from"@dropins/tools/components.js";import{classes as v,VComponent as E,Slot as s}from"@dropins/tools/lib.js";/* empty css                              */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";/* empty css                        *//* empty css                          */import{Q as _,s as he}from"../chunks/state.js";import{events as pe}from"@dropins/tools/event-bus.js";import{S as ve}from"../chunks/ChevronDown.js";import{useText as fe}from"@dropins/tools/i18n.js";const _e=e=>S.createElement("svg",{id:"Icon_Chevron_right_Base","data-name":"Icon \\u2013 Chevron right \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...e},S.createElement("g",{id:"Large"},S.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),S.createElement("g",{id:"Chevron_right_icon","data-name":"Chevron right icon"},S.createElement("path",{vectorEffect:"non-scaling-stroke",id:"chevron",d:"M199.75,367.5l4.255,-4.255-4.255,-4.255",transform:"translate(-189.25 -351.0)",fill:"none",stroke:"currentColor"})))),j=({className:e,children:n,heading:t,footer:a,products:o,outOfStockMessage:r,loading:l=!0,variant:d="primary",...m})=>i("div",{...m,className:v(["quote-management-quote-summary-list",e,`quote-management-quote-summary-list__background--${d}`]),children:l?i(be,{}):f(k,{children:[(t||r)&&f("div",{"data-testid":"quote-summary-list-heading-wrapper",className:v(["quote-management-quote-summary-list__heading",["quote-management-quote-summary-list__heading--full-width",!o]]),children:[t&&f(k,{children:[i(E,{node:t,className:"quote-management-quote-summary-list__heading-text"}),i($,{variant:"primary",className:v(["quote-management-quote-summary-list__heading-divider"])})]}),r&&i(E,{node:r,className:"quote-management-quote-summary-list__out-of-stock-message"})]}),i("div",{className:v(["quote-management-quote-summary-list__content"]),children:o}),a&&f(k,{children:[i($,{variant:"primary",className:v(["quote-management-quote-summary-list__footer-divider"])}),i(E,{node:a,className:"quote-management-quote-summary-list__footer-text"})]})]})}),be=()=>i(ce,{"data-testid":"quote-summary-list-skeleton",className:"quote-management-quote-summary-list__skeleton",rowGap:"medium",children:i(ue,{variant:"row",size:"xlarge",fullWidth:!0,lines:3,multilineGap:"small"})}),xe=()=>{const[e,n]=A(void 0),[t,a]=A(!0);return ie(()=>{const o=pe.on("quote-management/quote-data",r=>{const{quote:l}=r;l&&(n(l),a(!1))},{eager:!0});return()=>o==null?void 0:o.off()},[]),{quoteData:e,loading:t}},F=(e,n)=>{var t;return((t=n.quoteDisplaySettings)==null?void 0:t.price)===_.TAX_INCLUDED?e.discounted?{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.priceIncludingTax.value,currency:e.prices.priceIncludingTax.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"regular-item-price"}},B=e=>{var n,t;return{amount:(n=e.savingsAmount)==null?void 0:n.value,currency:(t=e.savingsAmount)==null?void 0:t.currency,style:{font:"inherit"},"data-testid":"item-savings-amount"}},z=(e,n)=>{var o,r,l,d,m,b,x,C,u,h,p,q;const t={"aria-label":n.dictionary.regularPrice},a=e.discounted?{}:null;return((o=n.quoteDisplaySettings)==null?void 0:o.price)===_.TAX_INCLUDED||((r=n.quoteDisplaySettings)==null?void 0:r.price)===_.TAX_INCLUDED_AND_EXCLUDED?(t.amount=(l=e.prices.rowTotalIncludingTax)==null?void 0:l.value,t.currency=(d=e.prices.rowTotalIncludingTax)==null?void 0:d.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="including-tax-item-total",a&&(t.amount=(m=e.prices.originalRowTotal)==null?void 0:m.value,t.currency=(b=e.prices.originalRowTotal)==null?void 0:b.currency,a.amount=(x=e.prices.rowTotalIncludingTax)==null?void 0:x.value,a.currency=(C=e.prices.rowTotalIncludingTax)==null?void 0:C.currency,a.sale=!0,a["aria-label"]=n.dictionary.discountedPrice,a["data-testid"]="discount-total")):(t.amount=(u=e.prices.originalRowTotal)==null?void 0:u.value,t.currency=(h=e.prices.originalRowTotal)==null?void 0:h.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="regular-item-total",a&&(a.amount=(p=e.discountedTotal)==null?void 0:p.value,a.currency=(q=e.discountedTotal)==null?void 0:q.currency,a.sale=!0,a["aria-label"]=n.dictionary.discountedPrice,a["data-testid"]="discount-total")),{totalProps:t,discountProps:a}},Ie=e=>{const n=e==null?void 0:e.map(a=>({label:a.label,value:a.values.map(o=>o.label).join(", ")})),t={};return n==null||n.forEach(a=>{t[a.label]=a.value}),Object.keys(t).length>0?t:null},Te=e=>{const n=e==null?void 0:e.map(a=>({label:a.optionLabel,value:a.valueLabel})),t={};return n==null||n.forEach(a=>{t[a.label]=a.value}),Object.keys(t).length>0?t:null},Se=e=>{const n=e==null?void 0:e.map(a=>({label:a.label,type:a.type,values:a.values.map(o=>({label:o.label,value:o.value}))})),t={};return n==null||n.forEach(a=>{var o;switch(a.type){case"field":case"area":case"date_time":t[a.label]=a.values[0].value;break;case"radio":case"drop_down":t[a.label]=a.values[0].label;break;case"multiple":case"checkbox":t[a.label]=a.values.reduce((r,l)=>r?`${r}, ${l.label}`:l.label,"");break;case"file":{const r=new DOMParser,l=a.values[0].value,m=((o=r.parseFromString(l,"text/html").querySelector("a"))==null?void 0:o.textContent)||"";t[a.label]=m;break}}}),t},Qe=4,G=(e,n,t)=>{var r;if(t.attributesToHide.includes("image"))return;const a={loading:n<Qe?"eager":"lazy",src:e.image.src,alt:e.image.alt,width:"300",height:"300",params:{width:300}},o=i(le,{"data-testid":"quote-summary-list-item-image",...a});return i(s,{name:"Thumbnail",slot:(r=t.slots)==null?void 0:r.Thumbnail,context:{item:e,defaultImageProps:a},children:t.routeProduct?i("a",{href:t.routeProduct(e),children:o}):o})},V=(e,n)=>{if(!n.attributesToHide.includes("name"))return i("span",{"data-testid":"quote-summary-list-item-title",children:n.routeProduct?i("a",{href:n.routeProduct(e),children:e.product.name}):e.product.name})},W=e=>i("span",{"data-testid":"quote-summary-list-item-sku",children:e.product.sku}),Y=(e,n)=>{var t;return i(s,{name:"ProductAttributes",slot:(t=n.slots)==null?void 0:t.ProductAttributes,context:{item:e}})},H=(e,n)=>{if(n.attributesToHide.includes("configurations"))return;const t={...Ie(e.bundleOptions),...Te(e.configurableOptions),...Se(e.customizableOptions),...e.links&&e.links.count?e.links.count>1?{[n.dictionary.files.replace("{count}",e.links.count.toString())]:e.links.result}:{[n.dictionary.file.replace("{count}",e.links.count.toString())]:e.links.result}:null};if(Object.keys(t).length!==0)return t},J=(e,n)=>{var t;return((t=n.quoteDisplaySettings)==null?void 0:t.price)===_.TAX_INCLUDED_AND_EXCLUDED?i(Q,{amount:e.prices.rowTotal.value,currency:e.prices.rowTotal.currency,"data-testid":"excluding-tax-total","aria-label":n.dictionary.regularPrice}):void 0},Ue=({hideHeading:e,hideFooter:n,routeProduct:t,showMaxItems:a=!0,attributesToHide:o=[],slots:r,accordion:l=!1,variant:d="primary",showDiscount:m,showSavings:b,...x})=>{const{quoteData:u,loading:h}=xe(),[p,q]=A(a),{quoteDisplaySettings:g,quoteSummaryMaxItems:K}=he.config,N=K||5,y=fe({discountedPrice:"NegotiableQuote.QuoteSummaryList.discountedPrice",discountPercentage:"NegotiableQuote.QuoteSummaryList.discountPercentage",editQuote:"NegotiableQuote.QuoteSummaryList.editQuote",file:"NegotiableQuote.QuoteSummaryList.file",files:"NegotiableQuote.QuoteSummaryList.files",heading:"NegotiableQuote.QuoteSummaryList.heading",listOfQuoteItems:"NegotiableQuote.QuoteSummaryList.listOfQuoteItems",regularPrice:"NegotiableQuote.QuoteSummaryList.regularPrice",savingsAmount:"NegotiableQuote.QuoteSummaryList.savingsAmount",viewMore:"NegotiableQuote.QuoteSummaryList.viewMore"}),Z=oe(()=>{q(c=>!c)},[]),I={attributesToHide:o,routeProduct:t,slots:r,dictionary:y,quoteDisplaySettings:g},w={dictionary:y,quoteDisplaySettings:g},L=c=>i(s,{name:"Footer",slot:r==null?void 0:r.Footer,context:{item:c}}),ee=()=>u!=null&&u.totalQuantity?u.items.map((c,U)=>{const{totalProps:re,discountProps:X}=z(c,w),ne=i(ye,{loading:h,"data-testid":`quote-summary-list-item-entry-${c.uid}`,image:G(c,U,I),title:i(s,{name:"ItemTitle",slot:r==null?void 0:r.ItemTitle,context:{item:c},children:V(c,I)}),sku:o.includes("sku")?void 0:i(s,{name:"ItemSku",slot:r==null?void 0:r.ItemSku,context:{item:c},children:W(c)}),price:o.includes("price")?void 0:i(s,{name:"ItemPrice",slot:r==null?void 0:r.ItemPrice,context:{item:c},slotTag:"span",children:i(Q,{...F(c,w)})}),quantity:o.includes("quantity")?void 0:c.quantity,total:f(k,{children:[o.includes("total")?void 0:i(s,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:c},children:i(Q,{...re})}),o.includes("totalDiscount")?void 0:X&&i(s,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:c},children:i(Q,{...X})})]}),attributes:Y(c,I),configurations:H(c,I),totalExcludingTax:o.includes("totalExcludingTax")?void 0:J(c,I),taxIncluded:(g==null?void 0:g.price)===_.TAX_INCLUDED,taxExcluded:!o.includes("totalExcludingTax")&&(g==null?void 0:g.price)===_.TAX_INCLUDED_AND_EXCLUDED,discount:m&&c.discounted&&c.discountPercentage!==void 0?i("div",{"data-testid":"item-discount-percentage",children:y.discountPercentage.replace("{discount}",c.discountPercentage.toString())}):void 0,savings:b&&c.discounted&&c.savingsAmount!==void 0?f("div",{children:[i("span",{children:i(Q,{...B(c)})}),"Â ",y.savingsAmount]}):void 0,footer:L(c)},c.uid);return i(s,{name:"CartItem",slot:r==null?void 0:r.QuoteItem,context:{item:c,index:U,loading:h,attributesToHide:o,quoteDisplaySettings:g,showDiscount:m,showSavings:b,dictionary:y,getImage:G,getTitle:V,getSku:W,getPriceProps:F,getTotalPriceProps:z,getProductAttributes:Y,getConfigurations:H,getTotalExcludingTax:J,getFooter:L,getSavingsAmount:B},children:ne},c.uid)}):null,O=i(s,{name:"Heading",slot:r==null?void 0:r.Heading,context:{count:(u==null?void 0:u.totalQuantity)??0,quoteId:u==null?void 0:u.uid},children:i("div",{"data-testid":"default-quote-summary-list-heading",children:y.heading.replace("({count})",u!=null&&u.totalQuantity?`(${u==null?void 0:u.totalQuantity.toString()})`:"")})}),M=O.props.children.props.children,P=ee(),T=(u==null?void 0:u.items.length)||0,te=p?Math.min(T,N):T,ae=T>te,D=u!=null&&u.totalQuantity&&P?i(s,{name:"Footer",slot:r==null?void 0:r.QuoteSummaryFooter,context:{displayMaxItems:p},"data-testid":"quote-summary-list-footer-slot",className:"quote-management-quote-summary-list-footer",children:ae?i(se,{className:"quote-management-quote-summary-list-footer__action",onClick:Z,"data-testid":"view-more-items-button",variant:"tertiary",children:y.viewMore}):null}):null,R=u!=null&&u.totalQuantity?i(de,{"data-testid":"quote-summary-list",children:P==null?void 0:P.slice(0,p?Math.min(T,N):T)}):null;return l?i(me,{"data-testid":"quote-summary-list-accordion",className:v(["quote-management-quote-summary-list-accordion",`quote-management-quote-summary-list__background--${d}`]),iconOpen:_e,iconClose:ve,children:i(ge,{title:M,ariaLabelTitle:M,"data-testid":"quote-summary-list-accordion__section",open:!0,renderContentWhenClosed:!0,children:i(j,{...x,"aria-expanded":!0,"aria-label":y.listOfQuoteItems,className:"quote-management-quote-summary-list-accordion__list",footer:n?void 0:D,products:R,outOfStockMessage:void 0,loading:h,variant:d})})}):i(j,{...x,heading:e?void 0:O,footer:n?void 0:D,products:R,outOfStockMessage:void 0,loading:h,variant:d})};export{Ue as QuoteSummaryList,Ue as default};
//# sourceMappingURL=QuoteSummaryList.js.map
