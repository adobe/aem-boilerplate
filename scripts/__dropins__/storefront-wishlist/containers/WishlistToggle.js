/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r}from"@dropins/tools/preact-jsx-runtime.js";import{useState as h,useCallback as E,useEffect as I}from"@dropins/tools/preact-compat.js";import{Button as j,Icon as c}from"@dropins/tools/components.js";import{events as a}from"@dropins/tools/event-bus.js";import{s as F,g as P,i as x,r as A}from"../chunks/removeProductsFromWishlist.js";import{c as M,a as R}from"../chunks/mergeWishlists.js";import{S as q}from"../chunks/HeartFilled.js";import{S as H}from"../chunks/Heart.js";import{useText as N}from"@dropins/tools/i18n.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/lib.js";const $=({product:s,iconWishlisted:D,iconToWishlist:W,size:d,variant:O,disabled:U,labelToWishlist:g,labelWishlisted:b,onClick:u,removeProdFromCart:v})=>{const[k,w]=h(F.authenticated),[n,o]=h(!1),[L,S]=h(null),{isGuestWishlistEnabled:T}=M.getConfig(),f=N({addToWishlist:"Wishlist.Wishlist.ariaLabelAddToWishlist",removeFromWishlist:"Wishlist.Wishlist.ariaLabelRemoveFromWishlist"}),l=E(()=>{var t;const e=P(),i=(t=e==null?void 0:e.items)==null?void 0:t.find(m=>x(m,{sku:s.topLevelSku??s.sku,optionUIDs:s.optionUIDs??(s.selectedOptionsUIDs?Object.values(s.selectedOptionsUIDs):void 0)??(s.bundleOptionsUIDs?Object.values(s.bundleOptionsUIDs):void 0)}));S(i??null),o(!!i)},[s.topLevelSku,s.sku,s.optionUIDs,s.selectedOptionsUIDs,s.bundleOptionsUIDs]);I(()=>{l()},[l]),I(()=>{const e=m=>w(m),i=a.on("authenticated",e),t=a.on("wishlist/data",l);return()=>{i==null||i.off(),t==null||t.off()}},[l]);const y=async()=>{var e;if(n){try{await A([L])}catch{return a.emit("wishlist/alert",{action:"removeError",item:{product:s}}),null}o(!1),a.emit("wishlist/alert",{action:"remove",item:{product:s}})}else{try{await R([{sku:s.topLevelSku??s.sku,quantity:1,optionsUIDs:s.optionUIDs??(s.selectedOptionsUIDs?Object.values(s.selectedOptionsUIDs):void 0)??(s.bundleOptionsUIDs?Object.values(s.bundleOptionsUIDs):void 0),enteredOptions:(e=s.options)!=null&&e.items?s.options.items.filter(i=>i.selected).map(i=>({uid:i.uid,value:i.value})):void 0}])}catch{return a.emit("wishlist/alert",{action:"addError",item:{product:s}}),null}o(!0),a.emit("wishlist/alert",{action:"add",item:{product:s}}),v&&await v([{uid:s.uid,quantity:0}])}};if(!k&&!T)return null;const C=n?f.removeFromWishlist.replace("{PRODUCT_NAME}",s==null?void 0:s.name):f.addToWishlist.replace("{PRODUCT_NAME}",s==null?void 0:s.name);return r(j,{active:n,"aria-label":C,"data-testid":"wishlist-toggle",size:d??"medium",variant:O??"tertiary",disabled:U,icon:r(c,{source:W??H}),activeIcon:r(c,{source:D??q}),onClick:u??y,children:g,activeChildren:b})};export{$ as WishlistToggle,$ as default};
//# sourceMappingURL=WishlistToggle.js.map
