/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as v,jsx as a}from"@dropins/tools/preact-jsx-runtime.js";import{useState as Q,useEffect as E}from"@dropins/tools/preact-compat.js";import{classes as A,Slot as l}from"@dropins/tools/lib.js";import{Table as C,IllustratedMessage as F,Picker as j,Pagination as G,Price as V}from"@dropins/tools/components.js";import{events as $}from"@dropins/tools/event-bus.js";/* empty css                        *//* empty css                         */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{useText as B}from"@dropins/tools/i18n.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{g as k}from"../chunks/fetch-graphql.js";import"../chunks/state.js";import{g as H}from"../chunks/getQuoteTemplates.js";import"@dropins/tools/fetch-graphql.js";const J=({rowData:p=[],loading:h=!1,className:y,emptyStateMessage:S,showItemRange:u=!0,itemRangeMessage:d,showPageSizePicker:o=!0,pageSizePickerMessage:T,showPagination:n=!0,paginationMessage:m,...z})=>{const c=B({name:"QuoteManagement.QuoteTemplatesListTable.name",state:"QuoteManagement.QuoteTemplatesListTable.state",status:"QuoteManagement.QuoteTemplatesListTable.status",validUntil:"QuoteManagement.QuoteTemplatesListTable.validUntil",minQuoteTotal:"QuoteManagement.QuoteTemplatesListTable.minQuoteTotal",ordersPlaced:"QuoteManagement.QuoteTemplatesListTable.ordersPlaced",lastOrdered:"QuoteManagement.QuoteTemplatesListTable.lastOrdered",actions:"QuoteManagement.QuoteTemplatesListTable.actions"}),x=[{key:"name",label:c.name},{key:"state",label:c.state},{key:"status",label:c.status},{key:"validUntil",label:c.validUntil},{key:"minQuoteTotal",label:c.minQuoteTotal},{key:"ordersPlaced",label:c.ordersPlaced},{key:"lastOrdered",label:c.lastOrdered},{key:"actions",label:c.actions}],P=!h&&p.length===0&&S,f=u&&d,s=o&&T,g=n&&m,b=f||s||g;return v("div",{...z,className:A(["quote-management-quote-templates-list-table",y]),children:[a(C,{columns:x,rowData:p,loading:h,mobileLayout:"none",className:"quote-management-quote-templates-list-table__table"}),P&&a("div",{className:"quote-templates-list-table__empty-state",children:S}),b&&v("div",{className:"quote-templates-list-table__footer",children:[a("div",{className:"quote-templates-list-table__item-range",children:f&&d}),a("div",{className:"quote-templates-list-table__pagination",children:g&&m}),a("div",{className:"quote-templates-list-table__page-size-picker",children:s&&T})]})]})},se=({pageSize:p,showItemRange:h=!0,showPageSizePicker:y=!0,showPagination:S=!0,onPageSizeChange:u,onPageChange:d,slots:o,...T})=>{const[n,m]=Q(null),[z,c]=Q(!0),x=k()[0],[P,f]=Q(p||x),[s,g]=Q(1);E(()=>{const r=async()=>{try{c(!0);const t=await H({pageSize:P,currentPage:s});m(t)}catch(t){console.error("Failed to fetch quote templates:",t)}finally{c(!1)}},e=$.on("authenticated",t=>{t?r():(m(null),c(!1))},{eager:!0});return()=>{e==null||e.off()}},[P,s]);const b=r=>{f(r),g(1),u==null||u(r)},N=r=>{g(r),d==null||d(r)},_=r=>{const e=r.target,t=e==null?void 0:e.value;t&&b(Number(t))},O=r=>{const e=new Date(r);return isNaN(e.getTime())?"â€“":e.toLocaleDateString()},M=(r,e)=>r.filter(t=>t==null?void 0:t.uid).map(t=>{var L;return{id:t.id,name:a(l,{name:"Name",slot:e==null?void 0:e.Name,context:{template:t},children:a("span",{children:t.name})}),state:a(l,{name:"State",slot:e==null?void 0:e.State,context:{template:t},children:a("span",{style:{textTransform:"capitalize"},children:((L=t.state)==null?void 0:L.replace(/_/g," "))||"-"})}),status:a(l,{name:"Status",slot:e==null?void 0:e.Status,context:{template:t},children:a("span",{children:t.status})}),validUntil:a(l,{name:"ValidUntil",slot:e==null?void 0:e.ValidUntil,context:{template:t},children:a("span",{children:O(t.expirationDate)})}),minQuoteTotal:a(l,{name:"MinQuoteTotal",slot:e==null?void 0:e.MinQuoteTotal,context:{template:t},children:a(V,{amount:t.prices.minNegotiatedGrandTotal.value,currency:t.prices.minNegotiatedGrandTotal.currency})}),ordersPlaced:a(l,{name:"OrdersPlaced",slot:e==null?void 0:e.OrdersPlaced,context:{template:t},children:a("span",{children:t.ordersPlaced})}),lastOrdered:a(l,{name:"LastOrdered",slot:e==null?void 0:e.LastOrdered,context:{template:t},children:a("span",{children:O(t.lastOrderedAt)})}),actions:a(l,{name:"Actions",slot:e==null?void 0:e.Actions,context:{template:t},children:a("span",{})})}}),w=n!=null&&n.items?M(n.items,o):[],i=n!=null&&n.pageInfo?{currentPage:n.pageInfo.currentPage,pageSize:n.pageInfo.pageSize,totalPages:n.pageInfo.totalPages,totalCount:n.totalCount,startItem:(n.pageInfo.currentPage-1)*n.pageInfo.pageSize+1,endItem:Math.min(n.pageInfo.currentPage*n.pageInfo.pageSize,n.totalCount),pageSizeOptions:k()}:void 0,I=!!i,q=a(l,{name:"EmptyTemplates",slot:o==null?void 0:o.EmptyTemplates,context:{templatesData:n},children:a(F,{heading:"No Quote Templates Found"})}),U=i?a(l,{name:"ItemRange",slot:o==null?void 0:o.ItemRange,context:i,children:v("span",{children:["Items ",i.startItem," to ",i.endItem," of"," ",i.totalCount," total"]})}):void 0,R=i&&i.pageSizeOptions?v(l,{name:"PageSizePicker",slot:o==null?void 0:o.PageSizePicker,context:{pageSize:i.pageSize,pageSizeOptions:i.pageSizeOptions,onPageSizeChange:b},children:[a("span",{children:"Show "}),a(j,{variant:"primary",size:"medium",value:String(i.pageSize),options:i.pageSizeOptions.map(r=>({value:String(r),text:String(r)})),handleSelect:_}),a("span",{children:" per page"})]}):void 0,D=i?a(l,{name:"Pagination",slot:o==null?void 0:o.Pagination,context:{currentPage:i.currentPage,totalPages:i.totalPages,onChange:N},children:a(G,{currentPage:i.currentPage,totalPages:i.totalPages,onChange:N})}):void 0;return a(J,{rowData:w,loading:z,className:T.className,emptyStateMessage:q,showItemRange:h&&I,itemRangeMessage:U,showPageSizePicker:y&&I,pageSizePickerMessage:R,showPagination:S&&I,paginationMessage:D})};export{se as QuoteTemplatesListTable,se as default};
//# sourceMappingURL=QuoteTemplatesListTable.js.map
