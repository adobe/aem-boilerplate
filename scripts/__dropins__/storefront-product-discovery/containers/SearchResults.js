/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsxs as U,jsx as e}from"@dropins/tools/preact-jsx-runtime.js";import*as w from"@dropins/tools/preact-compat.js";import{useState as E,useEffect as Z}from"@dropins/tools/preact-compat.js";import{VComponent as q,classes as G,Slot as k}from"@dropins/tools/lib.js";import{events as C}from"@dropins/tools/event-bus.js";import{PriceRange as y,InLineAlert as J,Icon as K,ProductItemCard as H,Image as Q}from"@dropins/tools/components.js";/* empty css                 */import{c as X,d as Y,e as $,S as ee,P as re}from"../chunks/acdlEvents.js";import{useText as ne}from"@dropins/tools/i18n.js";const F=t=>new DOMParser().parseFromString(t,"text/html").documentElement.textContent,M=({productList:t,header:a,footer:n,imageWidth:c,imageHeight:l})=>U("div",{className:"product-discovery-product-list",style:{"--imageWidth":c,"--imageHeight":l},children:[a&&e("div",{className:"product-discovery-product-list__header",children:a}),e("div",{className:"product-discovery-product-list__grid",children:t&&e(q,{node:t})}),n&&e("div",{className:"product-discovery-product-list__footer",children:n})]}),te=({product:t})=>{var h,v,u,p,o,P,d,x,_;let a=((u=(v=(h=t.price)==null?void 0:h.regular)==null?void 0:v.amount)==null?void 0:u.currency)??"USD";Intl.supportedValuesOf("currency").includes(a)||(a="USD");const n=(P=(o=(p=t.price)==null?void 0:p.final)==null?void 0:o.amount)==null?void 0:P.value,c=(_=(x=(d=t.price)==null?void 0:d.regular)==null?void 0:x.amount)==null?void 0:_.value;return n!==void 0&&c!==void 0&&n<c?U("div",{class:"product-price",children:[e("span",{class:"regular-price-normal",children:e(y,{amount:n,currency:a})}),e("span",{class:"special-price-crossed",children:e(y,{amount:c,currency:a})})]}):e(y,{amount:c,currency:a})},ae=({product:t})=>{var u,p,o,P,d,x,_,I,S,R,L,N;let a=((P=(o=(p=(u=t.priceRange)==null?void 0:u.minimum)==null?void 0:p.regular)==null?void 0:o.amount)==null?void 0:P.currency)??"USD";Intl.supportedValuesOf("currency").includes(a)||(a="USD");const n=(x=(d=t.priceRange)==null?void 0:d.minimum)==null?void 0:x.final.amount.value,c=(I=(_=t.priceRange)==null?void 0:_.minimum)==null?void 0:I.regular.amount.value,l=(R=(S=t.priceRange)==null?void 0:S.maximum)==null?void 0:R.final.amount.value,h=(N=(L=t.priceRange)==null?void 0:L.maximum)==null?void 0:N.regular.amount.value;return n<c||l<h?U("div",{class:"product-price",children:[e("span",{class:"regular-price-normal",children:e(y,{display:"from to",minimumAmount:n,maximumAmount:l,currency:a})}),e("span",{class:"special-price-crossed",children:e(y,{display:"from to",minimumAmount:c,maximumAmount:h,currency:a})})]}):e(y,{display:"from to",minimumAmount:c,maximumAmount:h,currency:a})},ie=t=>w.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},w.createElement("g",{clipPath:"url(#clip0_841_1324)"},w.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round"}),w.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round"})),w.createElement("defs",null,w.createElement("clipPath",{id:"clip0_841_1324"},w.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)",strokeWidth:1})))),ce=({alertMessage:t=""})=>e("div",{className:G(["product-discovery-search-alert-message__wrapper"]),children:e("div",{className:"product-discovery-search-alert-message__content",children:e(J,{heading:t,type:"warning",icon:e(K,{source:ie,size:"24"}),onDismiss:void 0})})}),fe=({routeProduct:t,scope:a,slots:n,imageWidth:c=400,imageHeight:l=450,skeletonCount:h=8,onSearchResult:v})=>{const u=a==="popover"?ee:re,p=ne({noResults:"Search.PLP.noResults",searchError:"Search.PLP.searchError"}),[o,P]=E(null),[d,x]=E([]),[_,I]=E(!1),[S,R]=E(null);Z(()=>{const r=C.on("search/loading",I,{eager:!0,scope:a}),i=C.on("search/error",()=>{R(p.searchError)},{eager:!0,scope:a}),s=C.on("search/result",m=>{var g,f,A;R(((g=m.result)==null?void 0:g.items.length)<1?p.noResults:null),P(m.request),x((f=m.result)==null?void 0:f.items),v==null||v((A=m.result)==null?void 0:A.items),m.request.phrase?X(u):Y(u)},{eager:!0,scope:a});return()=>{r==null||r.off(),i==null||i.off(),s==null||s.off()}},[]);const L=(r,i)=>{var f;const s=(f=r.target)==null?void 0:f.closest("a");if(!s||!t)return;const m=new URL(s.href),g=new URL(t(i),window.location.origin);m.pathname===g.pathname&&m.hostname===g.hostname&&$(i.sku,u)},N=(r,i)=>{var f,A,V,D;const s={loading:i<8?"eager":"lazy",src:((A=(f=r.images)==null?void 0:f[0])==null?void 0:A.url)||"",alt:((D=(V=r.images)==null?void 0:V[0])==null?void 0:D.label)||"",width:c,height:l,params:{width:c}},m=r.name!==null?F(r.name):r.sku,g=e(Q,{class:"product-discovery-product-item__image",...s,"aria-label":m||""});return e(k,{name:"ProductImage",slot:n==null?void 0:n.ProductImage,context:{product:r,defaultImageProps:s,variables:o},children:t?e("a",{href:t(r),children:g}):g})},b=r=>{const i=r.name!==null?F(r.name):"";return e(k,{name:"ProductName",slot:n==null?void 0:n.ProductName,context:{product:r,variables:o},children:t?e("a",{href:t(r),children:i}):i})},j=r=>{const i=r.typename==="ComplexProductView"?e(ae,{product:r}):e(te,{product:r});return e(k,{name:"ProductPrice",slot:n==null?void 0:n.ProductPrice,context:{product:r,variables:o},children:t?e("a",{href:t(r),children:i}):i})},z=r=>e(k,{name:"ProductActions",slot:n==null?void 0:n.ProductActions,context:{product:r,variables:o}}),B=()=>e(k,{name:"NoResults",slot:n==null?void 0:n.NoResults,context:{error:S,variables:o},children:S&&e(ce,{alertMessage:S})}),O=()=>e(M,{imageWidth:c,imageHeight:l,productList:Array.from({length:h}).map((r,i)=>e(H,{initialized:!1},i))}),T=()=>e(k,{name:"Header",slot:n==null?void 0:n.Header,context:{products:d,variables:o}}),W=()=>e(k,{name:"Footer",slot:n==null?void 0:n.Footer,context:{products:d,variables:o}});return e("div",{children:_?O():S?B():e(M,{header:T(),footer:W(),imageWidth:c,imageHeight:l,productList:d.map((r,i)=>e(H,{image:N(r,i),titleNode:b(r),price:j(r),actionButton:n!=null&&n.ProductActions?z(r):void 0,onClick:s=>L(s,r),initialized:!0},r.id||r.sku||i))})})};export{fe as SearchResults,fe as default};
//# sourceMappingURL=SearchResults.js.map
