/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as a,jsxs as p,Fragment as Ee}from"@dropins/tools/preact-jsx-runtime.js";import{useState as d,useEffect as Y,useCallback as u,useMemo as Q,useRef as ra,createPortal as U}from"@dropins/tools/preact-compat.js";import{classes as g,VComponent as _,Slot as N}from"@dropins/tools/lib.js";import{f as Le}from"../chunks/dateUtils.js";import{events as ia}from"@dropins/tools/event-bus.js";import{Skeleton as ca,SkeletonRow as R,InLineAlert as S,Modal as la,Input as ie,Button as y,TextArea as ma,Icon as K}from"@dropins/tools/components.js";import{N as Se}from"../chunks/transform-quote-template.js";import{A as da,T as sa}from"../chunks/TabbedContent.js";/* empty css                              */import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{C as X}from"../chunks/ConfirmationModal.js";/* empty css                        *//* empty css                          */import{a as ce,S as ke}from"../chunks/WarningFilled.js";import{useText as le}from"@dropins/tools/i18n.js";import"../chunks/state.js";import{d as ua,c as ga,s as fa,a as pa,o as ba}from"../chunks/openQuoteTemplate.js";import{g as Ma}from"../chunks/generateQuoteFromTemplate.js";import{I as ha}from"../chunks/ItemsQuotedTemplate.js";import{Q as Ta}from"../chunks/QuoteTemplateCommentsList.js";import{Q as Na}from"../chunks/QuoteTemplateHistoryLog.js";import"../chunks/transform-quote.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/NegotiableQuoteTemplateFragment.js";import"../chunks/LineItemNoteModal.js";import"../chunks/addQuoteTemplateLineItemNote.js";import"../chunks/QuoteCommentsList.js";import"../chunks/QuoteHistoryLog.js";const Qa=({className:t,loading:s,templateName:l,templateId:v,banner:e,details:h,actionBar:q,referenceDocuments:c,itemsTable:m,commentsTitle:T,comments:r,footer:b,...k})=>s?a(va,{}):p("div",{...k,className:g(["quote-management-manage-negotiable-quote-template",t]),children:[p("div",{className:g(["quote-management-manage-negotiable-quote-template__header"]),children:[l&&a(_,{node:l,className:g(["quote-management-manage-negotiable-quote-template__template-name"])}),v&&a(_,{node:v,className:g(["quote-management-manage-negotiable-quote-template__template-id"])})]}),e&&a(_,{node:e,className:g(["quote-management-manage-negotiable-quote-template__banner"])}),h&&a(_,{node:h,className:g(["quote-management-manage-negotiable-quote-template__details"])}),q&&a(_,{node:q,className:g(["quote-management-manage-negotiable-quote-template__action-bar"])}),c&&a("div",{"data-testid":"reference-documents-container",className:g(["quote-management-manage-negotiable-quote-template__reference-documents-container"]),children:a(_,{node:c,className:g(["quote-management-manage-negotiable-quote-template__reference-documents"])})}),m&&a(_,{node:m,className:g(["quote-management-manage-negotiable-quote-template__items-table"])}),p("div",{"data-testid":"comments-container",className:g(["quote-management-manage-negotiable-quote-template__comments-container"]),children:[T&&a(_,{node:T,className:g(["quote-management-manage-negotiable-quote-template__comments-title"])}),r&&a(_,{node:r,className:g(["quote-management-manage-negotiable-quote-template__comments"])})]}),b&&a(_,{node:b,className:g(["quote-management-manage-negotiable-quote-template__footer"])})]}),va=()=>p(ca,{"data-testid":"manage-negotiable-quote-template-skeleton",children:[a(R,{variant:"heading",fullWidth:!0,size:"large"}),a(R,{variant:"row",fullWidth:!1,size:"small"}),a(R,{variant:"row",fullWidth:!1,size:"small"}),a(R,{variant:"row",fullWidth:!0}),a(R,{variant:"row",fullWidth:!0,size:"xlarge",lines:2}),a(R,{variant:"row",fullWidth:!1,size:"small"})]}),Ca=({className:t,open:s,document:l,errorMessage:v,errorBanner:e,successBanner:h,showCloseButton:q=!0,isSubmitting:c=!1,onSave:m,onClose:T})=>{const[r,b]=d(""),[k,E]=d(""),[w,L]=d(""),[D,C]=d({}),M=le({title:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.title",documentNameLabel:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.documentNameLabel",documentIdentifierLabel:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.documentIdentifierLabel",referenceUrlLabel:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.referenceUrlLabel",addButton:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.addButton",updateButton:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.updateButton",cancelButton:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.cancelButton",documentNameRequired:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.documentNameRequired",referenceUrlRequired:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.referenceUrlRequired",invalidUrl:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.invalidUrl",errorHeading:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.errorHeading"}),B=e||(v?a(S,{type:"error",variant:"primary",icon:a(ce,{}),heading:M.errorHeading,description:v,"data-testid":"reference-document-form-modal-error-banner-inline"}):null),A=!!l;Y(()=>{s&&(l?(b(l.name||""),E(l.identifier||""),L(l.url||"")):(b(""),E(""),L("")),C({}))},[s,l]);const F=u(f=>{if(!f.trim())return!1;try{return new URL(f),!0}catch{return!1}},[]),Z=u(()=>{const f={};if(r.trim()||(f.documentName=M.documentNameRequired),w.trim()?F(w.trim())||(f.referenceUrl=M.invalidUrl):f.referenceUrl=M.referenceUrlRequired,Object.keys(f).length>0){C(f);return}m({uid:l==null?void 0:l.uid,name:r.trim(),identifier:k.trim()||void 0,url:w.trim()})},[r,k,w,l,M,F,m]),I=u(()=>{b(""),E(""),L(""),C({}),T==null||T()},[T]);return s?p(la,{open:s,size:"medium",title:a(Ee,{children:M.title}),onClose:I,clickToDismiss:!0,escapeToDismiss:!0,showCloseButton:q,className:g(["quote-management-reference-document-form-modal",t]),"data-testid":"reference-document-form-modal",children:[B&&a("div",{className:g(["quote-management-reference-document-form-modal__error-banner"]),"data-testid":"reference-document-form-modal-error-banner",children:B}),h&&a("div",{className:g(["quote-management-reference-document-form-modal__success-banner"]),"data-testid":"reference-document-form-modal-success-banner",children:h}),p("div",{className:g(["quote-management-reference-document-form-modal__content"]),children:[p("div",{children:[a(ie,{name:"documentName",type:"text",value:r,onInput:f=>{b(f.target.value),C({...D,documentName:void 0})},floatingLabel:M.documentNameLabel,required:!0,error:!!D.documentName,disabled:c,"data-testid":"reference-document-name-input"}),D.documentName&&a("span",{className:g(["quote-management-reference-document-form-modal__error-text"]),"data-testid":"reference-document-name-error",children:D.documentName})]}),a("div",{children:a(ie,{name:"documentIdentifier",type:"text",value:k,onInput:f=>{E(f.target.value)},floatingLabel:M.documentIdentifierLabel,disabled:c,"data-testid":"reference-document-identifier-input"})}),p("div",{children:[a(ie,{name:"referenceUrl",type:"url",value:w,onInput:f=>{L(f.target.value),C({...D,referenceUrl:void 0})},floatingLabel:M.referenceUrlLabel,required:!0,error:!!D.referenceUrl,disabled:c,"data-testid":"reference-document-url-input"}),D.referenceUrl&&a("span",{className:g(["quote-management-reference-document-form-modal__error-text"]),"data-testid":"reference-document-url-error",children:D.referenceUrl})]})]}),p("div",{className:g(["quote-management-reference-document-form-modal__actions"]),children:[a(y,{variant:"secondary",size:"medium",onClick:I,disabled:c,className:g(["quote-management-reference-document-form-modal__cancel-button"]),"data-testid":"reference-document-form-cancel-button",children:M.cancelButton}),a(y,{variant:"primary",size:"medium",onClick:Z,disabled:c,className:g(["quote-management-reference-document-form-modal__save-button"]),"data-testid":"reference-document-form-save-button",children:A?M.updateButton:M.addButton})]})]}):null},qa=({className:t,documents:s,isEditable:l=!1,onAdd:v,onEdit:e,onRemove:h,...q})=>{const c=le({add:"NegotiableQuoteTemplate.Manage.referenceDocuments.add",edit:"NegotiableQuoteTemplate.Manage.referenceDocuments.edit",remove:"NegotiableQuoteTemplate.Manage.referenceDocuments.remove",noReferenceDocuments:"NegotiableQuoteTemplate.Manage.referenceDocuments.noReferenceDocuments"}),m=r=>r.identifier?`${r.name}, ${r.identifier}`:`${r.name} ${r.url}`,T=(r,b)=>{r.preventDefault(),window.open(b,"_blank","noopener,noreferrer")};return a("div",{className:g(["quote-management-reference-documents-list",t]),"data-testid":"reference-documents-list",...q,children:p("div",{className:"quote-management-reference-documents-list__content",children:[s.map(r=>p("div",{className:"quote-management-reference-documents-list__document","data-testid":`reference-document-${r.uid||r.url}`,children:[a("a",{href:r.url,onClick:b=>T(b,r.url),className:"quote-management-reference-documents-list__document-link",target:"_blank",rel:"noopener noreferrer","data-testid":`reference-document-link-${r.uid||r.url}`,children:m(r)}),l&&p("div",{className:"quote-management-reference-documents-list__document-actions",children:[a(y,{variant:"tertiary",onClick:()=>e==null?void 0:e(r),className:"quote-management-reference-documents-list__edit-button","data-testid":`reference-document-edit-${r.uid||r.url}`,children:c.edit}),a("span",{className:"quote-management-reference-documents-list__separator",children:"|"}),a(y,{variant:"tertiary",onClick:()=>h==null?void 0:h(r),className:"quote-management-reference-documents-list__remove-button","data-testid":`reference-document-remove-${r.uid||r.url}`,children:c.remove})]})]},r.uid||r.url)),l&&p(y,{variant:"tertiary",onClick:v,className:"quote-management-reference-documents-list__add-button","data-testid":"reference-documents-add-button",children:["+ ",c.add]}),s.length===0&&!l&&a("div",{className:"quote-management-reference-documents-list__empty",children:c.noReferenceDocuments})]})})},Da=t=>{const{templateReferenceDocuments:s,localReferenceDocuments:l}=t,v=u(c=>s?s.some(m=>c.uid&&m.uid?m.uid===c.uid:m.url===c.url):!1,[s]),e=u(()=>s?l.filter(c=>!s.some(m=>c.uid&&m.uid?m.uid===c.uid:m.url===c.url)):l,[s,l]),h=u(()=>l.map(c=>({uid:c.uid,name:c.name,identifier:c.identifier,url:c.url})),[l]),q=Q(()=>s?l.some(c=>!s.some(m=>c.uid&&m.uid?m.uid===c.uid:m.url===c.url)):l.length>0,[s,l]);return{isDocumentInTemplateData:v,getNewDocuments:e,getReferenceDocumentLinks:h,hasUnsavedChanges:q}},nt=({slots:t,onActionsButtonClick:s,onSendForReview:l,...v})=>{const[e,h]=d(void 0),[q,c]=d(!0),[m,T]=d(""),[r,b]=d(!1),[k,E]=d(!1),[w,L]=d(null),[D,C]=d(!1),[M,B]=d(!1),[A,F]=d(null),[Z,I]=d(!1),[f,H]=d([]),[me,W]=d(!1),[O,G]=d(void 0),[we,$]=d(null),[de,se]=d(!1),[ue,ge]=d(!1),[fe,z]=d(""),[pe,P]=d(""),[be,Me]=d(!1),[he,Te]=d(!1),[Ne,j]=d(""),[Qe,V]=d(""),ve=ra(!1),{getReferenceDocumentLinks:Ce,hasUnsavedChanges:ee}=Da({templateReferenceDocuments:e==null?void 0:e.referenceDocuments,localReferenceDocuments:f}),n=le({createdLabel:"NegotiableQuoteTemplate.Manage.createdLabel",salesRepLabel:"NegotiableQuoteTemplate.Manage.salesRepLabel",expiresLabel:"NegotiableQuoteTemplate.Manage.expiresLabel",actionsLabel:"NegotiableQuoteTemplate.Manage.actionsLabel",referenceDocumentsTitle:"NegotiableQuoteTemplate.Manage.referenceDocuments.title",commentsTitle:"NegotiableQuoteTemplate.Manage.comments.title",historyLogTitle:"NegotiableQuoteTemplate.Manage.historyLog.title",itemsQuotedTab:"NegotiableQuoteTemplate.Manage.tabs.itemsQuoted",commentsTab:"NegotiableQuoteTemplate.Manage.tabs.comments",historyLogTab:"NegotiableQuoteTemplate.Manage.tabs.historyLog",templateCommentsPlaceholder:"NegotiableQuoteTemplate.Manage.templateComments.placeholder",sendForReview:"NegotiableQuoteTemplate.Manage.actionButtons.sendForReview",delete:"NegotiableQuoteTemplate.Manage.actionButtons.delete",cancel:"NegotiableQuoteTemplate.Manage.actionButtons.cancel",confirmationModalDeleteTitle:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.title",confirmationModalDeleteMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.message",confirmationModalDeleteConfirm:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.confirm",confirmationModalDeleteErrorHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.errorHeading",confirmationModalDeleteErrorFallback:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.errorFallback",confirmationModalDeleteSuccessHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.successHeading",confirmationModalDeleteSuccessDescription:"NegotiableQuoteTemplate.Manage.confirmationModal.delete.successDescription",confirmationModalCancelTitle:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.title",confirmationModalCancelMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.message",confirmationModalCancelConfirm:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.confirm",confirmationModalCancelErrorHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.errorHeading",confirmationModalCancelErrorFallback:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.errorFallback",confirmationModalCancelSuccessHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.successHeading",confirmationModalCancelSuccessDescription:"NegotiableQuoteTemplate.Manage.confirmationModal.cancelTemplate.successDescription",confirmationModalCancel:"NegotiableQuoteTemplate.Manage.confirmationModal.cancel",accept:"NegotiableQuoteTemplate.Manage.actionButtons.accept",generateQuote:"NegotiableQuoteTemplate.Manage.actionButtons.generateQuote",generateQuoteModalTitle:"NegotiableQuoteTemplate.Manage.actionButtons.generateQuote",generateQuoteModalMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.message",generateQuoteModalCancel:"NegotiableQuoteTemplate.Manage.confirmationModal.cancel",generateQuoteModalConfirm:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.confirm",generateQuoteModalConfirmLoading:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.confirmLoading",generateQuoteModalSuccessHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.successHeading",generateQuoteSuccessMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.successDescription",generateQuoteModalErrorHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.errorHeading",generateQuoteErrorFallback:"NegotiableQuoteTemplate.Manage.confirmationModal.generateQuote.errorFallback",acceptModalTitle:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.title",acceptModalMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.message",acceptModalCancel:"NegotiableQuoteTemplate.Manage.confirmationModal.cancel",acceptModalConfirm:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.confirm",acceptModalConfirmLoading:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.confirmLoading",acceptModalSuccessHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.successHeading",acceptSuccessMessage:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.successDescription",acceptModalErrorHeading:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.errorHeading",acceptErrorFallback:"NegotiableQuoteTemplate.Manage.confirmationModal.accept.errorFallback",documentDuplicateUidError:"NegotiableQuoteTemplate.Manage.referenceDocuments.form.duplicateUidError"});Y(()=>{const o=ia.on("quote-management/quote-template-data",i=>{i.quoteTemplate&&(h(i.quoteTemplate),c(!1),T(""),b(!1),H(i.quoteTemplate.referenceDocuments||[]))},{eager:!0});return()=>o==null?void 0:o.off()},[]),Y(()=>{e!=null&&e.referenceDocuments&&H(e.referenceDocuments)},[e==null?void 0:e.referenceDocuments]),Y(()=>{e&&e.status===Se.UPDATED&&!ve.current&&(ve.current=!0,(async()=>{try{await ba({templateId:e.id})}catch(i){console.error("Failed to auto-open quote template:",i)}})())},[e]);const Ie=u(()=>{E(!1),L(null),C(!1)},[]),Fe=u(async()=>{if(e!=null&&e.id){L(null),C(!1);try{await ua({templateId:e.id}),C(!0),setTimeout(()=>{E(!1),C(!1)},2e3)}catch(o){const i=o.message||n.confirmationModalDeleteErrorFallback;L(i)}}},[e,n.confirmationModalDeleteErrorFallback]),Be=u(()=>{L(null)},[]),Re=u(()=>{C(!1)},[]),He=u(()=>{B(!1),F(null),I(!1)},[]),xe=u(async()=>{if(e!=null&&e.id){F(null),I(!1);try{await ga({templateId:e.id}),I(!0),setTimeout(()=>{B(!1),I(!1)},2e3)}catch(o){const i=o.message||n.confirmationModalCancelErrorFallback;F(i)}}},[e,n.confirmationModalCancelErrorFallback]),Ue=u(()=>{F(null)},[]),Ae=u(()=>{I(!1)},[]),qe=u(async()=>{const o=Ce();if(l){l({templateData:e,comment:m.trim()||void 0});return}b(!0);try{await fa({templateId:e.id,comment:m.trim()||void 0,referenceDocumentLinks:o.length>0?o:void 0})}catch(i){console.error("Failed to send quote template for review:",i),b(!1)}},[e,l,m,Ce]),ae=u(()=>{G(void 0),$(null),W(!0)},[]),te=u(o=>{G(o),$(null),W(!0)},[]),ne=u(o=>{H(i=>i.filter(x=>x.uid!==o.uid||x.url!==o.url))},[]),We=u(o=>{$(null),H(O?i=>i.map(x=>x.identifier===O.identifier?o:x):i=>[...i,o]),W(!1),G(void 0)},[O]),Oe=u(()=>{W(!1),G(void 0),$(null)},[]),Ge=u(async()=>{ge(!0),P(""),z("");try{await Ma({templateId:e.id}),z(n.generateQuoteSuccessMessage)}catch(o){console.error("Failed to generate quote from template:",o);const i=o instanceof Error?o.message:n.generateQuoteErrorFallback;P(i)}finally{ge(!1)}},[e,n.generateQuoteSuccessMessage,n.generateQuoteErrorFallback]),$e=u(()=>{se(!1),P(""),z("")},[]),ze=u(async()=>{Te(!0),V(""),j("");try{await pa({templateId:e.id}),j(n.acceptSuccessMessage)}catch(o){console.error("Failed to accept quote template:",o);const i=o instanceof Error?o.message:n.acceptErrorFallback;V(i)}finally{Te(!1)}},[e,n.acceptSuccessMessage,n.acceptErrorFallback]),Pe=u(()=>{Me(!1),V(""),j("")},[]),je=Q(()=>a(N,{name:"TemplateName",slot:t==null?void 0:t.TemplateName,context:{templateName:e==null?void 0:e.name,templateData:e},children:a("h1",{"data-testid":"template-name",children:e==null?void 0:e.name})}),[t==null?void 0:t.TemplateName,e]),Ve=Q(()=>a(N,{name:"TemplateId",slot:t==null?void 0:t.TemplateId,context:{templateId:e==null?void 0:e.uid,templateData:e},children:p("div",{"data-testid":"template-id",children:["Template #",e==null?void 0:e.uid]})}),[t==null?void 0:t.TemplateId,e]),Je=Q(()=>{if(!e)return;const o=e.expirationDate?Le(e.expirationDate,"short"):void 0;return p(N,{name:"Details",slot:t==null?void 0:t.Details,context:{templateData:e},children:[p("div",{className:"quote-management-manage-negotiable-quote-template__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote-template__detail-title","data-testid":"created-label",children:n.createdLabel}),p("span",{className:"quote-management-manage-negotiable-quote-template__detail-content","data-testid":"created-value",children:[Le(e.createdAt,"short")," (",e.buyer.firstname," ",e.buyer.lastname,")"]})]}),p("div",{className:"quote-management-manage-negotiable-quote-template__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote-template__detail-title","data-testid":"sales-rep-label",children:n.salesRepLabel}),a("span",{className:"quote-management-manage-negotiable-quote-template__detail-content","data-testid":"sales-rep-value",children:e.salesRepName})]}),o&&p("div",{className:"quote-management-manage-negotiable-quote-template__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote-template__detail-title","data-testid":"expires-label",children:n.expiresLabel}),a("span",{className:"quote-management-manage-negotiable-quote-template__detail-content","data-testid":"expires-value",children:o})]})]})},[t==null?void 0:t.Details,n,e]),De=Q(()=>[{label:n.generateQuote,value:"generateQuote",disabled:!(e!=null&&e.canGenerateQuoteFromTemplate)}],[n,e==null?void 0:e.canGenerateQuoteFromTemplate]),Ke=Q(()=>{const o=i=>{switch(i){case"generateQuote":se(!0),P(""),z(""),s==null||s(i);break}};return a(N,{name:"ActionBar",slot:t==null?void 0:t.ActionBar,context:{templateData:e},children:a(da,{dropdownPlaceholder:n.actionsLabel,dropdownOptions:[],buttons:De.map(i=>a(y,{variant:"tertiary",onClick:()=>o(i.value),"data-testid":`actions-bar-${i.value}-button`,"data-action":i.value,disabled:i.disabled,children:i.label},i.value))})})},[De,n,t==null?void 0:t.ActionBar,e,s]),J=Q(()=>{const o=e==null?void 0:e.status;return o==="Draft"||o==="Open"},[e==null?void 0:e.status]),Xe=Q(()=>{const o=f.length>0||J,i=o?n.referenceDocumentsTitle:void 0;return a(N,{name:"ReferenceDocuments",slot:t==null?void 0:t.ReferenceDocuments,context:{templateData:e,referenceDocuments:f,isEditable:J,onAddDocument:ae,onEditDocument:te,onRemoveDocument:ne,referenceDocumentsTitle:n.referenceDocumentsTitle},children:p("div",{"data-testid":"reference-documents",children:[o&&a("h2",{children:i}),a(qa,{documents:f,isEditable:J,onAdd:ae,onEdit:te,onRemove:ne})]})})},[t==null?void 0:t.ReferenceDocuments,n,e,f,J,ae,te,ne]),Ye=Q(()=>a(N,{name:"ItemsTable",slot:t==null?void 0:t.ItemsTable,context:{templateData:e},children:a(sa,{tabs:new Map([["items-quoted",n.itemsQuotedTab],["comments",n.commentsTab],["history-log",n.historyLogTab]]),tabsContent:new Map([["items-quoted",a(N,{name:"ItemsQuotedTab",slot:t==null?void 0:t.ItemsQuotedTab,context:{templateData:e},children:a(ha,{templateData:e})},"items-quoted")],["comments",a(N,{name:"CommentsTab",slot:t==null?void 0:t.CommentsTab,context:{templateData:e},children:a(Ta,{templateData:e})},"comments")],["history-log",a(N,{name:"HistoryLogTab",slot:t==null?void 0:t.HistoryLogTab,context:{templateData:e},children:a(Na,{templateData:e})},"history-log")]])})}),[t==null?void 0:t.ItemsTable,t==null?void 0:t.ItemsQuotedTab,t==null?void 0:t.CommentsTab,t==null?void 0:t.HistoryLogTab,n,e]),Ze=Q(()=>a(N,{name:"CommentsTitle",slot:t==null?void 0:t.CommentsTitle,context:{templateData:e},children:a("h2",{children:n.commentsTitle})}),[t==null?void 0:t.CommentsTitle,n,e]),ea=Q(()=>a(N,{name:"Comments",slot:t==null?void 0:t.Comments,context:{templateData:e},children:a(ma,{name:"templateComments",placeholder:n.templateCommentsPlaceholder,rows:3,value:m,onInput:o=>{T(o.target.value)},disabled:!(e!=null&&e.canSendForReview)||r})}),[t==null?void 0:t.Comments,n,e,m,r]),aa=Q(()=>{const o=(e==null?void 0:e.status)===Se.OPEN&&(e==null?void 0:e.canAccept);return p(N,{name:"Footer",slot:t==null?void 0:t.Footer,context:{templateData:e,comment:m,isSubmitting:r,referenceDocuments:f,hasUnsavedChanges:ee},children:[o&&a(y,{variant:"primary",onClick:()=>{Me(!0),V(""),j("")},"data-testid":"accept-button",disabled:r||ee,children:n.accept}),(e==null?void 0:e.canSendForReview)&&a(y,{variant:"primary",onClick:qe,"data-testid":"send-for-review-button",disabled:r,children:n.sendForReview}),(e==null?void 0:e.canCancel)&&a(y,{variant:"tertiary",onClick:()=>B(!0),"data-testid":"cancel-template-button",disabled:r,children:n.cancel}),(e==null?void 0:e.canDelete)&&a(y,{variant:"tertiary",onClick:()=>E(!0),"data-testid":"delete-template-button",disabled:r,children:n.delete})]})},[t==null?void 0:t.Footer,n,e,m,r,qe,f,ee]),ta=w?a(S,{type:"error",variant:"primary",icon:a(ce,{}),heading:n.confirmationModalDeleteErrorHeading,description:w,onDismiss:Be,"data-testid":"confirmation-modal-error-banner"}):null,_e=(D?a(S,{type:"success",variant:"primary",icon:a(ke,{}),heading:n.confirmationModalDeleteSuccessHeading,description:n.confirmationModalDeleteSuccessDescription,onDismiss:Re,"data-testid":"confirmation-modal-success-banner"}):null)||ta,na=A?a(S,{type:"error",variant:"primary",icon:a(ce,{}),heading:n.confirmationModalCancelErrorHeading,description:A,onDismiss:Ue,"data-testid":"confirmation-modal-cancel-error-banner"}):null,ye=(Z?a(S,{type:"success",variant:"primary",icon:a(ke,{}),heading:n.confirmationModalCancelSuccessHeading,description:n.confirmationModalCancelSuccessDescription,onDismiss:Ae,"data-testid":"confirmation-modal-cancel-success-banner"}):null)||na,oa={...v,loading:q,templateName:je,templateId:Ve,details:Je,actionBar:Ke,referenceDocuments:Xe,itemsTable:Ye,commentsTitle:Ze,comments:ea,footer:aa};let oe=null;fe?oe=a(S,{type:"success",variant:"primary",icon:a(K,{source:"CheckWithCircle"}),heading:n.generateQuoteModalSuccessHeading,description:fe,"data-testid":"generate-quote-success-banner"}):pe&&(oe=a(S,{type:"error",variant:"primary",icon:a(K,{source:"WarningFilled"}),heading:n.generateQuoteModalErrorHeading,description:pe,"data-testid":"generate-quote-error-banner"}));let re=null;return Ne?re=a(S,{type:"success",variant:"primary",icon:a(K,{source:"CheckWithCircle"}),heading:n.acceptModalSuccessHeading,description:Ne,"data-testid":"accept-success-banner"}):Qe&&(re=a(S,{type:"error",variant:"primary",icon:a(K,{source:"WarningFilled"}),heading:n.acceptModalErrorHeading,description:Qe,"data-testid":"accept-error-banner"})),p(Ee,{children:[a(Qa,{...oa}),k&&U(a(X,{open:k,title:n.confirmationModalDeleteTitle,message:n.confirmationModalDeleteMessage,cancelLabel:n.confirmationModalCancel,confirmLabel:n.confirmationModalDeleteConfirm,onCancel:Ie,onConfirm:Fe,showCloseButton:!_e,confirmationBanner:_e}),document.body),M&&U(a(X,{open:M,title:n.confirmationModalCancelTitle,message:n.confirmationModalCancelMessage,cancelLabel:n.confirmationModalCancel,confirmLabel:n.confirmationModalCancelConfirm,onCancel:He,onConfirm:xe,showCloseButton:!ye,confirmationBanner:ye}),document.body),me&&U(a(Ca,{open:me,document:O,errorMessage:we||void 0,onSave:We,onClose:Oe,isSubmitting:r}),document.body),de&&U(a(X,{open:de,title:n.generateQuoteModalTitle,message:n.generateQuoteModalMessage,cancelLabel:n.generateQuoteModalCancel,confirmLabel:ue?n.generateQuoteModalConfirmLoading:n.generateQuoteModalConfirm,onCancel:$e,onConfirm:ue?void 0:Ge,showCloseButton:!0,confirmationBanner:oe,"data-testid":"generate-quote-confirmation-modal"}),document.body),be&&U(a(X,{open:be,title:n.acceptModalTitle,message:n.acceptModalMessage,cancelLabel:n.acceptModalCancel,confirmLabel:he?n.acceptModalConfirmLoading:n.acceptModalConfirm,onCancel:Pe,onConfirm:he?void 0:ze,showCloseButton:!0,confirmationBanner:re,"data-testid":"accept-confirmation-modal"}),document.body)]})};export{nt as ManageNegotiableQuoteTemplate,nt as default};
//# sourceMappingURL=ManageNegotiableQuoteTemplate.js.map
